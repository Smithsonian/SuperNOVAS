<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta charset="utf-8"/>
<meta name="description" content="SuperNOVAS C/C++ astrometry library"/>
<meta name="keywords" content="astronomy, astrometry, C, C++, C99, software library, open source, NOVAS"/>
<meta name="author" content="Attila Kovacs"/>
<meta name="copyright" content="(C)2024 Attila Kovacs" />
<meta name="robots" content="index,follow"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HLFWKSM8V9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HLFWKSM8V9');
</script>
<link rel="shortcut icon" type="image/x-icon" href="/SuperNOVAS/resources/favicon.ico" />
<link rel="icon" type="image/png" sizes="192x192" href="/SuperNOVAS/resources/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="/SuperNOVAS/resources/android-chrome-512x512.png" />
<link rel="apple-touch-icon" type="image/png" href="/SuperNOVAS/resources/apple-touch-icon.png" />
<title>SuperNOVAS: src/earth.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.4</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('earth_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">earth.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aef1f8daaad470353648de90576aefc66" id="r_aef1f8daaad470353648de90576aefc66"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="earth_8c.html#aef1f8daaad470353648de90576aefc66">era</a> (double jd_ut1_high, double jd_ut1_low)</td></tr>
<tr class="separator:aef1f8daaad470353648de90576aefc66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5ca37110e66c8b65f623c9e26ae52e" id="r_ada5ca37110e66c8b65f623c9e26ae52e"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="earth_8c.html#ada5ca37110e66c8b65f623c9e26ae52e">geo_posvel</a> (double jd_tt, double ut1_to_tt, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const <a class="el" href="structobserver.html">observer</a> *restrict obs, double *restrict pos, double *restrict vel)</td></tr>
<tr class="separator:ada5ca37110e66c8b65f623c9e26ae52e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a022957936bc7c5a3e9651776689c9380" id="r_a022957936bc7c5a3e9651776689c9380"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="earth_8c.html#a022957936bc7c5a3e9651776689c9380">limb_angle</a> (const double *pos_src, const double *pos_obs, double *restrict limb_ang, double *restrict nadir_ang)</td></tr>
<tr class="separator:a022957936bc7c5a3e9651776689c9380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eacba14d3c382d67307856a2ea290e3" id="r_a6eacba14d3c382d67307856a2ea290e3"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time</a> (double jd_ut1_high, double jd_ut1_low, double ut1_to_tt, enum <a class="el" href="novas_8h.html#ab970f5de5d5e04874cb31865459b0b4f">novas_equinox_type</a> gst_type, enum <a class="el" href="novas_8h.html#a9e882d9c9055f187d3a8dc9b019f0609">novas_earth_rotation_measure</a> erot, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double *restrict gst)</td></tr>
<tr class="separator:a6eacba14d3c382d67307856a2ea290e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8471f990ad6e3051a0aa584d9cb2d355" id="r_a8471f990ad6e3051a0aa584d9cb2d355"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="earth_8c.html#a8471f990ad6e3051a0aa584d9cb2d355">terra</a> (const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, double lst, double *restrict pos, double *restrict vel)</td></tr>
<tr class="separator:a8471f990ad6e3051a0aa584d9cb2d355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead87744eeb3029ce7d5ffb1801ee652" id="r_aead87744eeb3029ce7d5ffb1801ee652"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="earth_8c.html#aead87744eeb3029ce7d5ffb1801ee652">wobble</a> (double jd_tt, enum <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5">novas_wobble_direction</a> direction, double xp, double yp, const double *in, double *out)</td></tr>
<tr class="separator:aead87744eeb3029ce7d5ffb1801ee652"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>Created on Mar 6, 2025 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>G. Kaplan and Attila Kovacs</dd></dl>
<p>Various finctions relating to Earth position and orientation </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aef1f8daaad470353648de90576aefc66" name="aef1f8daaad470353648de90576aefc66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef1f8daaad470353648de90576aefc66">&#9670;&#160;</a></span>era()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double era </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd_ut1_high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd_ut1_low</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the value of the Earth Rotation Angle (theta) for a given UT1 Julian date. The expression used is taken from the note to IAU Resolution B1.8 of 2000. The input Julian date cane be split into an into high and low order parts (e.g. integer and fractional parts) for improved accuracy, or else one of the components (e.g. the low part) can be set to zero if no split is desired.</p>
<p>The algorithm used here is equivalent to the canonical theta = 0.7790572732640 + 1.00273781191135448 * t, where t is the time in days from J2000 (t = jd_high + jd_low - JD_J2000), but it avoids many two-PI 'wraps' that decrease precision (adopted from SOFA Fortran routine iau_era00; see also expression at top of page 35 of IERS Conventions (1996)).</p>
<p>REFERENCES: </p><ol>
<li>
IAU Resolution B1.8, adopted at the 2000 IAU General Assembly, Manchester, UK. </li>
<li>
Kaplan, G. (2005), US Naval Observatory Circular 179. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jd_ut1_high</td><td>[day] High-order part of UT1 Julian date. </td></tr>
    <tr><td class="paramname">jd_ut1_low</td><td>[day] Low-order part of UT1 Julian date. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] The Earth Rotation Angle (theta) in degrees [0:360].</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time()</a> </dd>
<dd>
<a class="el" href="system_8c.html#aa2768d89d499a7155f90a6fd8c176d8d">cirs_to_itrs()</a> </dd>
<dd>
<a class="el" href="system_8c.html#a12953f66c0f774284f0700ae785784d0">itrs_to_cirs()</a> </dd></dl>

</div>
</div>
<a id="ada5ca37110e66c8b65f623c9e26ae52e" name="ada5ca37110e66c8b65f623c9e26ae52e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada5ca37110e66c8b65f623c9e26ae52e">&#9670;&#160;</a></span>geo_posvel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short geo_posvel </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ut1_to_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a>&#160;</td>
          <td class="paramname"><em>accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobserver.html">observer</a> *restrict&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict&#160;</td>
          <td class="paramname"><em>vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the geocentric GCRS position and velocity of an observer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ut1_to_tt</td><td>[s] TT - UT1 time difference in seconds </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">obs</td><td>Observer location </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Position 3-vector of observer, with respect to origin at geocenter, referred to GCRS axes, components in AU. (It may be NULL if not required.) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] Velocity 3-vector of observer, with respect to origin at geocenter, referred to GCRS axes, components in AU/day. (It must be distinct from the pos output vector, and may be NULL if not required) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if the 'obs' is NULL or the two output vectors are the same, or else 1 if 'accuracy' is invalid, or 2 if 'obserrver-&gt;where' is invalid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a> </dd>
<dd>
<a class="el" href="observer_8c.html#a0f2096c7954b583fe749553b956ff9d2">make_observer()</a> </dd>
<dd>
<a class="el" href="timescale_8c.html#a4d7470ca705efa1953e8b4beab77c6b6">get_ut1_to_tt()</a> </dd>
<dd>
<a class="el" href="equinox_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a> </dd></dl>

<p class="reference">References <a class="el" href="place_8c.html#a713982e1f2bae0a72b39d03007f00d23">ephemeris()</a>, <a class="el" href="novas_8h.html#a9e882d9c9055f187d3a8dc9b019f0609ab07b6e5ed11fd50e7c2287b5b6626b46">EROT_ERA</a>, <a class="el" href="earth_8c.html#ada5ca37110e66c8b65f623c9e26ae52e">geo_posvel()</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3a1665bf146ca1a4d11380bf4d7d9d7058">NOVAS_AIRBORNE_OBSERVER</a>, <a class="el" href="novas_8h.html#a208120c5fa3e12853eb37cb99d3e27beade504a1c5ccf790ce9d8ad52797bb94c">NOVAS_BARYCENTER</a>, <a class="el" href="novas_8h.html#abad802a863342aebe9a40587b4e47bab">NOVAS_EARTH_INIT</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3aca54b3a0c7d5b31d09090a1f55ff72b2">NOVAS_OBSERVER_AT_GEOCENTER</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3aca418efc57ac159cf541c324c008eb27">NOVAS_OBSERVER_IN_EARTH_ORBIT</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3aadb64b75d1bf5344760b942f241e52e8">NOVAS_OBSERVER_ON_EARTH</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3a82474207bac139bc2a8826b9d317a42c">NOVAS_SOLAR_SYSTEM_OBSERVER</a>, <a class="el" href="novas_8h.html#ab970f5de5d5e04874cb31865459b0b4fa1096785746d1a9bc678ea2c51fc21055">NOVAS_TRUE_EQUINOX</a>, <a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time()</a>, <a class="el" href="earth_8c.html#a8471f990ad6e3051a0aa584d9cb2d355">terra()</a>, <a class="el" href="system_8c.html#a6871e7fecde44084c7b4e1b8dda5ac70">tod_to_gcrs()</a>, <a class="el" href="timescale_8c.html#a129acca41760da486e1179c93cb9e86d">tt2tdb()</a>, and <a class="el" href="structobserver.html#a11f2eb69df64b674d938b34bbb842ab1">observer::where</a>.</p>

</div>
</div>
<a id="a022957936bc7c5a3e9651776689c9380" name="a022957936bc7c5a3e9651776689c9380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a022957936bc7c5a3e9651776689c9380">&#9670;&#160;</a></span>limb_angle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int limb_angle </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>pos_src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>pos_obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict&#160;</td>
          <td class="paramname"><em>limb_ang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict&#160;</td>
          <td class="paramname"><em>nadir_ang</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines the angle of an object above or below the Earth's limb (horizon). The geometric limb is computed, assuming the Earth to be an airless sphere (no refraction or oblateness is included). The observer can be on or above the Earth. For an observer on the surface of the Earth, this function returns the approximate unrefracted elevation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">pos_src</td><td>[AU] Position 3-vector of observed object, with respect to origin at geocenter, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_obs</td><td>[AU] Position 3-vector of observer, with respect to origin at geocenter, components in AU. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">limb_ang</td><td>[deg] Angle of observed object above (+) or below (-) limb in degrees, or NAN if reurning with an error. It may be NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nadir_ang</td><td>Nadir angle of observed object as a fraction of apparent radius of limb: lt;1.0 if below the limb; 1.0 on the limb; or &gt;1.0 if above the limb. Returns NAN in case of an error return. It may be NULL if not required.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if either of the input vectors is NULL or if either input position is a null vector (at the geocenter).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>, and <a class="el" href="util_8c.html#a0f41cefb8c872973b07e936b5026d143">novas_vlen()</a>.</p>

</div>
</div>
<a id="a6eacba14d3c382d67307856a2ea290e3" name="a6eacba14d3c382d67307856a2ea290e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eacba14d3c382d67307856a2ea290e3">&#9670;&#160;</a></span>sidereal_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short sidereal_time </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd_ut1_high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd_ut1_low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ut1_to_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#ab970f5de5d5e04874cb31865459b0b4f">novas_equinox_type</a>&#160;</td>
          <td class="paramname"><em>gst_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a9e882d9c9055f187d3a8dc9b019f0609">novas_earth_rotation_measure</a>&#160;</td>
          <td class="paramname"><em>erot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a>&#160;</td>
          <td class="paramname"><em>accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict&#160;</td>
          <td class="paramname"><em>gst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the Greenwich sidereal time, either mean or apparent, at the specified Julian date. The Julian date can be broken into two parts if convenient, but for the highest precision, set 'jd_high' to be the integral part of the Julian date, and set 'jd_low' to be the fractional part.</p>
<p>NOTES: </p><ol>
<li>
Contains fix for known <a href="https://aa.usno.navy.mil/software/novas_faq">sidereal time units bug.</a> </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. (2005), US Naval Observatory Circular 179. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_ut1_high</td><td>[day] High-order part of UT1 Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">jd_ut1_low</td><td>[day] Low-order part of UT1 Julian date. (You can leave it at zero if 'jd_high' specified the date with sufficient precision) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ut1_to_tt</td><td>[s] TT - UT1 Time difference in seconds </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gst_type</td><td>NOVAS_MEAN_EQUINOX (0) or NOVAS_TRUE_EQUINOX (1), depending on whether wanting mean or apparent GST, respectively. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">erot</td><td>EROT_ERA (0) or EROT_GST (1), depending on whether to use GST relative to equinox of date (pre IAU 2006) or ERA relative to the CIO (IAU 2006 standard). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gst</td><td>[h] Greenwich (mean or apparent) sidereal time, in hours [0:24]. (In case the returned error code is &gt;1 the gst value will be set to NAN.) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if the 'gst' argument is NULL, 1 if 'accuracy' is invalid 2 if 'method' is invalid, or else 10&ndash;30 with 10 + the error from <a class="el" href="cio_8c.html#a65ffaaa2b527ed03149eadc7568f3714">cio_location()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="timescale_8c.html#aaf53fcad3fade814381cef3d06779a8c">novas_time_gst()</a> </dd>
<dd>
<a class="el" href="earth_8c.html#aef1f8daaad470353648de90576aefc66">era()</a> </dd>
<dd>
<a class="el" href="system_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3">tod_to_itrs()</a> </dd>
<dd>
<a class="el" href="system_8c.html#a3f6ae564cfac3766a21e0754905e5f7c">itrs_to_tod()</a> </dd>
<dd>
<a class="el" href="equinox_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a> </dd>
<dd>
<a class="el" href="timescale_8c.html#a4d7470ca705efa1953e8b4beab77c6b6">get_ut1_to_tt()</a> </dd></dl>

<p class="reference">References <a class="el" href="cio_8c.html#a51bfbe9b491f50851326b2522dc2a29f">cio_basis()</a>, <a class="el" href="cio_8c.html#a65ffaaa2b527ed03149eadc7568f3714">cio_location()</a>, <a class="el" href="equinox_8c.html#ab75165e2d69231da10c67de025ee05d8">e_tilt()</a>, <a class="el" href="earth_8c.html#aef1f8daaad470353648de90576aefc66">era()</a>, <a class="el" href="novas_8h.html#a9e882d9c9055f187d3a8dc9b019f0609ab07b6e5ed11fd50e7c2287b5b6626b46">EROT_ERA</a>, <a class="el" href="novas_8h.html#a9e882d9c9055f187d3a8dc9b019f0609a1d56a4fb59b567049ed1937bfcdf0f62">EROT_GST</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, <a class="el" href="novas_8h.html#ab970f5de5d5e04874cb31865459b0b4fa1096785746d1a9bc678ea2c51fc21055">NOVAS_TRUE_EQUINOX</a>, and <a class="el" href="system_8c.html#a6871e7fecde44084c7b4e1b8dda5ac70">tod_to_gcrs()</a>.</p>

</div>
</div>
<a id="a8471f990ad6e3051a0aa584d9cb2d355" name="a8471f990ad6e3051a0aa584d9cb2d355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8471f990ad6e3051a0aa584d9cb2d355">&#9670;&#160;</a></span>terra()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int terra </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *restrict&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict&#160;</td>
          <td class="paramname"><em>vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the position and velocity vectors of a terrestrial observer with respect to the center of the Earth.</p>
<p>This function ignores polar motion, unless the observer's longitude and latitude have been corrected for it, and variation in the length of day (angular velocity of earth).</p>
<p>The true equator and equinox of date do not form an inertial system. Therefore, with respect to an inertial system, the very small velocity component (several meters/day) due to the precession and nutation of the Earth's axis is not accounted for here.</p>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. H. et. al. (1989). Astron. Journ. 97, 1197-1210. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">location</td><td>Location of observer in Earth's rotating frame </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lst</td><td>[h] Local apparent sidereal time at reference meridian in hours. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Position vector of observer with respect to center of Earth, equatorial rectangular coordinates, referred to true equator and equinox of date, components in AU. If reference meridian is Greenwich and 'lst' = 0, 'pos' is effectively referred to equator and Greenwich. (It may be NULL if no position data is required). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] Velocity vector of observer with respect to center of Earth, equatorial rectangular coordinates, referred to true equator and equinox of date, components in AU/day. (It must be distinct from the pos output vector, and may be NULL if no velocity data is required).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if location is NULL or if the pos and vel output arguments are identical pointers.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="observer_8c.html#a42c084465aedee75965f74e23e6571fe">make_on_surface()</a> </dd>
<dd>
<a class="el" href="earth_8c.html#ada5ca37110e66c8b65f623c9e26ae52e">geo_posvel()</a> </dd>
<dd>
<a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time()</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a0a84af1a760ed2aaa01dd93e9e22bdf1">NOVAS_KM</a>.</p>

</div>
</div>
<a id="aead87744eeb3029ce7d5ffb1801ee652" name="aead87744eeb3029ce7d5ffb1801ee652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead87744eeb3029ce7d5ffb1801ee652">&#9670;&#160;</a></span>wobble()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wobble </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5">novas_wobble_direction</a>&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Corrects a vector in the ITRS (rotating Earth-fixed system) for polar motion, and also corrects the longitude origin (by a tiny amount) to the Terrestrial Intermediate Origin (TIO). The ITRS vector is thereby transformed to the Terrestrial Intermediate Reference System (TIRS) or Pseudo Earth Fixed (PEF), based on the true (rotational) equator and TIO; or vice versa. Because the true equator is the plane orthogonal to the direction of the Celestial Intermediate Pole (CIP), the components of the output vector are referred to z and x axes toward the CIP and TIO, respectively.</p>
<p>NOTES: </p><ol>
<li>
Generally, this function should not be called if global pole offsets were set via <a class="el" href="equinox_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a> and then used via <a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a> or one of its variants to calculate Earth orientation corrected (TOD or CIRS) apparent coordinates. In such cases, calling <a class="el" href="earth_8c.html#aead87744eeb3029ce7d5ffb1801ee652">wobble()</a> would apply duplicate corrections. It is generally best to forgo using <a class="el" href="equinox_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a> going forward, and instead apply Earth orinetation corrections with <a class="el" href="earth_8c.html#aead87744eeb3029ce7d5ffb1801ee652">wobble()</a> only when converting vectors to the Earth-fixed ITRS frame. </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. H. et. al. (1989). Astron. Journ. 97, 1197-1210. </li>
<li>
Lambert &amp; Bizouard (2002), Astronomy and Astrophysics 394, 317-321. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">direction</td><td>WOBBLE_ITRS_TO_TIRS (0) or WOBBLE_TIRS_TO_ITRS (1) to include corrections for the TIO's longitude (IAU 2006 method); or else WOBBLE_ITRS_TO_PEF (2) or WOBBLE_PEF_TO_ITRS (3) to correct for dx, dy but not for the TIO's longitude (old, pre IAU 2006 method). Negative values default to WOBBLE_TIRS_TO_ITRS. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">xp</td><td>[arcsec] Conventionally-defined X coordinate of Celestial Intermediate Pole with respect to ITRS pole, in arcseconds. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">yp</td><td>[arcsec] Conventionally-defined Y coordinate of Celestial Intermediate Pole with respect to ITRS pole, in arcseconds. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>Input position vector, geocentric equatorial rectangular coordinates, in the original system defined by 'direction' </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Output Position vector, geocentric equatorial rectangular coordinates, in the final system defined by 'direction'. It can be the same vector as the input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if the direction is invalid output vector argument is NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="equinox_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a> </dd>
<dd>
<a class="el" href="system_8c.html#aa2768d89d499a7155f90a6fd8c176d8d">cirs_to_itrs()</a> </dd>
<dd>
<a class="el" href="system_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3">tod_to_itrs()</a> </dd>
<dd>
<a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a> </dd>
<dd>
<a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time()</a> </dd>
<dd>
<a class="el" href="equinox_8c.html#ab75165e2d69231da10c67de025ee05d8">e_tilt()</a> </dd>
<dd>
<a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a3903b6d439f4a25a6482fd073996d9ec">NOVAS_WOBBLE_DIRECTIONS</a>, <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5ac1fc144f868517a2268a56343cc218a9">WOBBLE_ITRS_TO_PEF</a>, <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5a88d1bc6832a20ed34c4dab5753864851">WOBBLE_ITRS_TO_TIRS</a>, and <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5a4b792b9dcf18048019f1a4fb486b7c97">WOBBLE_TIRS_TO_ITRS</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="earth_8c.html">earth.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
