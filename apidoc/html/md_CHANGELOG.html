<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta charset="utf-8"/>
<meta name="description" content="SuperNOVAS C/C++ astrometry library"/>
<meta name="keywords" content="astronomy, astrometry, C, C++, C99, software library, open source, NOVAS"/>
<meta name="author" content="Attila Kovacs"/>
<meta name="copyright" content="(C)2024 Attila Kovacs" />
<meta name="robots" content="index,follow"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HLFWKSM8V9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HLFWKSM8V9');
</script>
<link rel="shortcut icon" type="image/x-icon" href="/SuperNOVAS/resources/favicon.ico" />
<link rel="icon" type="image/png" sizes="192x192" href="/SuperNOVAS/resources/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="/SuperNOVAS/resources/android-chrome-512x512.png" />
<link rel="apple-touch-icon" type="image/png" href="/SuperNOVAS/resources/apple-touch-icon.png" />
<title>SuperNOVAS: Changelog</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_CHANGELOG.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Changelog</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> All notable changes to the <a href="https://github.com/Smithsonian/SuperNOVAS">SuperNOVAS</a> library will be documented in this file.</p>
<p>The format is based on <a href="https://keepachangelog.com/en/1.1.0/">Keep a Changelog</a>, and this project adheres to <a href="https://semver.org/spec/v2.0.0.html">Semantic Versioning</a>.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
[Unreleased]</h1>
<p>Upcoming feature release, expected around 1 November 2025.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Fixed</h2>
<h2><a class="anchor" id="autotoc_md3"></a>
Added</h2>
<ul>
<li>#209: Added <code><a class="el" href="earth_8c.html#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a></code> and <code><a class="el" href="earth_8c.html#a348c4fd2a4a046e9768038075717b693">novas_gast()</a></code> functions to calculate Greenwich Mean and Apparent (respectively) Sidereal Times for a given UT1 date. The new functions are meant to replace the old NOVAS C <code><a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time()</a></code> with a simpler, cleaner interface.</li>
<li>#215: New functions (e.g. <code><a class="el" href="earth_8c.html#a3fe699281044873f4137344b28884cea">novas_diurnal_eop()</a></code>) to calculate corrections to the Earth orientation parameters published by IERS, to include the effect of libration and ocean tides. Such corrections are necessary to include if needing or using ITRS / TIRS coordinates with accuracy below the milli-arcsecond (mas) level.</li>
<li>#217: New functions <code><a class="el" href="itrf_8c.html#afd98ed01148f1291018809d77785527f">novas_itrf_transform()</a></code> and <code><a class="el" href="itrf_8c.html#a3c8c9b8f709d1e5a7aa3a915f8fafcbb">novas_itrf_transform_eop()</a></code> to enable transforming gecocentric <em>xyz</em> station coordinates, or Earth orientation parameters (EOP), between different ITRF realizations (e.g. ITRF2000 to ITRF2014). The implementation is based on Chapter 4 of the IERS Conventions 2010.</li>
<li>#217: New functions <code><a class="el" href="itrf_8c.html#a908dd3e00d6b27aa73679afc32c31f24">novas_geodetic_to_cartesian()</a></code> and <code><a class="el" href="itrf_8c.html#abb9a26a4658c037b4721fb97cea08ed0">novas_cartesian_to_geodetic()</a></code> to convert between geocentric <em>xyz</em> station coordinates and geodetic (longitude, latitude, altitude) coordinates on the reference ellipsoid of choice, and vice versa. The latter function is adapted from the IERS <code>GCONV2.F</code> routine.</li>
<li>#221: Now supporting Mac OS X builds, which are different from standard UNIX build, via GNU <code>make</code> also (by kiranshila).</li>
<li>#222: CMake build support, including Mac OS and Windows builds (by kiranshila).</li>
<li>#223: New functions <code><a class="el" href="timescale_8c.html#ab820dc413ec41f455b4d098bca457366">novas_clock_skew_tt()</a></code>, <code><a class="el" href="timescale_8c.html#a1ce9328ee4639a70e85b1038b3cb23e0">novas_clock_skew_tcg()</a></code>, and <code><a class="el" href="timescale_8c.html#a146b88af3a5aa92edb25de5434e53242">novas_clock_skew_tcb()</a></code> to calculate the incremental rate at which an observer's clock ticks faster than a TT, TCG, or TCB clock respectively would.</li>
</ul>
<h2><a class="anchor" id="autotoc_md4"></a>
Changed</h2>
<ul>
<li>#208: <code><a class="el" href="cio_8c.html#a65ffaaa2b527ed03149eadc7568f3714">cio_location()</a></code> now always returns the CIO's right ascension relative to the true equinox of date (on the same true equator of date).</li>
<li>#209: <code><a class="el" href="frames_8c.html#adc72577f99a7b076b23e0e44ddbca838">novas_make_frame()</a></code> calculates <code>gst</code> and <code>gcrs_to_cirs</code> fields faster, using the already available frame quantities and thus eliminating duplicate calculations.</li>
<li>#210: Speed up <code><a class="el" href="nutation_8c.html#a280cbf02b13ca57b3d77451be06e7dbc">iau2000a()</a></code> and <code><a class="el" href="nutation_8c.html#a6f9cddeb8c3dd906b9b0b5941249ad0c">iau2000b()</a></code> nutations by restricting the range of multiples that are iterated over.</li>
<li>#212: Speed up <code><a class="el" href="equinox_8c.html#add7a260017fad0d59c943a0a8d935fcf">ee_ct()</a></code> by restricting the range of multiples that are iterated over. Also reduced accuracy now uses the same series, only with fewer terms.</li>
<li>#213: Rename a couple of source modules (<code><a class="el" href="system_8c.html">system.c</a></code> to <code><a class="el" href="transform_8c.html">transform.c</a></code>, and <code>coords.c</code> to <code><a class="el" href="system_8c.html">system.c</a></code>).</li>
<li>#214: Reworked GCRS-CIRS transforms without <code><a class="el" href="cio_8c.html#a51bfbe9b491f50851326b2522dc2a29f">cio_basis()</a></code>.</li>
<li>#217: Changed <code><a class="el" href="earth_8c.html#a8471f990ad6e3051a0aa584d9cb2d355">terra()</a></code> to use GRS80 reference ellipsoid insread of the IERS 2003 ellipsoid. ITRF uses the GRS80 ellipsoid. The change restores the original NOVAS C behaviour.</li>
<li>#221: GitHub Actions CI now includes <code>Makefile</code> builds / tests for Mac OS X. (by kiranshila)</li>
<li>#222: GitHub Actions CI now checks CMake build, also for Linux, Mac OS X, FreeBSD, and Windows. (by kiranshila)</li>
<li>#225: GNU <code>Makefile</code> fixes for non-Linux builds, and FreeBSD build check in GitHub Actions CI.</li>
<li>Various API documentation edits.</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
Deprecated</h2>
<ul>
<li>#208: Deprecated <code><a class="el" href="cio_8c.html#a65ffaaa2b527ed03149eadc7568f3714">cio_location()</a></code>. Going forward, SuperNOVAS no longer uses the CIO locator data files (<code>CIO_RA.TXT</code> or <code>cio_ra.bin</code>) internally, and so <code><a class="el" href="cio_8c.html#a65ffaaa2b527ed03149eadc7568f3714">cio_location()</a></code> becomes redundant with <code><a class="el" href="cio_8c.html#acc331c69187b3077b98280bfb57f6670">cio_ra()</a></code> and also <code><a class="el" href="equinox_8c.html#aea0e1028baf14d16d9de800e36a17086">ira_equinox()</a></code> (which returns the negative of the same value).</li>
<li>#209: Deprecated <code><a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time()</a></code>. It is messy and one of its arguments (<code>erot</code>) is now a dud. Instead, you should use <code><a class="el" href="earth_8c.html#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a></code> or <code><a class="el" href="earth_8c.html#a348c4fd2a4a046e9768038075717b693">novas_gast()</a></code> to get the same results simpler.</li>
<li>#214: Deprecated <code><a class="el" href="cio_8c.html#a51bfbe9b491f50851326b2522dc2a29f">cio_basis()</a></code>. It is no longer used internally by the library, and users are recommended against using it themselves, since SuperNOVAS provides cleaner ways to convert between GCRS and CIRS using frames and transforms, or else via the <code><a class="el" href="transform_8c.html#a51ea4a016336dd3cf7783061c14d165c">gcrs_to_cirs()</a></code> / <code><a class="el" href="transform_8c.html#ac0ba048cd1732d0d0398397396d158bc">cirs_to_gcrs()</a></code> functions.</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
[1.4.2] - 2025-08-25</h1>
<p>Bug fix release with updated nutation models.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Fixed</h2>
<ul>
<li>#201: By default expect to find the CIO locator file (<code>CIO_RA.TXT</code> or <code>cio_ra.bin</code>) in its install location, e.g. in <code>/usr/share/supernovas</code> or as set via the <code>datadir</code> or <code>prefix</code> install locations.</li>
<li>#202: The P03 recommended rescaling of the original IAU2000A nutation model to IAU2006 (see Coppola, Seago, and Vallado 2009) was not correctly implemented in the prior 1.4 releases. The resulting errors are around or below 40 &mu;as for the present era, and slightly larger than the model discrepancies (~10 &mu;as) that the rescaling was meant to address.</li>
</ul>
<h2><a class="anchor" id="autotoc_md8"></a>
Changed</h2>
<ul>
<li>#206: Updated nutation models: <code><a class="el" href="nutation_8c.html#a280cbf02b13ca57b3d77451be06e7dbc">iau2000a()</a></code> now uses IAU2000A R06 model coefficients (see <a href="https://hpiers.obspm.fr/eop-pc/models/nutations/nut.html">https://hpiers.obspm.fr/eop-pc/models/nutations/nut.html</a>), making it dynamically consistent with the IAU2006 (P03) precession model, which was already implemented by NOVAS and SuperNOVAS. <code><a class="el" href="nutation_8c.html#a6f9cddeb8c3dd906b9b0b5941249ad0c">iau2000b()</a></code> is now a truncated version of the above, keeping terms with amplitude &lt;100 &mu;as, resulting in similar number of terms and precision as the original IAU2000B model. And, <code><a class="el" href="nutation_8c.html#abd066c2857d1b1cc06d8bd51b912d841">nu2000k()</a></code> has been rescaled according to Coppola, Seago, &amp; Vallado (2009) to also bring it in line with the IAU2006 (P03) precession model.</li>
<li><code>make benchmark</code> now uses any user-defined <code>CPPFLAGS</code>, automatically adding the <code>include/</code> directory to it.</li>
</ul>
<h1><a class="anchor" id="autotoc_md9"></a>
[1.4.1] - 2025-07-21</h1>
<p>Bug fix release.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Fixed</h2>
<ul>
<li>#197: Fix reverse target order builds via <code>make --shuffle=reverse</code>, which could also fail parallel builds in some cases. See also Debian Bug Tracker <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1105702">#1105702</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md11"></a>
Changed</h2>
<ul>
<li>#199: Fixed typos in <code>README.md.</code> (by Asininite)</li>
<li>Various improvements to documentation.</li>
</ul>
<h1><a class="anchor" id="autotoc_md12"></a>
[1.4.0] - 2025-06-02</h1>
<p>Feature release, with critical bug fixes.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Fixed</h2>
<ul>
<li>#188: Critical bug in <code><a class="el" href="frames_8c.html#a4d179c8573319fc25c775ce56ba055dc">novas_make_transform()</a></code> since inception in v1.1. Compound transforms were calculated using matrix products in the wrong commutation order (successive transforms were multiplied from the right instead of from the left). Very embarrasing indeed, and somehow it went unnoticed with the testing suite also (even more embarrassing...).</li>
<li>#183: IERS Earth orientation corrections set via <code><a class="el" href="equinox_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a></code> were not taken into account for true obliquity and the equation of equinoxes in <code><a class="el" href="equinox_8c.html#ab75165e2d69231da10c67de025ee05d8">e_tilt()</a></code>. This was a bug since v1.0. The bug only affected the old (pre IAU 2006) ways of incorporating polar offsets into TOD coordinates, at the sub-arcsec level. Note, than even with the old method, it is now preferrable to apply such offsets with <code><a class="el" href="earth_8c.html#aead87744eeb3029ce7d5ffb1801ee652">wobble()</a></code> for the PEF / TIRS to ITRS (and reverse) conversions instead.</li>
<li>#184: The frame based approach introduced in v1.1 has ommitted applying polar wobble corrections for transforming between the TIRS) / PEF and ITRS, and vice versa. This resulted in an error at the sub-arcsec level for celestial to ITRS / horizontal (or reverse) calculations, when IERS Earth orientation parameters were explicitly set.</li>
<li>#187: The NOVAS C 3.1 implementation of <code><a class="el" href="transform_8c.html#a6217852bfd7d3a58d3266d0daadfc6bc">cel2ter()</a></code> / <code><a class="el" href="transform_8c.html#ac8c5ff3cc13126aba2ec5a6cbe187a31">ter2cel()</a></code> was such that if both <code>xp</code> and <code>yp</code> parameters were zero, then no wobble correction was applied, not even for the TIO location (s') when converting between CIRS and ITRS. The error from this omission is very small, at just a few &mu;as (micro-acrseconds) within a couple of centuries of J2000.</li>
<li>#190: Reverse <code><a class="el" href="earth_8c.html#aead87744eeb3029ce7d5ffb1801ee652">wobble()</a></code> (ITRS to TIRS/PEF) had wrong 2nd order corrections, resulting in negligible errors below 0.1 &mu;as (micro-arcseconds) typically.</li>
<li>#193: C++ namespace conflict in <code><a class="el" href="structnovas__frame.html">novas_frame</a></code> declaration. Fixed by declaring and using named structure types instead of the conflicting <code>typedef</code> aliases.</li>
</ul>
<h2><a class="anchor" id="autotoc_md14"></a>
Added</h2>
<ul>
<li>#172: Added <code><a class="el" href="timescale_8c.html#aaf53fcad3fade814381cef3d06779a8c">novas_time_gst()</a></code> and <code><a class="el" href="timescale_8c.html#a9e99ea879ba0ddc1d9fbefc4b32b1ef1">novas_time_lst()</a></code> convenience functions to calculate the Greenwich (apparent) Sidereal Time (GST / GaST) and Local (apparent) Sidereal Time (LST / LaST) for a given astrometric time (and observer location) more easily.</li>
<li>#173: Added our own implementation of the wavelength-dependent IAU refraction model as <code><a class="el" href="refract_8c.html#a7b9ad6dfbd86e4faa2d8068c7d64fac4">novas_wave_refraction()</a></code>, which is based on the SOFA <code>iauRefco()</code> function. The wavelength for which the refraction is calculated can be set by <code><a class="el" href="refract_8c.html#ac673c4fef94847b796dc2aa2f4d0807d">novas_refract_wavelength()</a></code>. By default 550 nm (0.55 &mu;m) is assumed.</li>
<li>#176: <code><a class="el" href="planets_8c.html#a63b094e813d8b752a6f3344419e80031">novas_make_planet_orbit()</a></code> to generate Keplerian orbital elements for the major planets (sans Earth), and the Earth-Moon Barycenter (EMB), based on Standish &amp; Williams 1992. In most cases such orbitals can provide arcmin-level precisions, especially for current dates.</li>
<li>#176:<code><a class="el" href="planets_8c.html#ad6e6c7f6dc2745030e3fd4d407e982bd">novas_make_moon_orbit()</a></code> to generate geocentric Keplerian orbital elements for the Moon using the Chapront et al. 2002 model.</li>
<li>#176: <code><a class="el" href="planets_8c.html#a9ead627eed7fabd8583f1353e89f42e7">novas_approx_heliocentric()</a></code> and <code><a class="el" href="planets_8c.html#a4cb01609f76b0ff8487817b9446a3a62">novas_approx_sky_pos()</a></code> to calculate approximate heliocentric ICRS and observable apparent positions, respectively, for the major planets (including Earth), and Moon and the Earth-Moon Barycenter, using the orbital models mentioned above.</li>
<li>#176: <code><a class="el" href="planets_8c.html#a2dbdafd6b07f079815ae52d00e142861">novas_moon_phase()</a></code> and <code><a class="el" href="planets_8c.html#ad0bd6e212af549309b0fcb792ed8cb79">novas_next_moon_phase()</a></code> to calculate the Moon's apparent phase or the date/time when it reaches a specific phase, respectively, using the Keplerian orbitals for the E-M Barycenter by Standish &amp; Williams 1992, and the geocentric orbitals of the Moon by Chapront et al. 2002.</li>
<li>#176: <code>novas_orbital_native_posvel()</code> to calculate orbital positions in the native system, in which the orbital is defined (e.g. ecliptic coordinates for planetary orbits).</li>
<li>#177: Added <code><a class="el" href="calendar_8c.html#a7ee576309aa1977e9b2a3824286f725c">novas_day_of_week()</a></code> and <code><a class="el" href="calendar_8c.html#ae6eaa610037b0828d473062ab8722f47">novas_day_of_year()</a></code> functions to convert JD dates to a 1-based day of week index, or to a day of the year in the calendar of choice.</li>
<li>#185: Added <code>NOVAS_TIRS</code> and <code>NOVAS_ITRS</code> to <code>enum novas_reference_systems</code>. All frame-based functions now support these. Legacy <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code> and its variants support TIRS but not ITRS (because of the lack of information available to the legacy calls), while Keplerian orbitals may not be be defined in either TIRS or ITRS since these Earth co-rotating systems are not inertial systems.</li>
<li>#186: Added <code>NOVAS_RADIO_REFRACTION</code> and <code>NOVAS_WAVE_REFRACTION</code> to <code>enum novas_refraction_model</code>, for referencing the Berman &amp; Rockwell 1976 radio-wave model, or the IAU / SOFA wavelength-dependent model, respectively.</li>
<li>#191: Added <code><a class="el" href="timescale_8c.html#a5709058076f4aea4eeaeeb000342cd94">tt2tdb_hp()</a></code> (high-precision) and <code><a class="el" href="timescale_8c.html#ad301a9c74bfbdb8b55513cd005787b22">tt2tdb_fp()</a></code> (flexible-precision) functions for calculating the TDB-TT time difference (in seconds), with up to 0.1 &mu;s accuracy based on Fairhead &amp; Bretagnon 1990.</li>
<li>#194: Added documentation under <code>resources/</code> for a side-by-side example comparison with <b>astropy</b>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md15"></a>
Changed</h2>
<ul>
<li>#173: Added parameter range checking to <code><a class="el" href="refract_8c.html#ac7ed2a1a5fb5aea3063d116d3d980eeb">refract()</a></code> function and <code><a class="el" href="refract_8c.html#a6b49f92f8f818f2272613e3432185a39">novas_radio_refraction()</a></code> model. If called with weather parameters or an elevation angle outside of reasonable values, <code>NaN</code> will be returned and <code>errno</code> will be set to <code>EINVAL</code>.</li>
<li>#181: Changed <code><a class="el" href="nutation_8c.html#a6e9ced7b0aec544ad7b057b58f777ec4">nutation_angles()</a></code> to apply P03 model rescaling to IAU2000 nutation angles to provide 'IAU2006' values (see Capitaine et al. 2005). The same rescaling has been adopted by SOFA also.</li>
<li>#186: Tweaked error handling in atmospheric refraction functions (in <code><a class="el" href="refract_8c.html">refract.c</a></code>).</li>
<li><code>NOVAS_RMASS_INIT</code> (in <code><a class="el" href="novas_8h.html">novas.h</a></code>) and L<sub>G</sub> (in <code><a class="el" href="timescale_8c.html">timescale.c</a></code>) values updated with DE440 data (Park et al. 2021).</li>
<li>Moved some functions around between source files.</li>
</ul>
<h2><a class="anchor" id="autotoc_md16"></a>
Deprecated</h2>
<ul>
<li>Deprecated <code><a class="el" href="equinox_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a></code> function and <code>EPS_COR</code> / <code>PSI_COR</code> global variables, which provided support for the old (now disfavored) way of incorporating Earth orientation parameters as corrections into the true equator and equinox of date. The preferred way to incorpotate Earth orientation corrections is to use <em>dx,dy</em> offsets relative to the IAU2006 precession-nutation model only when transforming between the Terrestrial Intermediate Reference System (TIRS) or Pseudo Earth-Fixed (PEF) system and the International Terrestrial Reference System (ITRS), and vice versa.</li>
</ul>
<h1><a class="anchor" id="autotoc_md17"></a>
[1.3.1] - 2025-05-07</h1>
<p>Bug fix release with minor enhancements.</p>
<h2><a class="anchor" id="autotoc_md18"></a>
Fixed</h2>
<ul>
<li>#167: Fixes for Debian i386 cross builds.</li>
<li>#174: <code><a class="el" href="equinox_8c.html#ad1de5b481e41cf193c199bd0dc5084bd">accum_prec()</a></code> had linear and quadratic time evolution coefficients swapped since v1.0. The bug affected the IAU2000 precession-nutation calculations, and the calculation of the complementary terms in the equation of equinoxes in <code><a class="el" href="equinox_8c.html#add7a260017fad0d59c943a0a8d935fcf">ee_ct()</a></code> / <code><a class="el" href="equinox_8c.html#ab75165e2d69231da10c67de025ee05d8">e_tilt()</a></code>. The effect however is small, typically just a few micro-arcseconds (&mu;as), for dates within a century of J2000.</li>
</ul>
<h2><a class="anchor" id="autotoc_md19"></a>
Changed</h2>
<ul>
<li>#166: Improved detection of invalid seconds in <code>parse_degrees()</code>.</li>
<li>#169: <code><a class="el" href="parse_8c.html#ad3d04d065e76a5921995e96f67c24c41">novas_parse_degrees()</a></code> to support parsing values in exponential notation also, e.g. <code>1.23E2</code>, <code>1.23E2W</code> etc.</li>
<li>#170: <code><a class="el" href="observer_8c.html#a42c084465aedee75965f74e23e6571fe">make_on_surface()</a></code> to validate temperature and pressure values, and return -1 (with <code>errno</code> set to <code>EINVAL</code>) if the supplied values are outside of the sensible range.</li>
<li>#171: Cache <code><a class="el" href="nutation_8c.html#a6e9ced7b0aec544ad7b057b58f777ec4">nutation_angles()</a></code> instead of <code><a class="el" href="equinox_8c.html#ab75165e2d69231da10c67de025ee05d8">e_tilt()</a></code> to improve performance in more usage scenarios. (See updated benchmarks).</li>
<li>#171: Moved <code><a class="el" href="equinox_8c.html#a9178358732325399f3a5e3582080ced3">precession()</a></code>, <code><a class="el" href="equinox_8c.html#a69df5671751c09a7575963b94ad1151e">nutation()</a></code>, and <code><a class="el" href="nutation_8c.html#a6e9ced7b0aec544ad7b057b58f777ec4">nutation_angles()</a></code> to <code><a class="el" href="equinox_8c.html">equinox.c</a></code>.</li>
<li>#178: <code><a class="el" href="calendar_8c.html#a8ed2fb55bcf86d9f1f434a2f832356a2">novas_jd_to_date()</a></code> to check if input calendar is valid and return -1 with <code>errno</code> set to <code>EINVAL</code> if it is not.</li>
<li>#179: <code><a class="el" href="calendar_8c.html#a54eee84c46900c80ca9966857c217cc8">novas_jd_from_date()</a></code> to check if input calendar is valid and return NaN with <code>errno</code> set to <code>EINVAL</code> if it is not.</li>
<li>Corrected benchmarks for individual frames.</li>
<li>Corrections and edits to API documentation.</li>
</ul>
<h2><a class="anchor" id="autotoc_md20"></a>
Deprecated</h2>
<ul>
<li>Deprecated <code><a class="el" href="equinox_8c.html#add7a260017fad0d59c943a0a8d935fcf">ee_ct()</a></code> and <code><a class="el" href="equinox_8c.html#aea0e1028baf14d16d9de800e36a17086">ira_equinox()</a></code> functions. Both are meant for internal use only, and need not be exposed to users in general.</li>
<li>Deprecated <code><a class="el" href="solsys1_8c.html#a37c25dbc2683dc9e3b1d187e13f68330">solarsystem()</a></code>, <code><a class="el" href="solsys1_8c.html#a17846f3fafcce208dbbca1384e3a7fb0">solarsystem_hp()</a></code>, and <code><a class="el" href="solarsystem_8h.html#aa5f22db2fa785675372d45b88f2f1736">readeph()</a></code> functions. These were prototypes for user-defined implementations that had to be linked together with NOVAS. In SuperNOVAS, the same functionality can be (should be) set dynamically, during runtime. Thus, these functions are provided to support building legacy NOVAS applications only, and should be avoided in new application code going forward.</li>
</ul>
<h1><a class="anchor" id="autotoc_md21"></a>
[1.3.0] - 2025-04-15</h1>
<p>Feature release with many new convenience functions, such as for handling times and angles as strings; calculating rise, set, transit times; and other common astrometric calculations. In addition, the release brings various changes to improve performance.</p>
<h2><a class="anchor" id="autotoc_md22"></a>
Fixed</h2>
<ul>
<li>#116: <code><a class="el" href="target_8c.html#abe0c6e6fc60a49efa88c365aef8cdc50">transform_cat()</a></code> to update parallax to the recalculated value when precessing or changing epochs. This was a SuperNOVAS bug since v1.0.</li>
<li>#128: <code><a class="el" href="target_8c.html#abe0c6e6fc60a49efa88c365aef8cdc50">transform_cat()</a></code> had insufficient string length checking of <code>out_id</code> parameter. Prior to the fix it checked for the longer object name size instead of the catalog name size. However, even if longer than expected input names were left uncaught, only the appropriatre number of characters were used &ndash; hence it broke nothing, only failed to remind the caller (with an error) when the supplied name was too long.</li>
<li>#139: Legacy linking of external <code><a class="el" href="solsys1_8c.html#a37c25dbc2683dc9e3b1d187e13f68330">solarsystem()</a></code> / <code><a class="el" href="solsys1_8c.html#a17846f3fafcce208dbbca1384e3a7fb0">solarsystem_hp()</a></code> provider modules was blocked by <code><a class="el" href="solsys-ephem_8c.html">solsys-ephem.c</a></code> inadvertently definining these functions when <code>BUILTIN_SOLSYS_EPHEM</code> was set to 1 (default) during the build, even though it was not supposed to.</li>
<li>#156: <code><a class="el" href="observer_8c.html#a0e4e5ff7c37e6521ca75ae62aaf4050e">obs_posvel()</a></code> called <code><a class="el" href="earth_8c.html#ada5ca37110e66c8b65f623c9e26ae52e">geo_posvel()</a></code> with TDB instead of TT. It less than a 2 ms difference, so not typically signifficant, unless &lt;10-m level poitioning is required for Earth-orbiting satellites.</li>
</ul>
<h2><a class="anchor" id="autotoc_md23"></a>
Added</h2>
<ul>
<li>#113: New <code><a class="el" href="frames_8c.html#a273fd76d83b8e04ced14558c69fd175c">novas_frame_lst()</a></code> convenience function to readily return the Local (apparent) Sidereal Time for a given Earth-based observing frame.</li>
<li>#113: New <code><a class="el" href="parse_8c.html#a696e44a2d1c788f9f335611efd7ed958">novas_hms_hours()</a></code> and <code><a class="el" href="parse_8c.html#aca89d2a0f49afad45dbddffc09c3adae">novas_dms_degrees()</a></code> convenience functions to make it easier to parse HMS or DMS based time or angle values, returning the result in units of hours or degrees, appropriately for use in SuperNOVAS.</li>
<li>#113: New <code><a class="el" href="frames_8c.html#aaf38f64304fa0b00c9c56cead62043f3">novas_rises_above()</a></code> and <code><a class="el" href="frames_8c.html#a23af09cd8e5ec5ef4d0b03a347a4add0">novas_sets_below()</a></code> functions to return the date/time a source rises above or sets below a specific elevation on a given date, and <code><a class="el" href="frames_8c.html#ad04f1ebd7b2d39e5258b152fec231001">novas_transit_time()</a></code> to calculate the time a source transits over the local meridian. (For Earth-based observers only). #140, #146: Further fixes to these calculations after the v1.3.0-rc5 release candidate [thanks to valeriy-sokoloff].</li>
<li>#113: New <code><a class="el" href="target_8c.html#af4fa5359b8b0167a2780baff17b164a5">novas_helio_dist()</a></code> function to calculate the heliocentric distance of a Solar-system body on a given date. The <code><a class="el" href="target_8c.html#a763f9a9dd2edb4645a5db05184ca7495">novas_solar_power()</a></code> function can be used to estimate the incident Solar power on a Solar-system body, while <code><a class="el" href="frames_8c.html#ac780bd907a12957995d36ad916dd4ec1">novas_solar_illum()</a></code> can be used to calculate the fraction of a spherical body that is illuminated by the Sun seen from the observer location.</li>
<li>#113: New <code><a class="el" href="observer_8c.html#a73fcb54e47b2be0aa92810b5f55f7a3c">novas_hpa()</a></code> and <code><a class="el" href="observer_8c.html#a095ba0ee644dc00c11dcdc5616bc96b0">novas_epa()</a></code> functions to calculate the parallactic angle (a.k.a. vertical position angle) for a given location on sky, using the local horizontal coordinates, or else the equatorial position, respectively. The parallactic angle (PA) can be useful to convert local Cartesian offsets (e.g. from a flat image or detector array) between the local horizontal and equatorial orientations, e.g. via the newly added <code><a class="el" href="observer_8c.html#a7977de3e3edf8120b50cbd026c155f47">novas_h2e_offset()</a></code> or <code><a class="el" href="observer_8c.html#a13cd0b80eaa7bc682013f7e8ffbdbd6f">novas_e2h_offset()</a></code> functions. The conversion between offsets and absolute coordinates usually requires a WCS projections, such as described in Calabretta &amp; Greisen 2002.</li>
<li>#113: New <code><a class="el" href="util_8c.html#a9f33de2b26a19a5e20827e9e918b3375">novas_sep()</a></code>, <code><a class="el" href="util_8c.html#a4f7e06b2fa5b3145b37aec4f9c2d1602">novas_equ_sep()</a></code>, and <code><a class="el" href="frames_8c.html#afa5f3a823a895bed01876df6b2a00370">novas_object_sep()</a></code> functions can be used to calculate the precise apparent distance between to spherical or equatorial locations, or between two sources, respectively. <code><a class="el" href="frames_8c.html#a2d1ef3bc6d99aa473511e45c6e0481e9">novas_sun_angle()</a></code> and <code><a class="el" href="frames_8c.html#a121940d7f0ef41297d28fab8e6df5998">novas_moon_angle()</a></code> can be used to calculate the apparent angular distance of sources from the Sun and Moon, respectively.</li>
<li>#113: New <code><a class="el" href="structnovas__observable.html">novas_observable</a></code> and <code><a class="el" href="structnovas__track.html">novas_track</a></code> data structures to provide second order Taylor series expansion of the apparent horizontal or equatorial positions, distances, and redshifts for sources. They can be calculated with the newly added <code><a class="el" href="frames_8c.html#a1f29810393108d15fd8312a2a95158dc">novas_hor_track()</a></code> or <code><a class="el" href="frames_8c.html#a57f4a449754c88cfc87df658a6bc4cb2">novas_equ_track()</a></code> functions. Such tracking values, including rates and accelerations, can be directly useful for controlling telescope drives in horizontal or equatorial mounts to track sources (hence the name). You can also obtain instantaneous projected (extrapolated) positions from the tracking parameters via <code><a class="el" href="frames_8c.html#a225a2e33684d2c1fe769e5aa718a182a">novas_track_pos()</a></code> at low computational cost.</li>
<li>#113: New <code><a class="el" href="observer_8c.html#a601d246673742cf72a5dbe1449c97560">novas_los_to_xyz()</a></code> and <code><a class="el" href="observer_8c.html#a14deb6fdce80ba213e1f1d5238306e17">novas_xyz_to_los()</a></code> functions to convert between line-of-sight (&delta;&phi;, &delta;&theta;, &delta;r) vectors and rectangular equatorial (&delta;x, &delta;y, &delta;z) vectors.</li>
<li>#113: New <code><a class="el" href="observer_8c.html#a87867e8e7fc7decaa44777a696465353">novas_xyz_to_uvw()</a></code> and <code>novas_uvw_to_xzy()</code> functions to convert between ITRS Earth locations (absolute or differential) to equatorial projections along a line of sight in the direction of a source. Such projections are oft used in interferometry.</li>
<li>#114: New <code><a class="el" href="spectral_8c.html#aad80bf94be2efc36c340994829df8207">novas_lsr_to_ssb_vel()</a></code> can be used to convert velocity vectors referenced to the LSR to Solar-System Barycentric velocities. And, <code><a class="el" href="spectral_8c.html#a99ed25baa029f3980924da8c8af54d1a">novas_ssb_to_lsr_vel()</a></code> to provide the inverse conversion.</li>
<li>#117: Added benchmarks under the <code>benchmark/</code> folder, for SuperNOVAS as well as equivalent benchmarks for <b>astropy</b>. To run the SuperNOVAS benchmarks, simply <code>make benchmark</code> in the distribution directory.</li>
<li>#118: New <code><a class="el" href="timescale_8c.html#a4934da85b9722ef43a5b238f3e1971e4">novas_parse_date()</a></code> / <code><a class="el" href="timescale_8c.html#a5ec9d054b7d363b3db1d065507a1ba41">novas_parse_date_format()</a></code> to parse date/time specifications, <code><a class="el" href="parse_8c.html#ac651a7737d1f10e5267572f5c54fae92">novas_parse_dms()</a></code> and <code><a class="el" href="parse_8c.html#a1aad2a903328080626db399450a7e297">novas_parse_hms()</a></code> to return hours and degrees for HMS and DMS specifications, as well as the updated parse position.</li>
<li>#118: New <code><a class="el" href="timescale_8c.html#ab344242721ca00709d4dc482a7934e2a">novas_timescale_for_string()</a></code> to match timescale constants to string representations, such as "UTC", or "TAI", and <code><a class="el" href="timescale_8c.html#a084e5a2dcd20860af7176754d3a32202">novas_print_timescale()</a></code> to convert to string representation.</li>
<li>#118: New <code><a class="el" href="timescale_8c.html#a4d6da26d0a7d7d904f25d2be00030b25">novas_iso_timestamp()</a></code> to print UTC timestamps in ISO date format with millisecond precision, and <code><a class="el" href="timescale_8c.html#ac8e83c48005d5aabb3e7bbf8d9f8ed81">novas_timestamp()</a></code> to print timestamps in specific timescales. #151: Various fixes to new timestamping after <code>rc7</code>. [thanks to valeriy-sokoloff]</li>
<li>#122: New <code><a class="el" href="calendar_8c.html#a8ed2fb55bcf86d9f1f434a2f832356a2">novas_jd_to_date()</a></code>, and <code><a class="el" href="calendar_8c.html#a54eee84c46900c80ca9966857c217cc8">novas_jd_from_date()</a></code> which convert between JD day and calendar dates using the specific type of calendar: Gregorian, Roman/Julian, or the conventional calendar of date.</li>
<li>#131: New <code><a class="el" href="timescale_8c.html#abaac8a4ea28bc8b811277051e3168468">novas_date()</a></code> and <code><a class="el" href="timescale_8c.html#a66656c3f5a1256f4bfc3ed2e168c70c2">novas_date_scale()</a></code> for the simplest conversion of string times to Julian days, and in case of the latter also to a corresponding timescale (without returning a parse position).</li>
<li>#133: New <code><a class="el" href="timescale_8c.html#a72245b3ea6099c573278f721a4bfd3d9">novas_parse_timescale()</a></code> to parse a timescale from a string specification, and return the updated parse position after also.</li>
<li>#134: New <code><a class="el" href="parse_8c.html#aff8c2c3fae3be867d3fc73972a158514">novas_parse_hours()</a></code> and <code><a class="el" href="parse_8c.html#ad3d04d065e76a5921995e96f67c24c41">novas_parse_degrees()</a></code> to convert strings in decimal or HMS/DMS formats to floating point values for SuperNOVAS, and return the parse position after the time/angle specification.</li>
<li>#135: New <code><a class="el" href="parse_8c.html#ac69c17c646ddf3a5447557338a8490b4">novas_str_hours()</a></code> and <code><a class="el" href="parse_8c.html#a10a24fc28fa74efa75abf566bb61af5b">novas_str_degrees()</a></code> for the simplest conversion of strings in decimal or HMS/DMS formats to floating point values for SuperNOVAS (without retruning a parse position).</li>
<li>#137: New <code><a class="el" href="parse_8c.html#af4e18885b7d173eb3fe5f18b06f0b4d4">novas_epoch()</a></code> to convert string coordinate system specifications to the Julian date of the corresponding epoch, and new <code><a class="el" href="target_8c.html#a5104d7db66ce2d8c61c7ad21599fb45e">make_cat_object_sys()</a></code> and <code><a class="el" href="target_8c.html#a257abae9391aec835dc2b94d9788b9f9">make_redshifted_object_sys()</a></code> to make it simpler to define ICRS catalog sources in the coordinate system of choice.</li>
<li>#143: Added <code>FORTIFY</code> build configuration setting to enable gcc source code fortification checking by setting the <code>_FORTIFY_SOURCE</code> macro to the specified value. It is now used with a value of 3 in the build and test CIs.</li>
<li>#150: Further initializers for SuperNOVAS structures that can be used to empty initialize data.</li>
<li>#154: Added <code><a class="el" href="parse_8c.html#a713869893ad7e58c53e44b37a3bcf768">novas_print_hms()</a></code> and <code><a class="el" href="parse_8c.html#ad778a440540ed687572b78b675bebd60">novas_print_dms()</a></code> functions to convert time / angles to their HMS/DMS string representations, with the chosen separators, and the desired decimal places on the seconds.</li>
<li>#155: Added <code><a class="el" href="timescale_8c.html#ad53b3be5b92ea244cfb0347feb3bec9f">novas_parse_iso_date()</a></code> for pasing ISO 8601 timestamps, including those expressed in the proleptic Gregorian calendar prior to the Gregorian calendar reform of 1582, for which the ISO 8601 timestamp differs from the astronomical calendar date assumed by <code>novas_parse_timestamp()</code>.</li>
<li>Added <code>example-time.c</code> and <code>example-rise-set.c</code> under <code>examples/</code>, for demonstrating date/time handling functions and rise, set, and transit time calculations.</li>
</ul>
<h2><a class="anchor" id="autotoc_md24"></a>
Changed</h2>
<ul>
<li>#130 Use C99 <code>restrict</code> keyword to prevent pointer argument aliasing. Modern compilers will warn if restricted pointer arguments are aliased. At the least, it is a hint to users that pointer arguments marked as such should be distinct from (not overlapping with) the other pointer arguments.</li>
<li>#139 Reorganized code into more manageably sized modules. It also makes the API documentation by source file more logically organized.</li>
<li>#139: Legacy source code moved to <code>legacy/</code> folder.</li>
<li>#150: Use standard C initializers instead of the non-standard empty backets <code>{}</code>. While the empty brackets have been OK with <code>gcc</code> for quite a while, they only became standard in C23. Other compilers might barf at their use.</li>
<li>#152: For C++ compatibility do not use <code>class</code> as a parameter name. [thanks to valeriy-sokoloff]</li>
<li>#156: Omit TDB-TT time difference, a maximum of 2 ms, in Earth tilt calculations, where it really does not make any difference. As a result some calculations are now faster than before.</li>
<li>#156: Higher precision time match requirement for re-using cached ephemeris calculations.</li>
<li>#156: <code><a class="el" href="timescale_8c.html#a129acca41760da486e1179c93cb9e86d">tt2tdb()</a></code> now caches last calculation also.</li>
<li>#156: Eliminate redundant caching of calculations. (Also in #158).</li>
<li>#156: Tighten <code><a class="el" href="equinox_8c.html#a9178358732325399f3a5e3582080ced3">precession()</a></code> time checking.</li>
<li>#157: Switch to <code><a class="el" href="nutation_8c.html#a6f9cddeb8c3dd906b9b0b5941249ad0c">iau2000b()</a></code> as the low-precision nutation series. It is good to about 1 arcsec, which is the promised precision in reduced accuracy, but a lot faster than the <code><a class="el" href="nutation_8c.html#abd066c2857d1b1cc06d8bd51b912d841">nu2000k()</a></code> series, which in turn is barely faster than the full <code><a class="el" href="nutation_8c.html#a280cbf02b13ca57b3d77451be06e7dbc">iau2000a()</a></code> nutation series.</li>
<li>#157: <code><a class="el" href="equinox_8c.html#a312b5ab1a004b179d80463a07ca7da8f">fund_args()</a></code> to always calculate full polynomial expansion. There is little performance to gain from the truncation we used in the vicinity of J2000. No real change in the results.</li>
<li>#159: Add caching to <code><a class="el" href="equinox_8c.html#add7a260017fad0d59c943a0a8d935fcf">ee_ct()</a></code>. Just in case someone wants to call it repeatedly with the same parameters, it will be much much faster now.</li>
<li>In reduced accuracy mode apply gravitational deflection for the Sun only. In prior versions, deflection corrections were applied for Earth too. However, these are below the mas-level accuracy promised in reduced accuracy mode, and without it, the calculations for <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code> and <code><a class="el" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f">novas_sky_pos()</a></code> are significantly faster.</li>
<li>Modified <code><a class="el" href="calendar_8c.html#a7cd85bc0a0248f84d399cbbce9fe9546">julian_date()</a></code> to add range checking for month and day arguments, and return <code>NAN</code> (with <code>errno</code> set to <code>EINVAL</code>) if the input values are invalid.</li>
<li><code><a class="el" href="calendar_8c.html#a7cd85bc0a0248f84d399cbbce9fe9546">julian_date()</a></code> and <code><a class="el" href="calendar_8c.html#a044f1359abcf0a039ac6452a95729b5a">cal_date()</a></code> now use astronomical calendar dates instead of the fixed Gregorian dates of before. Astronomical dates are Julian/Roman calendar dates prior to the Gregorian calendar reform of 1582.</li>
<li><code><a class="el" href="equinox_8c.html#a9178358732325399f3a5e3582080ced3">precession()</a></code> to cache matrices to/from J2000 separately.</li>
<li>Use <code>SIZE_OF_OBJ_NAME</code> and <code>SIZE_OF_CAT_NAME</code> instead of <code>sizeof(obj-&gt;starname)</code> and <code>sizeof(obj-&gt;catalog)</code> internally for improved portability.</li>
<li>Various arithmetic simplifications to give a minor performance boost.</li>
<li>Updated <code>README.md</code> for v1.3 and benchmarks, including comparisons to <b>astropy</b>.</li>
<li>Default <code>THREAD_LOCAL</code> definition extended to C23 <code>thread_local</code> keyword also.</li>
</ul>
<h1><a class="anchor" id="autotoc_md25"></a>
[1.2.0] - 2025-01-15</h1>
<p>Feature release. New easy to use adapter modules for CALCEPH or the NAIF CSPICE Toolkit to provide precise positions for Solar-system sources. Also, added support for Keplerian orbitals, such as the ones published by the IAU Minor Planet Center (MPC) for asteroids, comets, and Near-Earth-Objects (NEOs). And, many more fixes and improvements.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Fixed</h2>
<ul>
<li>Fixes to GCC version checking for macros.</li>
<li>Fixed dummy <code><a class="el" href="solarsystem_8h.html#aa5f22db2fa785675372d45b88f2f1736">readeph()</a></code> implementation in <code>readeph0.c</code>, and the use of <code>DEFAULT_READEPH</code> in <code>config.mk</code>. <code>readeph0.c</code> is not linked by default, and was not linked in prior releases either.</li>
<li>Cure LLVM <code>clang</code> compiler warnings, in tests and examples also.</li>
</ul>
<h2><a class="anchor" id="autotoc_md27"></a>
Added</h2>
<ul>
<li>#57: New generic redshift-handling functions <code><a class="el" href="spectral_8c.html#aa54cd00024b294d38fa29433c017c65f">novas_v2z()</a></code>, <code><a class="el" href="spectral_8c.html#a63621cea3b4985c1bfcc4514a7aa3fb1" title="==========================================================================">novas_z2v()</a></code>.</li>
<li>#57, #102: New <code><a class="el" href="target_8c.html#a11aa3ce6bcdda5b7065b38d6cfaf63d3">make_redshifted_cat_entry()</a></code> and <code><a class="el" href="target_8c.html#ae579a49d84696a913fd0d9f348bb5b11">make_redshifted_object()</a></code> to simplify the creation of distant catalog sources that are characterized with a redshift measure rather than a radial velocity value.</li>
<li>#58: New functions to calculate and apply additional gravitational redshift corrections for light that originates near massive gravitating bodies (other than major planets, or Sun or Moon), or for observers located near massive gravitating bodies (other than the Sun and Earth). The added functions are <code><a class="el" href="grav_8c.html#a3ce6b306bc183387d0aaac97abbd82e8">grav_redshift()</a></code>, <code>redhift_vrad()</code>, <code><a class="el" href="spectral_8c.html#aea89203030ca831260dec18f83081d23">unredshift_vrad()</a></code>, <code><a class="el" href="spectral_8c.html#a493ab751eee5804db77157c37e94e5c3">novas_z_add()</a></code>, and <code><a class="el" href="spectral_8c.html#a1130ad2ce520e948c71f03a25a713075">novas_z_inv()</a></code>.</li>
<li>#83: CALCEPH integration: <code><a class="el" href="solsys-calceph_8c.html#a35fc86a939602ec910dbdfde180d7f31">novas_use_calceph()</a></code> and/or <code><a class="el" href="solsys-calceph_8c.html#ab86ec03898e658c86c671a8b6399e331">novas_use_calceph_planets()</a></code> to specify and use ephemeris data via CALCEPH for Solar-system sources in general, and for major planets specifically; and <code><a class="el" href="solsys-calceph_8c.html#a5531b937a5bb5491cb475d2536346ad8">novas_calceph_use_ids()</a></code> to specify whether <code><a class="el" href="structobject.html#a7d578acc2a3e88ef2435fe0e88d01a74" title="enum novas_planet, or minor planet ID (e.g. NAIF), or star catalog ID.">object.number</a></code> in <code>NOVAS_EPHEM_OBJECT</code> type objects is a NAIF ID (default) or else a CALCEPH ID number of the Solar-system body. These functions are provided by the <code>libsolsys-calceph.so[.1]</code> and/or <code>.a</code> plugin libraries, which are built contingent on the <code>CALCEPH_SUPPORT</code> variable being set to 1 prior to the build. The build of the plugin module requires an accessible installation of the CALCEPH development files (C headers and unversioned static or shared libraries depending on the needs of the build).</li>
<li>#86: NAIF CSPICE integration: <code><a class="el" href="solsys-cspice_8c.html#a9b44218bca5fce1e9e5103494c15dde4">novas_use_cspice()</a></code>, <code><a class="el" href="solsys-cspice_8c.html#a943549e395b19f6a91064e3d6fa1c577">novas_use_cspice_planets()</a></code>, <code><a class="el" href="solsys-cspice_8c.html#afb078e1df9b5b08999d24e68d7b4ecdc">novas_use_cspice_ephem()</a></code> to use the NAIF CSPICE library for all Solar-system sources, major planets only, or for other bodies only. <code>NOVAS_EPHEM_OBJECTS</code> should use NAIF IDs with CSPICE (or else -1 for name-based lookup). Also provides <code><a class="el" href="solsys-cspice_8c.html#ae02d26964099f56c375dc78172ad135b">cspice_add_kernel()</a></code> and <code><a class="el" href="solsys-cspice_8c.html#a38e3b3155cad3b3822fbc3e553060ab1">cspice_remove_kernel()</a></code> functions for convenience to manage the set of active kernels (#89). These functions are provided by the <code>libsolsys-cspice.so[.1]</code> and/or <code>.a</code> plugin libraries, which are built contingent on the <code>CSPICE_SUPPORT</code> variable being set to 1 prior to the build. The build of the plugin module requires an accessible installation of the CSPICE development files (C headers and unversioned static or shared libraries depending on the needs of the build).</li>
<li>#87: Added <code><a class="el" href="target_8c.html#a2cf7410aa68b980112734227b40890d6">novas_planet_for_name()</a></code> function to return the NOVAS planet ID for a given (case insensitive) name.</li>
<li>NOVAS-NAIF conversions for major planets (and Sun, Moon, SSB): <code><a class="el" href="naif_8c.html#ab51ac9bdf7736e1c1582e0981046daf3">novas_to_naif_planet()</a></code> (planet centers), <code><a class="el" href="naif_8c.html#ac3eb54acf22dc155879163de89c6865e">novas_to_dexxx_planet()</a></code> (mixed planet center/barycenter for DExxx ephemeris files), and the inverse <code><a class="el" href="naif_8c.html#a1c4b3f67a3b82808dd16ae43dfaf0f86">naif_to_novas_planet()</a></code>.</li>
<li>Added <code><a class="el" href="plugin_8c.html#a0f0a786b5614a788c02b37a462eae2d2">get_planet_provider()</a></code> and <code><a class="el" href="plugin_8c.html#ae45badb450c1ca73920d982e12346c5b">get_planet_provider_hp()</a></code> functions for convenience to return the <code><a class="el" href="solsys1_8c.html#a37c25dbc2683dc9e3b1d187e13f68330">solarsystem()</a></code> / <code><a class="el" href="solsys1_8c.html#a17846f3fafcce208dbbca1384e3a7fb0">solarsystem_hp()</a></code> type custom planet ephemeris provider functions currently configured, so they may be used directly, outside of <code><a class="el" href="place_8c.html#a713982e1f2bae0a72b39d03007f00d23">ephemeris()</a></code> calls.</li>
<li>#93: Now supporting <code>make install</code> with <code>prefix</code> and <code>DESTDIR</code> support (e.g. <code>make prefix="/opt" install</code> to install under <code>/opt</code>, and/or <code>make DESTDIR="/tmp/stage" install</code> to stage install under <code>/tmp/stage</code>). You can also set other standard directory variables, as prescribed by the <a href="https://www.gnu.org/prep/standards/html_node/Directory-Variables.html">GNU standard</a> to further customize the install locations.</li>
<li>#95, #98: Added support for using orbital elements. <code><a class="el" href="structobject.html#a2cc80aad5c0303449e2412b122504a10" title="NOVAS object type.">object.type</a></code> can now be set to <code>NOVAS_ORBITAL_OBJECT</code>, whose orbit can be defined by the set of <code><a class="el" href="structnovas__orbital.html">novas_orbital</a></code>, relative to a <code><a class="el" href="structnovas__orbital__system.html">novas_orbital_system</a></code>. You can initialize an <code>object</code> with a set of orbital elements using <code><a class="el" href="target_8c.html#a3c5e215babeeba078ca7b3e9be42e555">make_orbital_object()</a></code>, and for planetary satellite orbits you might use <code><a class="el" href="orbital_8c.html#a706ecf8998b78e48051d2876efc6e01c">novas_set_orbsys_pole()</a></code>. For orbital objects, <code><a class="el" href="place_8c.html#a713982e1f2bae0a72b39d03007f00d23">ephemeris()</a></code> will call on the new <code><a class="el" href="orbital_8c.html#a4510a3235a693f122899983901211c30">novas_orbit_posvel()</a></code> to calculate positions. While orbital elements do not always yield precise positions, they can for shorter periods, provided that the orbital elements are up-to-date. For example, the Minor Planer Center (MPC) publishes accurate orbital elements for all known asteroids and comets regularly. For newly discovered objects, this may be the only and/or most accurate information available anywhere.</li>
<li>#97: Added <code>NOVAS_EMB</code> (Earth-Moon Barycenter) and <code>NOVAS_PLUTO_BARYCENTER</code> to <code>enum novas_planets</code> to distinguish from the planet center in calculations.</li>
<li>#98: Added <code><a class="el" href="transform_8c.html#a9c900b81a718a184281a8a0b733b4db7">gcrs_to_tod()</a></code> / <code><a class="el" href="transform_8c.html#a6871e7fecde44084c7b4e1b8dda5ac70">tod_to_gcrs()</a></code> and <code><a class="el" href="transform_8c.html#a75de6cca190c5fbc3056db726f317c7f">gcrs_to_mod()</a></code> / <code><a class="el" href="transform_8c.html#ad9cc07f0e6af9339096e15a440b113e5">mod_to_gcrs()</a></code> vector conversion functions for convenience.</li>
<li>#106: New example files under <code>examples/</code> demonstrating the recommended approach for using SuperNOVAS to calculate positions for various types of object.</li>
<li>Added various <code>object</code> initializer macros in <code><a class="el" href="novas_8h.html">novas.h</a></code> for the major planets, Sun, Moon, and barycenters, e.g. <code>NOVAS_EARTH_INIT</code> or <code>NOVAS_SSB_INIT</code>. These wrap the parametric <code><a class="el" href="novas_8h.html#ad34a88c2c04b624f8f85fc86e7935967">NOVAS_PLANET_INIT(num, name)</a></code> macro, and can be used to simplify the initialization of NOVAS <code>object</code>s.</li>
<li>Added more physical unit constants to <code><a class="el" href="novas_8h.html">novas.h</a></code> and a corresponding section in the README on how these may be used to convert to/from NOVAS conventional quantities.</li>
<li>SuperNOVAS headers now include each other as system-headers, not local headers. This is unlikely to affect anything really but it is more proper for an installation of the library, and works with our own <code>Makefile</code> too.</li>
<li>Added 'Coordinate Systems and Conversions' flowchart to <code>README</code>.</li>
<li>Added a GNU standard documentation targets to <code>Makefile</code>.</li>
<li>Added <code>infer</code> make target for running Facebook's <code>infer</code> static analysis tool.</li>
<li>Added missing error tracing in <code><a class="el" href="equinox_8c.html#a69df5671751c09a7575963b94ad1151e">nutation()</a></code>.</li>
<li>Added <code>README.md</code> Figure 1, to clarify relation of coordinate systems and (Super)NOVAS function to convert vectors among them.</li>
</ul>
<h2><a class="anchor" id="autotoc_md28"></a>
Changed</h2>
<ul>
<li>#96: Changed <code>object</code> structure to include <code><a class="el" href="structnovas__orbital.html">novas_orbital</a></code> for <code>NOVAS_ORBITAL_OBJECT</code> types. To keep ABI compatibility to earlier SuperNOVAS releases, <code><a class="el" href="target_8c.html#a411f70fb77582d750c5269fcd64b0ce2">make_object()</a></code> will not initialize the new <code>.orbit</code> field <em>unless</em> <code>type</code> is set to <code>NOVAS_ORBITAL_OBJECT</code> (which was not available before).</li>
<li>#97: Updated <code>NOVAS_PLANETS</code>, <code>NOVAS_PLANET_NAMES_INIT</code>, and <code>NOVAS_RMASS_INIT</code> macros to include the added planet constants.</li>
<li>#106: The old (legacy) NOVAS C example has been removed. Instead a new set of examples are provided, which are better suited for SuperNOVAS.</li>
<li><code>make check</code> now runs both static analysis by cppcheck (new <code>analysis</code> target) and regression tests (<code>test</code> target), in closer conformance to GNU Makefile standards.</li>
<li>Added <code>-g</code> to default <code>CFLAGS</code> as a matter of GNU best practice.</li>
<li>Static library is now named <code>ibsupernovas.a</code>, which is symlinked to <code>libnovas.a</code> for back compatibility.</li>
<li><code>readeph0.c</code> moved to <code>examples/</code>. It's a dummy legacy NOVAS C implementation that is not really needed in SuperNOVAS.</li>
<li>Various small tweaks to Makefiles.</li>
<li>Updated <code>README.md</code> and API documentation.</li>
</ul>
<h1><a class="anchor" id="autotoc_md29"></a>
[1.1.1] - 2024-10-28</h1>
<p>Bug fix release. Nothing too scary, mainly just a collection of smaller fixes and improvements.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
Fixed</h2>
<ul>
<li>#55: Relativistic corrections to radial velocity were still not applied correctly. The revised calculation now uses the actual relativistic velocity differential between the source and observer to apply the appropriate time dilation factor, and applies gravitational corrections for Sun and Earth consistently at source and observer alike.</li>
<li>#64: <code>NOVAS_TAI_TO_TT</code> definition had wrong decimal in last place, thus was 3 ms off from what it should have been. (thanks to kiranshila)</li>
<li>#68: <code>readeph_dummy()</code> dummy implementation in <code>readeph0.c</code> called non existing error handler function.</li>
</ul>
<h2><a class="anchor" id="autotoc_md31"></a>
Changed</h2>
<ul>
<li>#59: For observing major planets (and Sun and Moon) <code><a class="el" href="spectral_8c.html#afca24d914664bb60d20fb428177f329a">rad_vel()</a></code>, <code><a class="el" href="spectral_8c.html#a37f22e463cc06b4e381aa18659e6319d">rad_vel2()</a></code>, <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code>, and <code><a class="el" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f">novas_sky_pos()</a></code> will include gravitational corrections to radial velocity for light originating at the surface, and observed near Earth or else at a large distance away. These corrections, along with those for the Solar potential at the source, may be skipped for <code><a class="el" href="spectral_8c.html#afca24d914664bb60d20fb428177f329a">rad_vel()</a></code> / <code><a class="el" href="spectral_8c.html#a37f22e463cc06b4e381aa18659e6319d">rad_vel2()</a></code> by setting <code>d_src_sun</code> negative.</li>
<li>#55: Use relativistic formulae to add/difference velocities (i.e. change velocity reference frame).</li>
<li>#60: Moved SuperNOVAS-only functions to a separate <code>super.c</code> module to alleviate the bloating of <code>novas.c</code>, which can still be used as a self-contained, standalone, NOVAS C replacement for legacy applications if need be.</li>
<li>#62: Improve debug mode error tracing when NAN values are returned, so the trace indicates NAN rather than a bogus integer return value before.</li>
<li>#66: Various tweaks for C/C++ best practices (by kiranshila)</li>
<li>#67: Use accuracy argument in <code><a class="el" href="transform_8c.html#adb48b2acaf76cc3a1e3a1412cc42c232">tod_to_cirs()</a></code>. (thanks to kiranshila)</li>
<li>#68: Various improvements to debug error tracing.</li>
<li>#73: Initializer macros (primarily for internal use), forced 'use' of unused variables after declarations, and no order-only-dependencies in Makefiles &ndash; in order to cure warnings and to conform with older compilers and make.</li>
<li>Slight tweaks to <code>Makefile</code>, and <code>.mk</code> snippets, with added <code>make</code> configurability.</li>
</ul>
<h1><a class="anchor" id="autotoc_md32"></a>
[1.1.0] - 2024-08-04</h1>
<p>Feature release. Introducing a more efficient and elegant approach to position and velocity calculations using observer frames; versatile handling of astronomical timescales; and support for further observer locations, coordinate reference systems, and atmospheric refraction models. The release also fixes a number of bugs, of varying severity, which affected prior SuperNOVAS releases.</p>
<h2><a class="anchor" id="autotoc_md33"></a>
Fixed</h2>
<ul>
<li>#29: Fix portability to non-Intel platforms. Previously, SuperNOVAS used <code>char</code> for storing small integer coefficients, assuming <code>char</code> was signed. However, on some platforms like ARM and PowerPC <code>char</code> is unsigned, which broke calculations badly. As of now, we use the explicit platform independent signed <code>int8_t</code> storage type for these coefficients.</li>
<li>#38: <code><a class="el" href="transform_8c.html#aeea4b5085c7267714492fae6108fb975">gcrs_to_j2000()</a></code> transformed in the wrong direction in v1.0.</li>
<li>#39: <code><a class="el" href="transform_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3">tod_to_itrs()</a></code> used wrong Earth rotation measure (<code>NOVAS_ERA</code> instead of <code>NOVAS_GST</code>) in v1.0.</li>
<li>#45: <code><a class="el" href="transform_8c.html#a6217852bfd7d3a58d3266d0daadfc6bc">cel2ter()</a></code> invalid output in v1.0 with CIRS input coordinates (<code>erot</code> = <code>EROT_ERA</code> and <code>class</code> = <code>NOVAS_DYNAMICAL_CLASS</code>) if output vector was distinct from input vector. Affects <code><a class="el" href="transform_8c.html#aa2768d89d499a7155f90a6fd8c176d8d">cirs_to_itrs()</a></code> also.</li>
<li>#36: <code><a class="el" href="timescale_8c.html#a129acca41760da486e1179c93cb9e86d">tt2tdb()</a></code> Had a wrong scaling in sinusoidal period in v1.0, resulting in an error of up to +/- 1.7 ms.</li>
<li>#37: <code><a class="el" href="transform_8c.html#a51ea4a016336dd3cf7783061c14d165c">gcrs_to_cirs()</a></code> did not handle well if input and output vectors were the same in v1.0.</li>
<li>#28: Division by zero bug in <code><a class="el" href="util_8c.html#ad799864f637c483fb49491bde5a93e25">d_light()</a></code> (since NOVAS C 3.1) if the first position argument is the ephemeris reference position (e.g. the Sun for <code><a class="el" href="solsys3_8c.html">solsys3.c</a></code>). The bug affects for example <code><a class="el" href="grav_8c.html#a48f90ac20950507fad9b880a7f7f2383">grav_def()</a></code>, where it effectively results in the gravitational deflection due to the Sun being skipped. See Issue #28.</li>
<li>#41: <code><a class="el" href="grav_8c.html#a48f90ac20950507fad9b880a7f7f2383">grav_def()</a></code> gravitating body position antedated somewhat incorrectly (in v1.0) when observed source is a Solar-system object between the observer and the gravitating body. The resulting positional error is typically small at below 10 uas.</li>
<li>#50: The NOVAS C 3.1 implementation of <code><a class="el" href="spectral_8c.html#afca24d914664bb60d20fb428177f329a">rad_vel()</a></code> applied relativistic corrections for a moving observer conditional on applying relativistic gravitational corrections (for Sun and/or Earth potential) for the observer. However, it seems more reasonable that the corrections for a moving observer should be applied always and independently of the (optional) gravitational corrections.</li>
<li>#34: <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code> radial velocities were not quite correct in prior SuperNOVAS releases. The radial velocity calculation now precedes aberration, since the radial velocity that is observed is in the geometric direction towards the source (unaffected by aberration). As for gravitational deflection, the geometric direction is the correct direction in which light was emitted from the source for sidereal objects. For Solar system sources we now reverse trace the deflected light to calculate the direction in which it was emitted from the source. As such, the radial velocities calculated should now be precise under all conditions. The typical errors of the old calculations were up to tens of m/s because of aberration, and a few m/s due to the wrong gravitational deflection calculation.</li>
<li>#24: Bungled definition of <code>SUPERNOVAS_VERSION_STRING</code> in <code><a class="el" href="novas_8h.html">novas.h</a></code> in v1.0.</li>
<li>Bungled definition of <code>NOVAS_OBSERVER_PLACES</code> in <code><a class="el" href="novas_8h.html">novas.h</a></code> in v1.0.</li>
</ul>
<h2><a class="anchor" id="autotoc_md34"></a>
Added</h2>
<ul>
<li>#33: New observing-frame based approach for calculations (<code><a class="el" href="frames_8c.html">frames.c</a></code>). A <code><a class="el" href="structnovas__frame.html">novas_frame</a></code> object uniquely defines both the place and time of observation, with a set of pre-calculated transformations and constants. Once the frame is defined it can be used very efficiently to calculate positions for multiple celestial objects with minimum additional computational cost. The frames API is also more elegant and more versatile than the low-level NOVAS C approach for performing the same kind of calculations. And, frames are inherently thread-safe since post-creation their internal state is never modified during the calculations. The following new functions were added: <code><a class="el" href="frames_8c.html#adc72577f99a7b076b23e0e44ddbca838">novas_make_frame()</a></code>, <code><a class="el" href="frames_8c.html#a2972b3eafa2d7f6c29cff34bad9fcf0d">novas_change_observer()</a></code>, <code><a class="el" href="frames_8c.html#ac6652ee3257621080dac342313d0a0a7">novas_geom_posvel()</a></code>, <code><a class="el" href="frames_8c.html#a4817703c9357f702a27812584c91f87c">novas_geom_to_app()</a></code>, <code><a class="el" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f">novas_sky_pos()</a></code>, <code><a class="el" href="frames_8c.html#a3cd947f2e48d6c5cc88ad7a1bab9b8ca">novas_app_to_hor()</a></code>, <code><a class="el" href="frames_8c.html#ab7db8026c598e8e126a4725ac3b388bf">novas_app_to_geom()</a></code>, <code><a class="el" href="frames_8c.html#aa57cbcae2001fece2ee4a2babfbc5f89">novas_hor_to_app()</a></code>.</li>
<li>#33: New coordinate system transformations via the <code><a class="el" href="structnovas__transform.html">novas_transform</a></code> structure. You may use these transforms to express position / velocity vectors, calculated for a given observer and time, in the coordinate reference system of choice.The following new functions were added: <code><a class="el" href="frames_8c.html#a4d179c8573319fc25c775ce56ba055dc">novas_make_transform()</a></code>, <code><a class="el" href="frames_8c.html#ad2081e123024609d3071b33b183502b7">novas_invert_transform()</a></code>, <code><a class="el" href="frames_8c.html#aa77895c891e9eeb4b1541f03acfd154e">novas_transform_vector()</a></code>, and <code><a class="el" href="frames_8c.html#acfcfb90637cd1fdb25ef9afd1bda8e30">novas_transform_sky_pos()</a></code>.</li>
<li>#33: New <code><a class="el" href="structnovas__timespec.html">novas_timespec</a></code> structure for the self-contained definition of precise astronomical time (<code><a class="el" href="timescale_8c.html">timescale.c</a></code>). You can set the time via <code><a class="el" href="timescale_8c.html#af4a1a5180905a7d8f76aeafe3f9a8ebb">novas_set_time()</a></code> or <code><a class="el" href="timescale_8c.html#ad47bcb1e3c5df56a0ffdf1a127e52598">novas_set_split_time()</a></code> to a JD date in the timescale of choice (UTC, UT1, GPS, TAI, TT, TCG, TDB, or TCB), or to a UNIX time with <code><a class="el" href="timescale_8c.html#a9d54ea7c6cdbc75ee78cf552a7e1858d">novas_set_unix_time()</a></code>. Once set, you can obtain an expression of that time in any timescale of choice via <code><a class="el" href="timescale_8c.html#ae30e3dd8e30bdcf4e8486cfce696fb98">novas_get_time()</a></code>, <code><a class="el" href="timescale_8c.html#a32d8336084b65fac14d092ab6198c27d">novas_get_split_time()</a></code> or <code><a class="el" href="timescale_8c.html#afa1a1d804ca70050418429f971c2045a">novas_get_unix_time()</a></code>. And, you can create a new time specification by incrementing an existing one, using <code>novas_increment_time()</code>, or measure time differences via <code><a class="el" href="timescale_8c.html#abdcc8e194d79787838d1ffc064449932">novas_diff_time()</a></code>, <code><a class="el" href="timescale_8c.html#ab904df0f504d07bbf73f84e2a1c43e07">novas_diff_tcg()</a></code>, or <code><a class="el" href="timescale_8c.html#a4818ab9be2f0891091c719db01bcfa98">novas_diff_tcb()</a></code>.</li>
<li>Added <code><a class="el" href="structnovas__planet__bundle.html">novas_planet_bundle</a></code> structure to handle planet positions and velocities more elegantly (e.g. for gravitational deflection calculations).</li>
<li>#32: Added <code><a class="el" href="grav_8c.html#aaae33249717912663bbb00be4fa4e6c3">grav_undef()</a></code> to undo gravitational bending of the observed light to obtain geometric positions from observed ones.</li>
<li>Added <code><a class="el" href="observer_8c.html#a0e4e5ff7c37e6521ca75ae62aaf4050e">obs_posvel()</a></code> to calculate the observer position and velocity relative to the Solar System Barycenter (SSB).</li>
<li>Added <code><a class="el" href="observer_8c.html#a07490a134a685fe0842b2b4816559292">obs_planets()</a></code> to calculate apparent planet positions (relative to observer) and velocities (w.r.t. SSB).</li>
<li>Added new observer locations <code>NOVAS_AIRBORNE_OBSERVER</code> for an observer moving relative to the surface of Earth e.g. in an aircraft or balloon based telescope platform, and <code>NOVAS_SOLAR_SYSTEM_OBSERVER</code> for spacecraft orbiting the Sun. Both of these use the <code><a class="el" href="structobserver.html#a1ab1241c3bb4d3afc4710e02e948c0cb">observer.near_earth</a></code> strcture to define (positions and) velocities as appropriate. Hence the <code>'near_earth</code> name is a bit misleading, but remains for back compatibility.</li>
<li>Added coordinate reference systems <code>NOVAS_MOD</code> (Mean of Date) which includes precession by not nutation and <code>NOVAS_J2000</code> for the J2000 dynamical reference system.</li>
<li>New observer locations <code>NOVAS_AIRBORNE_OBSERVER</code> and <code>NOVAS_SOLAR_SYSTEM_OBSERVER</code>, and corresponding <code><a class="el" href="observer_8c.html#aa423a88cd3f434642fc89d47390184f4">make_airborne_observer()</a></code> and <code><a class="el" href="observer_8c.html#a9c3f1a1bc3fd9ac6d211806913d2d529">make_solar_system_observer()</a></code> functions. Airborne observers have an Earth-fixed momentary location, defined by longitude, latitude, and altitude, the same way as for a stationary observer on Earth, but are moving relative to the surface, such as in an aircraft or balloon based observatory. Solar-system observers are similar to observers in Earth-orbit but their momentary position and velocity is defined relative to the Solar System Barycenter (SSB), instead of the geocenter.</li>
<li>Added humidity field to <code><a class="el" href="structon__surface.html">on_surface</a></code> structure, e.g. for refraction calculations at radio wavelengths. The <code><a class="el" href="observer_8c.html#a42c084465aedee75965f74e23e6571fe">make_on_surface()</a></code> function will set humidity to 0.0, but the user can set the field appropriately afterwards.</li>
<li>New set of built-in refraction models to use with the frame-based <code><a class="el" href="frames_8c.html#a3cd947f2e48d6c5cc88ad7a1bab9b8ca">novas_app_to_hor()</a></code> / <code><a class="el" href="frames_8c.html#aa57cbcae2001fece2ee4a2babfbc5f89">novas_hor_to_app()</a></code> functions. The models <code><a class="el" href="refract_8c.html#ab04bff3b97c132e358e11c3a5b7a3081">novas_standard_refraction()</a></code> and <code><a class="el" href="refract_8c.html#ae4511a80a1defbb1e1fdc29c289e7de4">novas_optical_refraction()</a></code> implement the same refraction model as <code><a class="el" href="refract_8c.html#ac7ed2a1a5fb5aea3063d116d3d980eeb">refract()</a></code> in NOVAS C 3.1, with <code>NOVAS_STANDARD_ATMOSPHERE</code> and <code>NOVAS_WEATHER_AT_LOCATION</code> respectively, including the reversed direction provided by <code><a class="el" href="refract_8c.html#afe1d4e96dd66676f5567a279e83e88d9">refract_astro()</a></code>. The user may supply their own custom refraction also, and may make use of the generic reversal function <code><a class="el" href="refract_8c.html#a81da80ae3ab1d0a444f39bde2af3a732">novas_inv_refract()</a></code> to calculate refraction in the reverse direction (observer vs astrometric elevations) as needed.</li>
<li>Added radio refraction model <code><a class="el" href="refract_8c.html#a6b49f92f8f818f2272613e3432185a39">novas_radio_refraction()</a></code> based on the formulae by Berman &amp; Rockwell 1976.</li>
<li>Added <code><a class="el" href="transform_8c.html#a9cac4f3a18d4c14939519e7123b4d504">cirs_to_tod()</a></code> and <code><a class="el" href="transform_8c.html#adb48b2acaf76cc3a1e3a1412cc42c232">tod_to_cirs()</a></code> functions for efficient tranformation between True of Date (TOD) and Celestial Intermediate Reference System (CIRS), and vice versa.</li>
<li>Added <code><a class="el" href="target_8c.html#ab9b7a622486f2904615ceed1ba94cd8f">make_cat_object()</a></code> function to create a NOVAS celestial <code>object</code> structure from existing <code><a class="el" href="structcat__entry.html">cat_entry</a></code> data.</li>
<li>Added <code><a class="el" href="spectral_8c.html#a37f22e463cc06b4e381aa18659e6319d">rad_vel2()</a></code> to calculate radial velocities precisely in the presense of gravitational deflection i.e., when the direction in which light was emitted is different from the direction it is detected by the observer. This new function is now used by both <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code> and <code><a class="el" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f">novas_sky_pos()</a></code>.</li>
<li><code>make help</code> to provide a brief list and explanation of the available build targets. (Thanks to <code>@teuben</code> for suggesting this.)</li>
<li>Added GitHub CI regression testing for non-x86 platforms: <code>armv7</code>, <code>aarch64</code>, <code>riscv64</code>, <code>ppc64le</code>. Thus, we should avoid misphaps, like the platform specific bug Issue #29, in the future.</li>
</ul>
<h2><a class="anchor" id="autotoc_md35"></a>
Changed</h2>
<ul>
<li>#42: <code><a class="el" href="cio_8c.html#afc894b55420495a727a90d3d85188ef4">cio_array()</a></code> can now parse the original ASCII CIO locator data file (<code>data/CIO_RA.TXT</code>) efficiently also, thus no longer requiring a platform-specific binary translation via the <code>cio_file</code> tool.</li>
<li>#51: The NOVAS C implementation of <code><a class="el" href="spectral_8c.html#afca24d914664bb60d20fb428177f329a">rad_vel()</a></code> has ignored this redshifting when the Sun was being observed. From now on, we shall gravitationally reference radial velocities when observing the Sun to its photosphere.</li>
<li><code>cio_file</code> tool parses interval from header rather than the less precise differencing of the first two record timestamps. This leads to <code><a class="el" href="cio_8c.html#afc894b55420495a727a90d3d85188ef4">cio_array()</a></code> being more accurately centered on matching date entries, e.g. J2000.</li>
<li><code><a class="el" href="grav_8c.html#a48f90ac20950507fad9b880a7f7f2383">grav_def()</a></code> estimation of light time to where light passes nearest to gravitating body is improved by starting with the body position already antedated for light-time for the gravitating mass. The change typically improves the grativational deflection calculations at the few uas level.</li>
<li><code><a class="el" href="grav_8c.html#a48f90ac20950507fad9b880a7f7f2383">grav_def()</a></code> is simplified. It no longer uses the location type argument. Instead it will skip deflections due to any body, if the observer is within ~1500 km of its center.</li>
<li><code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code> now returns an error 3 if and only if the observer is at (or very close, to within ~1.5m) of the observed Solar-system object.</li>
<li>Improved precision of some calculations, like <code><a class="el" href="earth_8c.html#aef1f8daaad470353648de90576aefc66">era()</a></code>, <code><a class="el" href="equinox_8c.html#a312b5ab1a004b179d80463a07ca7da8f">fund_args()</a></code>, and <code><a class="el" href="equinox_8c.html#aacc6a0daf29b8bdc18f46647a94694d3">planet_lon()</a></code> by being more careful about the order in which terms are accumulated and combined, resulting in a small improvement on the few uas (micro-arcsecond) level.</li>
<li><code><a class="el" href="util_8c.html#a84f672dc1c37e3af374198f29cbcfba9">vector2radec()</a></code>: <code>ra</code> or <code>dec</code> arguments may now be NULL if not required.</li>
<li><code><a class="el" href="timescale_8c.html#a129acca41760da486e1179c93cb9e86d">tt2tdb()</a></code> Now uses the same, slightly more precise series as the original NOVAS C <code><a class="el" href="timescale_8c.html#a90d5fae30728b51151c3daf355ca585b">tdb2tt()</a></code>.</li>
<li><code><a class="el" href="spectral_8c.html#afca24d914664bb60d20fb428177f329a">rad_vel()</a></code> You can use negative values for the distances to skip particular gravitational corrections to the radial velocity measure. The value 0.0 also continues to have the same effect as before, except if the observed source is the Sun. Then <code>d_src_sun</code> being 0.0 takes on a different meaning than before: rather than skipping gravitational redshift corrections for the Solar potential (as before) we will apply gravitational corrections for light originating at the Sun's photosphere.</li>
<li><code>PSI_COR</code> and <code>EPS_COR</code> made globally visible again, thus improving NOVAS C 3.1 compatibility.</li>
<li>Convergent inverse calculations now use the <code>novas_inv_max_iter</code> variable declared in <code>novas.c</code> to specify the maximum number of iterations before inverse functions return with an error (with errno set to <code>ECANCELED</code>). Users may adjust this limit, if they prefer some other maximum value.</li>
<li>Adjusted regression testing to treat <code>nan</code> and <code>-nan</code> effectively the same. They both represent an equally invalid result regardless of the sign.</li>
<li>The default make target is now <code>distro</code>. It's similar to the deprecated <code>api</code> target from before except that it skips building <code>static</code> libraries and <code>cio_ra.bin</code>.</li>
<li><code>make</code> now generates <code>.so</code> shared libraries with <code>SONAME</code> set to <code>lib&lt;name&gt;.so.1</code> where the <code>.1</code> indicates that it is major version 1 of the <code>ABI</code>. All 1.x.x releases are expected to be ABI compatible with earlier releases.</li>
<li><code>lib/*.so</code> files are now just symlinks to the actual versioned libraries <code>lib/*.so.1</code>. This conforms more closely to what Linux distros expect.</li>
<li>Default <code>make</code> skips <code>local-dox</code> target unless <code>doxygen</code> is available (either in the default <code>PATH</code> or else specified via the <code>DOXYGEN</code> variable, e.g. in <code>config.mk</code>). This way the default build does not have unexpected dependencies. (see Issue #22, thanks to <code>@teuben</code>).</li>
<li><code>make</code> can be configured without editing <code>config.mk</code> simply by setting the appropriate shell variables (the same ones as in <code>config.mk</code>) prior to invoking <code>make</code>. Standard <code>CC</code>, <code>CPPFLAGS</code>, <code>CFLAGS</code> and <code>LDFLAGS</code> will also be used if defined externally.</li>
<li><code>make shared</code> now also builds <code>lib/libsolsys1.so.1</code> and <code>lib/libsolsys2.so.1</code> shared libraries that can be used by programs that need solsys1 (via <code>eph_manager</code>) or solsys2 (via <code>jplint</code>) functionality.</li>
<li><code>make solsys</code> now generates only the <code><a class="el" href="solsys1_8c.html#a37c25dbc2683dc9e3b1d187e13f68330">solarsystem()</a></code> implementation objects that are external (not built in).</li>
<li>Eliminate unchecked return value compiler warnings from <code>cio_file</code> (used typically at build time only to generate <code>cio_ra.bin</code>).</li>
<li><code>jplint.f</code> is moved to <code>examples/</code> since it provides only a default implementation that typically needs to be tweaked for the particualr JPL PLEPH library one intends to use.</li>
<li>Doxygen tag file renamed to <code>supernovas.tag</code> for consistency.</li>
<li>Initialize test variables for reproducibility</li>
</ul>
<h1><a class="anchor" id="autotoc_md36"></a>
[1.0.1] - 2024-05-13</h1>
<p>Bug fix release with minor changes.</p>
<h2><a class="anchor" id="autotoc_md37"></a>
Fixed</h2>
<ul>
<li><code><a class="el" href="transform_8c.html#aa2768d89d499a7155f90a6fd8c176d8d">cirs_to_itrs()</a></code>, <code><a class="el" href="transform_8c.html#a12953f66c0f774284f0700ae785784d0">itrs_to_cirs()</a></code>, <code><a class="el" href="transform_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3">tod_to_itrs()</a></code>, and <code><a class="el" href="transform_8c.html#a3f6ae564cfac3766a21e0754905e5f7c">itrs_to_tod()</a></code> all had a unit conversion bug in using the <code>ut1_to_tt</code> argument [s] when converting TT-based Julian date to UT1-based JD [day] internally. (thanks to hannorein)</li>
<li>Fixed errors in <code>example.c</code> [by hannorein].</li>
</ul>
<h2><a class="anchor" id="autotoc_md38"></a>
Added</h2>
<ul>
<li>Added <code><a class="el" href="transform_8c.html#af90d52a6527d9b62b8ac35d8c1ac7c6b">cirs_to_app_ra()</a></code> and <code><a class="el" href="transform_8c.html#a3fa57a154f2f423612736e5e3a5addbf">app_to_cirs_ra()</a></code> for convenience to convert between right ascensions measured from the CIO (for CIRS) vs measured from the true equinox of date, on the same true equator of date.</li>
</ul>
<h2><a class="anchor" id="autotoc_md39"></a>
Changed</h2>
<ul>
<li>Changed definition of <code>NOVAS_AU</code> to the IAU definition of exactly 1.495978707e+11 m. The old definition is also available as <code>DE405_AU</code>. (thanks to hannorein)</li>
<li>Various corrections and changes to documentation.</li>
</ul>
<h1><a class="anchor" id="autotoc_md40"></a>
[1.0.0] - 2024-03-01</h1>
<p>This is the initial release of the SuperNOVAS library. Changes are indicated w.r.t. the upstream NOVAS C 3.1 library from which SuperNOVAS is forked from.</p>
<h2><a class="anchor" id="autotoc_md41"></a>
Fixed</h2>
<ul>
<li>Fixes the NOVAS C 3.1 <a href="https://aa.usno.navy.mil/software/novas_faq">sidereal_time bug</a>, whereby the <code><a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time()</a></code> function had an incorrect unit cast.</li>
<li>Fixes antedating velocities and distances for light travel time in NOVAS C 3.1 <code><a class="el" href="place_8c.html#a713982e1f2bae0a72b39d03007f00d23">ephemeris()</a></code>. When getting positions and velocities for Solar-system sources, it is important to use the values from the time light originated from the observed body rather than at the time that light arrives to the observer. This correction was done properly for positions, but not for velocities or distances, resulting in incorrect observed radial velocities or apparent distances being reported for spectroscopic observations or for angular-physical size conversions.</li>
<li>Fixes NOVAS C 3.1 bug in <code><a class="el" href="equinox_8c.html#aea0e1028baf14d16d9de800e36a17086">ira_equinox()</a></code> which may return the result for the wrong type of equinox (mean vs. true) if the <code>equinox</code> argument was changing from 1 to 0, and back to 1 again with the date being held the same. This affected NOVAS C 3.1 routines downstream also, such as <code><a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time()</a></code>.</li>
<li>Fixes NOVAS C 3.1 accuracy switching bug in <code><a class="el" href="cio_8c.html#a51bfbe9b491f50851326b2522dc2a29f">cio_basis()</a></code>, <code><a class="el" href="cio_8c.html#a65ffaaa2b527ed03149eadc7568f3714">cio_location()</a></code>, <code><a class="el" href="system_8c.html#a41ca0cfd79ad07c9e857ba02fa94928e">ecl2equ()</a></code>, <code><a class="el" href="system_8c.html#aa05ecc76c1ccc0c3445f8b642d6c5311">equ2ecl_vec()</a></code>, <code><a class="el" href="system_8c.html#a6fa1eada41005ac70290d0bb5df1ec26">ecl2equ_vec()</a></code>, <code><a class="el" href="earth_8c.html#ada5ca37110e66c8b65f623c9e26ae52e">geo_posvel()</a></code>, <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code>, and <code><a class="el" href="earth_8c.html#a6eacba14d3c382d67307856a2ea290e3">sidereal_time()</a></code>. All these functions returned a cached value for the other accuracy if the other input parameters are the same as a prior call, except the accuracy.</li>
<li>Fixes multiple NOVAS C 3.1 bugs related to using cached values in <code><a class="el" href="cio_8c.html#a51bfbe9b491f50851326b2522dc2a29f">cio_basis()</a></code> with alternating CIO location reference systems. This affected many CIRS-based position calculations downstream.</li>
<li>Fixes NOVAS C 3.1 bug in <code><a class="el" href="system_8c.html#aa05ecc76c1ccc0c3445f8b642d6c5311">equ2ecl_vec()</a></code> and <code><a class="el" href="system_8c.html#a6fa1eada41005ac70290d0bb5df1ec26">ecl2equ_vec()</a></code> whereby a query with <code>coord_sys = 2</code> (GCRS) has overwritten the cached mean obliquity value for <code>coord_sys = 0</code> (mean equinox of date). As a result, a subsequent call with <code>coord_sys = 0</code> and the same date as before would return the results GCRS coordinates instead of the requested mean equinox of date coordinates.</li>
<li>Some remainder calculations in NOVAS C 3.1 used the result from <code>fmod()</code> unchecked, which resulted in angles outside of the expected [0:2&pi;] range and was also the reason why <code><a class="el" href="calendar_8c.html#a044f1359abcf0a039ac6452a95729b5a">cal_date()</a></code> did not work for negative JD values.</li>
<li>Fixes NOVAS C 3.1 <code><a class="el" href="observer_8c.html#a033f1bf4b01e0e21a0e05e13c19c02f6">aberration()</a></code> returning NaN vectors if the <code>ve</code> argument is 0. It now returns the unmodified input vector appropriately instead.</li>
<li>Fixes unpopulated <code>az</code> output value in <code><a class="el" href="system_8c.html#ad932a8617973ef06e4a5c955b7897bb0">equ2hor()</a></code> at zenith in NOVAS C 3.1. While any azimuth is acceptable really, it results in unpredictable behavior. Hence, we set <code>az</code> to 0.0 for zenith to be consistent.</li>
<li>Fixes potential NOVAS C 3.1 string overflows and eliminates associated compiler warnings.</li>
<li>Fixes the NOVAS C 3.1 <a href="https://aa.usno.navy.mil/software/novas_faq">ephem_close bug</a>, whereby <code><a class="el" href="eph__manager_8c.html#a333da81ba7453316e26f32f628fefc0e">ephem_close()</a></code> in <code><a class="el" href="eph__manager_8c.html">eph_manager.c</a></code> did not reset the <code>EPHFILE</code> pointer to NULL.</li>
<li>Supports calculations in parallel threads by making cached results thread-local.</li>
</ul>
<h2><a class="anchor" id="autotoc_md42"></a>
Added</h2>
<ul>
<li>New debug mode and error traces. Simply call <code>novas_debug(NOVAS_DEBUG_ON)</code> or <code>novas_debug(NOVAS_DEBUG_EXTRA)</code> to enable. When enabled, any error conditions (such as NULL pointer arguments, or invalid input values etc.) will be reported to the standard error, complete with call tracing within the SuperNOVAS library, s.t. users can have a better idea of what exactly did not go to plan (and where). The debug messages can be disabled by passing <code>NOVAS_DEBUF_OFF</code> (0) as the argument to the same call.</li>
<li>Added Doxygen markup of source code and header.</li>
<li>Added Makefile for GNU make.</li>
<li>Added continuous integration on GitHub, including regression testing, static analysis, and doxygen validation.</li>
<li>Added an number of precompiler constants and enums in <code><a class="el" href="novas_8h.html">novas.h</a></code> to promote consistent usage and easier to read code.</li>
<li>New runtime configurability:<ul>
<li>The planet position calculator function used by <code><a class="el" href="place_8c.html#a713982e1f2bae0a72b39d03007f00d23">ephemeris()</a></code> can be set at runtime via <code><a class="el" href="plugin_8c.html#a9904c454bc7148b42d0f927b82ea3973">set_planet_provider()</a></code>, and <code><a class="el" href="plugin_8c.html#a418f45a11ce7f92ba0ef817558415640">set_planet_provider_hp()</a></code> (for high precision calculations). Similarly, if <code><a class="el" href="solsys-ephem_8c.html#a9d0f54c0ab00827768e61a353488b0ee">planet_ephem_provider()</a></code> or <code><a class="el" href="solsys-ephem_8c.html#a93d0f96d81f3c52e05163643bd23eb7d">planet_ephem_provider_hp()</a></code> (defined in <code><a class="el" href="solsys-ephem_8c.html">solsys-ephem.c</a></code>) are set as the planet calculator functions, then <code><a class="el" href="plugin_8c.html#a6097083c438a8d1872c2e00a66360030">set_ephem_provider()</a></code> can set the user-specified function to use with these to actually read ephemeris data (e.g. from a JPL ephemeris file).</li>
<li>If CIO locations vs GCRS are important to the user, the user may call <code><a class="el" href="cio_8c.html#ade20b8035266dfe5b082b12248f5affa">set_cio_locator_file()</a></code> at runtime to specify the location of the binary CIO interpolation table (e.g. <code>cio_ra.bin</code>) to use, even if the library was compiled with the different default CIO locator path.</li>
<li>The default low-precision nutation calculator <code><a class="el" href="nutation_8c.html#abd066c2857d1b1cc06d8bd51b912d841">nu2000k()</a></code> can be replaced by another suitable IAU 2006 nutation approximation via <code><a class="el" href="plugin_8c.html#a694288eb631d6a69ecf313b7b5b4a677">set_nutation_lp_provider()</a></code>. For example, the user may want to use the <code><a class="el" href="nutation_8c.html#a6f9cddeb8c3dd906b9b0b5941249ad0c">iau2000b()</a></code> model instead or some custom algorithm instead.</li>
</ul>
</li>
<li>New intutitive XYZ coordinate conversion functions:<ul>
<li>for GCRS - CIRS - ITRS (IAU 2000 standard): <code><a class="el" href="transform_8c.html#a51ea4a016336dd3cf7783061c14d165c">gcrs_to_cirs()</a></code>, <code><a class="el" href="transform_8c.html#aa2768d89d499a7155f90a6fd8c176d8d">cirs_to_itrs()</a></code>, and <code><a class="el" href="transform_8c.html#a12953f66c0f774284f0700ae785784d0">itrs_to_cirs()</a></code>, <code><a class="el" href="transform_8c.html#ac0ba048cd1732d0d0398397396d158bc">cirs_to_gcrs()</a></code>.</li>
<li>for GCRS - J2000 - TOD - ITRS (old methodology): <code><a class="el" href="transform_8c.html#aeea4b5085c7267714492fae6108fb975">gcrs_to_j2000()</a></code>, <code><a class="el" href="transform_8c.html#a02fa1ee652c20160055cbd2c7bd9ca63">j2000_to_tod()</a></code>, <code><a class="el" href="transform_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3">tod_to_itrs()</a></code>, and <code><a class="el" href="transform_8c.html#a3f6ae564cfac3766a21e0754905e5f7c">itrs_to_tod()</a></code>, <code><a class="el" href="transform_8c.html#a6205edb1361e56cc0c7aed0f088f7437">tod_to_j2000()</a></code>, <code><a class="el" href="transform_8c.html#a9d51ca5c972013024755c644c96d0586">j2000_to_gcrs()</a></code>.</li>
</ul>
</li>
<li>New <code><a class="el" href="system_8c.html#aef3c1f8e4c443e51e65003018449768a">itrs_to_hor()</a></code> and <code><a class="el" href="system_8c.html#a19f4f6c7d942dcba5ad2a4d2a60affad">hor_to_itrs()</a></code> functions to convert Earth-fixed ITRS coordinates to astrometric azimuth and elevation or back. Whereas <code><a class="el" href="transform_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3">tod_to_itrs()</a></code> followed by <code><a class="el" href="system_8c.html#aef3c1f8e4c443e51e65003018449768a">itrs_to_hor()</a></code> is effectively a just a more explicit 2-step version of the existing <code><a class="el" href="system_8c.html#ad932a8617973ef06e4a5c955b7897bb0">equ2hor()</a></code> for converting from TOD to to local horizontal (old methodology), the <code><a class="el" href="transform_8c.html#aa2768d89d499a7155f90a6fd8c176d8d">cirs_to_itrs()</a></code> followed by <code><a class="el" href="system_8c.html#aef3c1f8e4c443e51e65003018449768a">itrs_to_hor()</a></code> does the same from CIRS (new IAU standard methodology), and had no prior equivalent in NOVAS C 3.1.</li>
<li>New <code><a class="el" href="system_8c.html#a41ca0cfd79ad07c9e857ba02fa94928e">ecl2equ()</a></code> for converting ecliptic coordinates to equatorial, complementing existing <code><a class="el" href="system_8c.html#a035047336b16951b8b850066e74210a9">equ2ecl()</a></code>.</li>
<li>New <code><a class="el" href="system_8c.html#adcce501bd3f8f70974e7f55527162f83">gal2equ()</a></code> for converting galactic coordinates to ICRS equatorial, complementing existing <code><a class="el" href="system_8c.html#a288b49c03bc29704c8dd5acf8baca80e">equ2gal()</a></code>.</li>
<li>New <code><a class="el" href="refract_8c.html#afe1d4e96dd66676f5567a279e83e88d9">refract_astro()</a></code> complements the existing <code><a class="el" href="refract_8c.html#ac7ed2a1a5fb5aea3063d116d3d980eeb">refract()</a></code> but takes an unrefracted (astrometric) zenith angle as its argument.</li>
<li>New convenience functions to wrap <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code> for simpler specific use: <code><a class="el" href="place_8c.html#a1504058672e6e3cf24ce6b7189ede005">place_star()</a></code>, <code><a class="el" href="place_8c.html#ad465eafe65e3d701fc4bd57efa793a12">place_icrs()</a></code>, <code><a class="el" href="place_8c.html#aea583f6f785fa42f46710288e8a4e083">place_gcrs()</a></code>, <code><a class="el" href="place_8c.html#a49bd2b398f7eab3e98823cb1a7403ed5">place_cirs()</a></code>, and <code><a class="el" href="place_8c.html#ab6908b0eee06b4a44242fba1fd9d506c">place_tod()</a></code>.</li>
<li>New <code><a class="el" href="place_8c.html#a0f307c2a37d594a68e99c5c8af6d50c9">radec_star()</a></code> and <code><a class="el" href="place_8c.html#a918c8244e44c69f1589d9f4bf5355d16">radec_planet()</a></code> as the common point for existing functions such as <code><a class="el" href="place_8c.html#a9530c770e83db2cbc5a31d8d1f8c36f4">astro_star()</a></code> <code><a class="el" href="place_8c.html#acd56c41e811a002d6280b3b315730fbd">local_star()</a></code>, <code><a class="el" href="place_8c.html#a0dc172d82eec79f78c2d218c1a7b9cbe">virtual_planet()</a></code>, <code><a class="el" href="place_8c.html#aaf3d450c87f545acfa7ab7e2b6c229d9">topo_planet()</a></code> etc.</li>
<li>New time conversion utilities <code><a class="el" href="timescale_8c.html#a129acca41760da486e1179c93cb9e86d">tt2tdb()</a></code>, <code><a class="el" href="timescale_8c.html#ab7611704bab9ce717744a8b5575c5378">get_utc_to_tt()</a></code>, and <code><a class="el" href="timescale_8c.html#a4d7470ca705efa1953e8b4beab77c6b6">get_ut1_to_tt()</a></code> make it simpler to convert between UTC, UT1, TT, and TDB time scales, and to supply <code>ut1_to_tt</code> arguments to <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code> or topocentric calculations.</li>
<li>Co-existing <code><a class="el" href="solsys1_8c.html#a37c25dbc2683dc9e3b1d187e13f68330">solarsystem()</a></code> variants. It is possible to use the different <code><a class="el" href="solsys1_8c.html#a37c25dbc2683dc9e3b1d187e13f68330">solarsystem()</a></code> implementations provided by <code><a class="el" href="solsys1_8c.html">solsys1.c</a></code>, <code><a class="el" href="solsys2_8c.html">solsys2.c</a></code>, <code><a class="el" href="solsys3_8c.html">solsys3.c</a></code> and/or <code><a class="el" href="solsys-ephem_8c.html">solsys-ephem.c</a></code> side-by-side, as they define their functionalities with distinct, non-conflicting names, e.g. <code><a class="el" href="solsys3_8c.html#a580f5949c8a29cdd7bf4787aee891f2b">earth_sun_calc()</a></code> vs <code><a class="el" href="solsys2_8c.html#a1300b6559a08ef90ae9b9d8d33a22220">planet_jplint()</a></code> vs <code><a class="el" href="solsys1_8c.html#a841f04bf04e6dd8a5ae96f8ea729090d">planet_eph_manager()</a></code> vs <code><a class="el" href="solsys-ephem_8c.html#a9d0f54c0ab00827768e61a353488b0ee">planet_ephem_provider()</a></code>.</li>
<li>New <code><a class="el" href="target_8c.html#a8f832afe92680a11c3489aaa224ac2e2">novas_case_sensitive(int)</a></code> to enable (or disable) case-sensitive processing of object names. (By default NOVAS <code>object</code> names are converted to upper-case, making them effectively case-insensitive.)</li>
<li>New <code><a class="el" href="target_8c.html#a4c7846be95299769f4d0377bf127bcf5">make_planet()</a></code> and <code><a class="el" href="target_8c.html#aa22303f98df2d63edf6d8452ff3a43b2">make_ephem_object()</a></code> to make it simpler to configure Solar-system objects.</li>
</ul>
<h2><a class="anchor" id="autotoc_md43"></a>
Changed</h2>
<ul>
<li>Changed to support for calculations in parallel threads by making cached results thread-local (as opposed to the globally cached values in NOVAS C 3.1). This works using the C11 standard <code>_Thread_local</code> or else the earlier GNU C &gt;= 3.3 standard <code>__thread</code> modifier. You can also set the preferred thread-local keyword for your compiler by passing it via <code>-DTHREAD_LOCAL=...</code> in <code>config.mk</code> to ensure that your build is thread-safe. And, if your compiler has no support whatsoever for thread_local variables, then SuperNOVAS will not be thread-safe, just as NOVAS C isn't.</li>
<li>SuperNOVAS functions take <code>enum</code>s as their option arguments instead of the raw integers in NOVAS C 3.1. These enums are defined in <code><a class="el" href="novas_8h.html">novas.h</a></code>. The same header also defines a number of useful constants. The enums allow for some compiler checking, and make for more readable code that is easier to debug. They also make it easy to see what choices are available for each function argument, without having to consult the documentation each and every time.</li>
<li>All SuperNOVAS functions check for the basic validity of the supplied arguments (Such as NULL pointers or illegal duplicate arguments) and will return -1 (with <code>errno</code> set, usually to <code>EINVAL</code>) if the arguments supplied are invalid (unless the NOVAS C API already defined a different return value for specific cases. If so, the NOVAS C error code is returned for compatibility). There were no such checks performed in NOVAS C 3.1.</li>
<li>All erroneous returns now set <code>errno</code> so that users can track the source of the error in the standard C way and use functions such as <code>perror()</code> and <code>strerror()</code> to print human-readable error messages. (NOVAS C 3.1 did not set <code>errno</code>).</li>
<li>Many output values supplied via pointers are set to clearly invalid values in case of erroneous returns, such as <code>NAN</code> so that even if the caller forgets to check the error code, it becomes obvious that the values returned should not be used as if they were valid. (No more sneaky silent errors, which were common in NOVAS C 3.1.)</li>
<li>Many SuperNOVAS functions allow <code>NULL</code> arguments (unlike NOVAS C 3.1), both for optional input values as well as outputs that are not required (see the <a href="https://smithsonian.github.io/SuperNOVAS/apidoc/html/">API Documentation</a> for specifics). This eliminates the need to declare dummy variables in your application code for quantities you do not require.</li>
<li>All SuperNOVAS functions that take an input vector to produce an output vector allow the output vector argument be the same as the input vector argument (unlike in NOVAS C 3.1 where this was not consistently implented). For example, <code>frame_tie(pos, J2000_TO_ICRS, pos)</code> using the same <code>pos</code> vector both as the input and the output. In this case the <code>pos</code> vector is modified in place by the call. This can greatly simplify usage, and can eliminate extraneous declarations, when intermediates are not required.</li>
<li>SuperNOVAS declares function pointer arguments as <code>const</code> whenever the function does not modify the data content being referenced. This supports better programming practices that generally aim to avoid unintended data modifications. (The passing of <code>const</code> arguments to NOVAS C 3.1 calls would result in compiler warnings.)</li>
<li>Catalog names can be up to 6 bytes (including termination), up from 4 in NOVAS C 3.1, while keeping <code>struct</code> layouts the same as NOVAS C thanks to alignment, thus allowing cross-compatible binary exchange of <code><a class="el" href="structcat__entry.html">cat_entry</a></code> records with NOVAS C 3.1.</li>
<li>Object ID numbers are <code>long</code> instead of <code>short</code> (in NOVAS C 3.1) to accommodate NAIF IDs, which require minimum 32-bit integers.</li>
<li><code><a class="el" href="equinox_8c.html#a9178358732325399f3a5e3582080ced3">precession()</a></code> can now take arbitrary input and output epochs. Unlike NOVAS C 3.1, it is not required that either of those epochs be J2000.</li>
<li><code><a class="el" href="transform_8c.html#a6217852bfd7d3a58d3266d0daadfc6bc">cel2ter()</a></code> and <code><a class="el" href="transform_8c.html#ac8c5ff3cc13126aba2ec5a6cbe187a31">ter2cel()</a></code> can now process 'option'/'class' = 1 (<code>NOVAS_REFERENCE_CLASS</code>) regardless of the methodology (<code>EROT_ERA</code> or <code>EROT_GST</code>) used to input or output coordinates in GCRS (unlike in NOVAS C 3.1).</li>
<li>Changed <code><a class="el" href="target_8c.html#a411f70fb77582d750c5269fcd64b0ce2">make_object()</a></code> to retain the specified number argument (which can be different from the <code>starnumber</code> value in the supplied <code><a class="el" href="structcat__entry.html">cat_entry</a></code> structure), in contrast to NOVAS C 3.1, which set <code>object-&gt;number</code> to 0 for <code><a class="el" href="structcat__entry.html">cat_entry</a></code> arguments.</li>
<li><code><a class="el" href="cio_8c.html#a65ffaaa2b527ed03149eadc7568f3714">cio_location()</a></code> will always return a valid value as long as neither output pointer argument is NULL. (NOVAS C 3.1 would return an error if a CIO locator file was previously opened but cannot provide the data for whatever reason).</li>
<li><code><a class="el" href="solsys3_8c.html#a869ec4c9fe91668611c0cfcc6bf332cf">sun_eph()</a></code> in <code>solsysl3.c</code> evaluates the series in reverse order compared to NOVAS C 3.1, accumulating the least significant terms first, and thus resulting in higher precision result in the end.</li>
<li>Changed <code><a class="el" href="util_8c.html#a84f672dc1c37e3af374198f29cbcfba9">vector2radec()</a></code> to return NAN values if the input is a null-vector (i.e. all components are zero), as opposed to NOVAS C 3.1, which left the input vector argument unchanged.</li>
<li>IAU 2000A nutation model uses higher-order Delaunay arguments provided by <code><a class="el" href="equinox_8c.html#a312b5ab1a004b179d80463a07ca7da8f">fund_args()</a></code>, instead of the linear model in NOVAS C 3.1.</li>
<li>IAU 2000 nutation made a bit faster vs NOVAS C 3.1, via reducing the the number of floating-point multiplications necessary by skipping terms that do not contribute. Its coefficients are also packed more frugally in memory, resulting in a smaller footprint than in NOVAS C 3.1.</li>
<li>More efficient paging (cache management) for <code><a class="el" href="cio_8c.html#afc894b55420495a727a90d3d85188ef4">cio_array()</a></code> vs NOVAS C 3.1, including I/O error checking.</li>
<li>Changed the standard atmospheric model for (optical) refraction calculation to include a simple model for the annual average temperature at the site (based on latitude and elevation). This results is a slightly more educated guess of the actual refraction than the global fixed temperature of 10 &deg;C assumed by NOVAC C 3.1 regardless of observing location.</li>
</ul>
<h2><a class="anchor" id="autotoc_md44"></a>
Deprecated</h2>
<ul>
<li><code>novascon.h</code> / <code>novascon.c</code>: These definitions of constants in NOVAS C 3.1 was troublesome for two reasons: (1) They were primarily meant for use internally within the library itself. As the library clearly defines in what units input and output quantities are expressed, the user code can apply its own appropriate conversions that need not match the internal system used by the library. Hence exposing these constants to users was half baked. (2) The naming of constants was too simplistic (with names such as <code>C</code> or <code>F</code>) that it was rather prone to naming conflicts in user code. As a result, the constants have been moved to <code><a class="el" href="novas_8h.html">novas.h</a></code> with more unique names (such as <code>NOVAS_C</code> and <code>NOVAS_EARTH_FLATTENING</code>. New code should rely on these definitions instead of the troubled constants of <code>novascon.c</code> / <code>.h</code> if at all necessary.</li>
<li><code><a class="el" href="system_8c.html#ad932a8617973ef06e4a5c955b7897bb0">equ2hor()</a></code>: It's name does not make it clear that this function is suitable only for converting TOD (old methodology) to horizontal but not CIRS to horizontal (IAU 2000 standard). You should use the equivalent but more specific <code><a class="el" href="transform_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3">tod_to_itrs()</a></code> or the newly added <code><a class="el" href="transform_8c.html#aa2768d89d499a7155f90a6fd8c176d8d">cirs_to_itrs()</a></code>, followed by <code><a class="el" href="system_8c.html#aef3c1f8e4c443e51e65003018449768a">itrs_to_hor()</a></code> instead.</li>
<li><code><a class="el" href="transform_8c.html#a6217852bfd7d3a58d3266d0daadfc6bc">cel2ter()</a></code> / <code><a class="el" href="transform_8c.html#ac8c5ff3cc13126aba2ec5a6cbe187a31">ter2cel()</a></code>: These NOVAS C 3.1 function can be somewhat confusing to use. You are likely better off with <code><a class="el" href="transform_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3">tod_to_itrs()</a></code> and <code><a class="el" href="transform_8c.html#aa2768d89d499a7155f90a6fd8c176d8d">cirs_to_itrs()</a></code> instead, and possibly followed by further conversions if desired.</li>
<li><code><a class="el" href="place_8c.html#a906b17f06b42e31a29cafad4856f565f">app_star()</a></code>, <code><a class="el" href="place_8c.html#ac28dd9a362982cfce150751001a96a8a">app_planet()</a></code>, <code><a class="el" href="place_8c.html#a86e4f52e832879a33aefc28803e2690f">topo_star()</a></code> and <code><a class="el" href="place_8c.html#aaf3d450c87f545acfa7ab7e2b6c229d9">topo_planet()</a></code>: These NOVAS C 3.1 function use the old (pre IAU 2000) methodology, which isn't clear from their naming. Use <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code> or <code><a class="el" href="place_8c.html#a1504058672e6e3cf24ce6b7189ede005">place_star()</a></code> with <code>NOVAS_TOD</code> or <code>NOVAS_CIRS</code> as the system instead, as appropriate.</li>
<li><code><a class="el" href="solarsystem_8h.html#aa5f22db2fa785675372d45b88f2f1736">readeph()</a></code>: This NOVAS C 3.1 function is prone to memory leaks, and not flexible with its origin (necessarily at the barycenter). Instead, use a similar <code>novas_ephem_provider</code> implementation and <code><a class="el" href="plugin_8c.html#a6097083c438a8d1872c2e00a66360030">set_ephem_provider()</a></code> for a more flexible and less troublesome equivalent, which also does not need to be baked into the library and can be configured at runtime.</li>
<li><code><a class="el" href="timescale_8c.html#a90d5fae30728b51151c3daf355ca585b">tdb2tt()</a></code>. Use <code><a class="el" href="timescale_8c.html#a129acca41760da486e1179c93cb9e86d">tt2tdb()</a></code> instead. It's both more intuitive to use (returning the time difference as a double) and faster to calculate than the NOVAS C function, not to mention that it implements the more standard approach. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
