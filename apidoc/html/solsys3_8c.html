<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta charset="utf-8"/>
<meta name="description" content="SuperNOVAS C/C++ astrometry library"/>
<meta name="keywords" content="astronomy, astrometry, C, C++, library, NOVAS"/>
<meta name="author" content="Attila Kovacs"/>
<meta name="copyright" content="(C)2024 Attila Kovacs" />
<meta name="robots" content="index,follow"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HLFWKSM8V9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HLFWKSM8V9');
</script>
<link rel="shortcut icon" type="image/x-icon" href="/SuperNOVAS/resources/favicon.ico" />
<link rel="icon" type="image/png" sizes="192x192" href="/SuperNOVAS/resources/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="/SuperNOVAS/resources/android-chrome-512x512.png" />
<link rel="apple-touch-icon" type="image/png" href="/SuperNOVAS/resources/apple-touch-icon.png" />
<title>SuperNOVAS: src/solsys3.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.1</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('solsys3_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">solsys3.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab5d74f84f8e75e90dfc30ebde562d076" id="r_ab5d74f84f8e75e90dfc30ebde562d076"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="solsys3_8c.html#ab5d74f84f8e75e90dfc30ebde562d076">earth_sun_calc</a> (double jd_tdb, enum <a class="el" href="novas_8h.html#a219df36b21dc4476656e708d14d08045">novas_planet</a> body, enum <a class="el" href="novas_8h.html#a208120c5fa3e12853eb37cb99d3e27be">novas_origin</a> origin, double *position, double *velocity)</td></tr>
<tr class="separator:ab5d74f84f8e75e90dfc30ebde562d076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e6398e29968a48f9de090e82423750f" id="r_a3e6398e29968a48f9de090e82423750f"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="solsys3_8c.html#a3e6398e29968a48f9de090e82423750f">earth_sun_calc_hp</a> (const double jd_tdb[2], enum <a class="el" href="novas_8h.html#a219df36b21dc4476656e708d14d08045">novas_planet</a> body, enum <a class="el" href="novas_8h.html#a208120c5fa3e12853eb37cb99d3e27be">novas_origin</a> origin, double *position, double *velocity)</td></tr>
<tr class="separator:a3e6398e29968a48f9de090e82423750f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a279bca0519117cee9a3bd4382f38e7ad" id="r_a279bca0519117cee9a3bd4382f38e7ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="solsys3_8c.html#a279bca0519117cee9a3bd4382f38e7ad">enable_earth_sun_hp</a> (int value)</td></tr>
<tr class="separator:a279bca0519117cee9a3bd4382f38e7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e2d599b1dc7a0e87bfd29dbd6413398" id="r_a5e2d599b1dc7a0e87bfd29dbd6413398"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="solsys3_8c.html#a5e2d599b1dc7a0e87bfd29dbd6413398">solarsystem</a> (double jd_tdb, short body, short origin, double *position, double *velocity)</td></tr>
<tr class="separator:a5e2d599b1dc7a0e87bfd29dbd6413398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0243c2489c22860de898115aed8ffc87" id="r_a0243c2489c22860de898115aed8ffc87"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="solsys3_8c.html#a0243c2489c22860de898115aed8ffc87">solarsystem_hp</a> (const double jd_tdb[2], short body, short origin, double *position, double *velocity)</td></tr>
<tr class="separator:a0243c2489c22860de898115aed8ffc87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc71aa5ed911942370abde4cf9b7c2dc" id="r_adc71aa5ed911942370abde4cf9b7c2dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="solsys3_8c.html#adc71aa5ed911942370abde4cf9b7c2dc">sun_eph</a> (double jd, double *ra, double *dec, double *dis)</td></tr>
<tr class="separator:adc71aa5ed911942370abde4cf9b7c2dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>G. Kaplan and A. Kovacs</dd></dl>
<p>SuperNOVAS plane calculator functions for the Earth and Sun only, with an orbital model based on the DE405 ephemerides by JPL.</p>
<p>Based on the NOVAS C Edition, Version 3.1:</p>
<p>U. S. Naval Observatory<br  />
 Astronomical Applications Dept.<br  />
 Washington, DC<br  />
 <a href="http://www.usno.navy.mil/USNO/astronomical-applications">http://www.usno.navy.mil/USNO/astronomical-applications</a></p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="solsys-ephem_8c.html">solsys-ephem.c</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab5d74f84f8e75e90dfc30ebde562d076" name="ab5d74f84f8e75e90dfc30ebde562d076"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5d74f84f8e75e90dfc30ebde562d076">&#9670;&#160;</a></span>earth_sun_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short earth_sun_calc </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd_tdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a219df36b21dc4476656e708d14d08045">novas_planet</a>&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a208120c5fa3e12853eb37cb99d3e27be">novas_origin</a>&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>velocity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provides the position and velocity of the Earth and Sun only at epoch 'jd_tdb' by evaluating a closed-form theory without reference to an external file. This function can also provide the position and velocity of the Sun.</p>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. H. "NOVAS: Naval Observatory Vector Astrometry
    Subroutines"; USNO internal document dated 20 Oct 1988; revised 15 Mar 1990. </li>
<li>
Explanatory Supplement to The Astronomical Almanac (1992). </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">body</td><td>NOVAS_EARTH (3) or NOVAS_SUN (10) only. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">origin</td><td>NOVAS_BARYCENTER (0) or NOVAS_HELIOCENTER (1) relative to which to return positions and velocities. (For compatibility with existing NOVAS C compatible user implementations, we keep the original NOVAS C argument type here). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">position</td><td>[AU] Position vector of 'body' at 'tjd'; equatorial rectangular coordinates in AU referred to the mean equator and equinox of J2000.0. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">velocity</td><td>[AU/day] Velocity vector of 'body' at 'tjd'; equatorial rectangular system referred to the mean equator and equinox of J2000.0, in AU/Day. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if there is a required function is not provided (errno set to ENOSYS) or if one of the output pointer arguments is NULL (errno set to EINVAL). 1 if the input Julian date ('tjd') is out of range, 2 if 'body' is invalid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="solsys3_8c.html#a3e6398e29968a48f9de090e82423750f">earth_sun_calc_hp()</a> </dd>
<dd>
<a class="el" href="novas_8c.html#a9904c454bc7148b42d0f927b82ea3973">set_planet_provider()</a> </dd>
<dd>
<a class="el" href="solsys3_8c.html#a5e2d599b1dc7a0e87bfd29dbd6413398">solarsystem()</a> </dd>
<dd>
<a class="el" href="solarsystem_8h.html#ae7eb9e64aa00ee757946488fa99351ec">novas_planet_provider</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a208120c5fa3e12853eb37cb99d3e27beade504a1c5ccf790ce9d8ad52797bb94c">NOVAS_BARYCENTER</a>, <a class="el" href="novas_8h.html#a219df36b21dc4476656e708d14d08045adc941f5a3613952d6d6102281e70e5c0">NOVAS_EARTH</a>, <a class="el" href="novas_8h.html#a1853540eae9f8699b6aaff9c0b518e08">NOVAS_PLANETS</a>, <a class="el" href="novas_8h.html#a219df36b21dc4476656e708d14d08045aaeb39686d0e998c9188b47c31ee9c6b5">NOVAS_SSB</a>, <a class="el" href="novas_8h.html#a219df36b21dc4476656e708d14d08045a170e1c704bd29c8d46f66d4d9a03d9c2">NOVAS_SUN</a>, <a class="el" href="novas_8c.html#a9178358732325399f3a5e3582080ced3">precession()</a>, <a class="el" href="novas_8c.html#acf86ce700b3d3509ebba13e5f16a4327">radec2vector()</a>, <a class="el" href="solsys3_8c.html#adc71aa5ed911942370abde4cf9b7c2dc">sun_eph()</a>, <a class="el" href="novascon_8c.html#a179a958e126d46c9b952672120986924">T0</a>, and <a class="el" href="novas_8h.html#a4912c64aec0c943b7985db6cb61ff83a">TWOPI</a>.</p>

</div>
</div>
<a id="a3e6398e29968a48f9de090e82423750f" name="a3e6398e29968a48f9de090e82423750f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e6398e29968a48f9de090e82423750f">&#9670;&#160;</a></span>earth_sun_calc_hp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short earth_sun_calc_hp </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>jd_tdb</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a219df36b21dc4476656e708d14d08045">novas_planet</a>&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a208120c5fa3e12853eb37cb99d3e27be">novas_origin</a>&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>velocity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It may provide the position and velocity of the Earth and Sun, the same as solarsystem_earth_sun(), if <a class="el" href="solsys3_8c.html#a279bca0519117cee9a3bd4382f38e7ad">enable_earth_sun_hp()</a> is set to true (non-zero). Otherwise, it will return with an error code of 3, indicating that high-precision calculations are not provided by this implementation.</p>
<p>NOTES: </p><ol>
<li>
This implementation will always propulate the output position and velocity vectors with the low-precision result, regardless of the return error code, in order to reduce the chance of unpredictable behavior, even if the user does not check the returned error status (which of course they should).  </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">body</td><td>NOVAS_EARTH (3) or NOVAS_SUN (10) only. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">origin</td><td>NOVAS_BARYCENTER (0) or NOVAS_HELIOCENTER (1) relative to which to return positions and velocities. (For compatibility with existing NOVAS C compatible user implementations, we keep the original NOVAS C argument type here). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">position</td><td>[AU] Position vector of 'body' at 'tjd'; equatorial rectangular coordinates in AU referred to the mean equator and equinox of J2000.0. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">velocity</td><td>[AU/day] Velocity vector of 'body' at 'tjd'; equatorial rectangular system referred to the mean equator and equinox of J2000.0, in AU/Day. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if there is a required function is not provided (errno set to ENOSYS), or if one of the output pointer arguments is NULL (errno set to EINVAL). 1 if the input Julian date ('tjd') is out of range, 2 if 'body' is invalid, or 3 if the high-precision orbital data cannot be produced (default return value).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="solsys3_8c.html#a279bca0519117cee9a3bd4382f38e7ad">enable_earth_sun_hp()</a> </dd>
<dd>
<a class="el" href="solsys3_8c.html#ab5d74f84f8e75e90dfc30ebde562d076">earth_sun_calc()</a> </dd>
<dd>
<a class="el" href="novas_8c.html#a9904c454bc7148b42d0f927b82ea3973">set_planet_provider()</a> </dd>
<dd>
<a class="el" href="solsys3_8c.html#a0243c2489c22860de898115aed8ffc87">solarsystem_hp()</a> </dd>
<dd>
<a class="el" href="solarsystem_8h.html#a85ed597fa94ecf72653e64f4afa7f833">novas_planet_provider_hp</a> </dd></dl>

<p class="reference">References <a class="el" href="solsys3_8c.html#ab5d74f84f8e75e90dfc30ebde562d076">earth_sun_calc()</a>.</p>

</div>
</div>
<a id="a279bca0519117cee9a3bd4382f38e7ad" name="a279bca0519117cee9a3bd4382f38e7ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a279bca0519117cee9a3bd4382f38e7ad">&#9670;&#160;</a></span>enable_earth_sun_hp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enable_earth_sun_hp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Specify whether the high-precision call is allowed to return a low-precision result. If set to 0 (false) solarsystem_earth_sun_hp() will return with an error code 3 indicating that a high-precision calculation is not possible. Otherise, a non-zero value (true) will let the function to be used without errors, returning the low-precison result of solarsystem_earth_sun() instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>(boolean) A non-zero value enables the error-free use of the <a class="el" href="solsys3_8c.html#a3e6398e29968a48f9de090e82423750f">earth_sun_calc_hp()</a> by allowing to return the low-precision result. Otherwise, <a class="el" href="solsys3_8c.html#a3e6398e29968a48f9de090e82423750f">earth_sun_calc_hp()</a> will return an error code 3 indicating that the high-precision result is not available (this latter is the default behavior).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="solsys3_8c.html#a3e6398e29968a48f9de090e82423750f">earth_sun_calc_hp()</a> </dd></dl>

</div>
</div>
<a id="a5e2d599b1dc7a0e87bfd29dbd6413398" name="a5e2d599b1dc7a0e87bfd29dbd6413398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e2d599b1dc7a0e87bfd29dbd6413398">&#9670;&#160;</a></span>solarsystem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short solarsystem </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd_tdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>velocity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A default implementation for regular (reduced) precision handling of major planets, Sun, Moon and the Solar-system barycenter. See DEFAULT_SOLSYS in Makefile to choose the implementation that is built into with the library as a default. Applications can define their own preferred implementations at runtime via <a class="el" href="solarsystem_8h.html#a9904c454bc7148b42d0f927b82ea3973">set_planet_provider()</a>.</p>
<p>Since this is a function that may be provided by existing custom user implementations, we keep the original argument types for compatibility, hence 'short' instead of the more informative enums).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">body</td><td>Major planet number (or that for the Sun, Moon, or Solar-system Barycenter position), as defined by enum novas_planet, e.g. NOVAS_MARS (4), NOVAS_SUN (10) or NOVAS_SSB (0). (For compatibility with existing NOVAS C compatible user implementations, we keep the original NOVAS C argument type here). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">origin</td><td>NOVAS_BARYCENTER (0) or NOVAS_HELIOCENTER (1) relative to which to return positions and velocities. (For compatibility with existing NOVAS C compatible user implementations, we keep the original NOVAS C argument type here). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">position</td><td>[AU] Position vector of 'body' at 'tjd'; equatorial rectangular coordinates in AU referred to the mean equator and equinox of J2000.0. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">velocity</td><td>[AU/day] Velocity vector of 'body' at 'tjd'; equatorial rectangular system referred to the mean equator and equinox of J2000.0, in AU/Day. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if there is a required function is not provided (errno set to ENOSYS), 1 if the input Julian date ('tjd') is out of range, 2 if 'body' is invalid, or 3 if the ephemeris data cannot be produced for other reasons.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="novas_8h.html#a219df36b21dc4476656e708d14d08045">novas_planet</a> </dd>
<dd>
<a class="el" href="solarsystem_8h.html#a0243c2489c22860de898115aed8ffc87">solarsystem_hp()</a> </dd>
<dd>
<a class="el" href="solarsystem_8h.html#a9904c454bc7148b42d0f927b82ea3973">set_planet_provider()</a> </dd>
<dd>
<a class="el" href="novas_8c.html#a263de1618d80fcc737984951fa97c5a3">place()</a> </dd>
<dd>
<a class="el" href="novas_8c.html#a3221fff69d0ca52ae4694ec3ab0368ad">ephemeris()</a> </dd></dl>

<p class="reference">References <a class="el" href="solsys3_8c.html#ab5d74f84f8e75e90dfc30ebde562d076">earth_sun_calc()</a>.</p>

</div>
</div>
<a id="a0243c2489c22860de898115aed8ffc87" name="a0243c2489c22860de898115aed8ffc87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0243c2489c22860de898115aed8ffc87">&#9670;&#160;</a></span>solarsystem_hp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short solarsystem_hp </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>jd_tdb</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>velocity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A default implementation for high precision handling of major planets, Sun, Moon and the Solar-system barycenter. See DEFAULT_SOLSYS in Makefile to choose the implementation that is built into the library as a default. Applications can define their own preferred implementations at runtime via <a class="el" href="solarsystem_8h.html#a418f45a11ce7f92ba0ef817558415640">set_planet_provider_hp()</a>.</p>
<p>Since this is a function that may be provided by existing custom user implementations, we keep the original argument types for compatibility, hence 'short' instead of the more informative enums).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian date, broken into high and low order components, respectively. Typically, as the integer and fractional parts for the highest precision. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">body</td><td>Major planet number (or that for the Sun, Moon, or Solar-system Barycenter position), as defined by enum novas_planet, e.g. NOVAS_MARS (4), NOVAS_SUN (10) or NOVAS_SSB (0). (For compatibility with existing NOVAS C compatible user implementations, we keep the original NOVAS C argument type here). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">origin</td><td>NOVAS_BARYCENTER (0) or NOVAS_HELIOCENTER (1) relative to which to return positions and velocities. (For compatibility with existing NOVAS C compatible user implementations, we keep the original NOVAS C argument type here). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">position</td><td>[AU] Position vector of 'body' at 'tjd'; equatorial rectangular coordinates in AU referred to the mean equator and equinox of J2000.0. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">velocity</td><td>[AU/day] Velocity vector of 'body' at 'tjd'; equatorial rectangular system referred to the mean equator and equinox of J2000.0, in AU/Day. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if there is a required function is not provided (errno set to ENOSYS), or some other error code (NOVAS C was not very consistent here...)</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="solarsystem_8h.html#a5e2d599b1dc7a0e87bfd29dbd6413398">solarsystem()</a> </dd>
<dd>
<a class="el" href="solarsystem_8h.html#a418f45a11ce7f92ba0ef817558415640">set_planet_provider_hp()</a> </dd>
<dd>
<a class="el" href="novas_8c.html#a263de1618d80fcc737984951fa97c5a3">place()</a> </dd>
<dd>
<a class="el" href="novas_8c.html#a3221fff69d0ca52ae4694ec3ab0368ad">ephemeris()</a> </dd></dl>

<p class="reference">References <a class="el" href="solsys3_8c.html#a3e6398e29968a48f9de090e82423750f">earth_sun_calc_hp()</a>.</p>

</div>
</div>
<a id="adc71aa5ed911942370abde4cf9b7c2dc" name="adc71aa5ed911942370abde4cf9b7c2dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc71aa5ed911942370abde4cf9b7c2dc">&#9670;&#160;</a></span>sun_eph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sun_eph </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes equatorial spherical coordinates of Sun referred to the mean equator and equinox of date.</p>
<p>Quoted accuracy is 2.0 + 0.03 * T<sup>2</sup> arcsec, where T is measured in units of 1000 years from J2000.0. See reference.</p>
<p>The obliquity equation is updated to equation 5.12 of the second reference.</p>
<p>The linear fit to DE405 primarily corrects for the difference between "old" (Lieske) and "new" (IAU 2006) precession. The difference, new - old, is -0.3004 arcsec/cy.</p>
<p>REFERENCES: </p><ol>
<li>
Bretagnon, P. and Simon, J.L. (1986). Planetary Programs and Tables from -4000 to + 2800. (Richmond, VA: Willmann-Bell). </li>
<li>
Kaplan, G.H. (2005). US Naval Observatory Circular 179. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd</td><td>[day] jd (double) Julian date on TDT or ET time scale. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ra</td><td>[h] Right ascension referred to mean equator and equinox of date (hours). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dec</td><td>[deg] Declination referred to mean equator and equinox of date (degrees). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dis</td><td>[AU] Geocentric distance (AU). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if any of the pointer arguments are NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="solsys3_8c.html#ab5d74f84f8e75e90dfc30ebde562d076">earth_sun_calc()</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a8a0ef80e44076b86bc707e9414d85d76">ASEC2RAD</a>, <a class="el" href="novas_8h.html#ac5a945020d3528355cda82d383676736">RAD2DEG</a>, <a class="el" href="novascon_8c.html#a179a958e126d46c9b952672120986924">T0</a>, and <a class="el" href="novas_8h.html#a4912c64aec0c943b7985db6cb61ff83a">TWOPI</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="solsys3_8c.html">solsys3.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
