<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuperNOVAS: SuperNOVAS vs. astropy</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_SuperNOVAS__vs__astropy.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">SuperNOVAS vs. astropy</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md111"></a></p>
<p>Nowadays <b>astropy</b> is widely used in the astronomy community and it is known for its simplicity and elegance, but it is rather slow (<a href="https://github.com/Smithsonian/SuperNOVAS#benchmarks">putting it mildly</a>). In contrast, C is known to be fast, but it also has a bad reputation for being tedious and 'ugly'. However, below is a side-by-side comparison of equivalent program snippets for calculating CIRS apparent positions in <b>astropy</b> vs. <b>SuperNOVAS</b> for Antares for a given date and observer location:</p>
<table class="doxtable">
<tr>
<th><b>astropy</b> </th><th><b>SuperNOVAS</b>  </th></tr>
<tr>
<td><p class="starttd"></p>
<div class="fragment"><div class="line"><span class="keyword">from</span> astropy <span class="keyword">import</span> units <span class="keyword">as</span> u</div>
<div class="line"><span class="keyword">from</span> astropy.coordinates <span class="keyword">import</span> SkyCoord,</div>
<div class="line">   EarthLocation, Longitude, Latitude,</div>
<div class="line">   CIRS</div>
<div class="line">   </div>
<div class="line">   </div>
<div class="line">   </div>
<div class="line">   </div>
<div class="line">   </div>
<div class="line"><span class="comment"># Define ICRS coordinates</span></div>
<div class="line">source = SkyCoord(</div>
<div class="line">  <span class="stringliteral">&#39;16h 29m 24.45970s&#39;</span>, </div>
<div class="line">  <span class="stringliteral">&#39;−26d 25m 55.2094s&#39;</span>,</div>
<div class="line">  d = u.AU / 5.89 * u.mas,</div>
<div class="line">  pmra = -12.11 * u.mas / u.yr,</div>
<div class="line">  pmdec = -23.30 * u.mas / u.yr,</div>
<div class="line">  rv = -3.4 * u.km / u.s)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Observer location</span></div>
<div class="line">loc = EarthLocation.from_geodetic(</div>
<div class="line">  Longitude(50.7374), </div>
<div class="line">  Latitude(7.0982), </div>
<div class="line">  height=60.0)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Set time of observation</span></div>
<div class="line">time = astropy.time.Time(</div>
<div class="line">  <span class="stringliteral">&quot;2025-02-27T19:57:00.728+0200&quot;</span></div>
<div class="line">  scale=<span class="stringliteral">&#39;tai&#39;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Observer frame &amp; system</span></div>
<div class="line">frame = CIRS(obstime=time, location=loc)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># apparent coordinates</span></div>
<div class="line">apparent = source.transform_to(frame);</div>
</div><!-- fragment --><p class="endtd"></p>
</td><td><p class="starttd"></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="novas_8h.html">novas.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="structcat__entry.html">cat_entry</a> star;</div>
<div class="line"><span class="keywordtype">object</span> source;</div>
<div class="line"><a class="code hl_struct" href="structobserver.html">observer</a> loc;</div>
<div class="line"><a class="code hl_struct" href="structnovas__timespec.html">novas_timespec</a> time;</div>
<div class="line"><a class="code hl_struct" href="structnovas__frame.html">novas_frame</a> frame;</div>
<div class="line"><a class="code hl_struct" href="structsky__pos.html">sky_pos</a> apparent;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Define ICRS coordinates</span></div>
<div class="line"><a class="code hl_function" href="target_8c.html#aa040bcfe8bee7d8e1307800f48efddd7">make_cat_entry</a>(<span class="stringliteral">&quot;Antares&quot;</span>, <span class="stringliteral">&quot;HIP&quot;</span>, 80763, </div>
<div class="line">  <a class="code hl_function" href="parse_8c.html#a696e44a2d1c788f9f335611efd7ed958">novas_hms_hours</a>(<span class="stringliteral">&quot;16h 29m 24.45970s&quot;</span>), </div>
<div class="line">  <a class="code hl_function" href="parse_8c.html#aca89d2a0f49afad45dbddffc09c3adae">novas_dms_degrees</a>(<span class="stringliteral">&quot;−26d 25m 55.2094s&quot;</span>),</div>
<div class="line">  -12.11, -23.30, 5.89, -3.4, &amp;star);</div>
<div class="line">  </div>
<div class="line"><a class="code hl_function" href="target_8c.html#ab9b7a622486f2904615ceed1ba94cd8f">make_cat_object</a>(&amp;star, &amp;source);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Observer location</span></div>
<div class="line"><a class="code hl_function" href="observer_8c.html#aa2f9fc986f99c1ec7092330dbf233fef">make_gps_observer</a>(50.7374, 7.0982, 60.0,</div>
<div class="line">  &amp;loc);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set time of observation</span></div>
<div class="line"><a class="code hl_function" href="timescale_8c.html#a4b5b82161f8eb474aaa650815b7ca66f">novas_set_str_time</a>(<a class="code hl_enumvalue" href="novas_8h.html#aa642c4ccc7195dc62fd0dc56567ebd0ba328f2523f4f064c5252f4ac858bddc4b">NOVAS_TAI</a>,</div>
<div class="line">  <span class="stringliteral">&quot;2025-02-27T19:57:00.728+0200&quot;</span>, </div>
<div class="line">  LEAP_SECONDS, DUT1, &amp;time);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Observer frame</span></div>
<div class="line"><a class="code hl_function" href="frames_8c.html#adc72577f99a7b076b23e0e44ddbca838">novas_make_frame</a>(<a class="code hl_enumvalue" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, </div>
<div class="line">  &amp;loc, &amp;time, DX, DY, &amp;frame);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// apparent coordinates in system</span></div>
<div class="line"><a class="code hl_function" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f">novas_sky_pos</a>(&amp;source, &amp;frame, <a class="code hl_enumvalue" href="novas_8h.html#a7ba038ea34eb901ccfb8f785708c651eacbee2de517939c156e61fb5f9631e044">NOVAS_CIRS</a>, </div>
<div class="line">  &amp;apparent);</div>
<div class="ttc" id="aframes_8c_html_ac365a1e015ae1f875dc5a66fd5435b2f"><div class="ttname"><a href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f">novas_sky_pos</a></div><div class="ttdeci">int novas_sky_pos(const object *restrict object, const novas_frame *restrict frame, enum novas_reference_system sys, sky_pos *restrict out)</div><div class="ttdoc">Calculates an apparent location on sky for the source.</div><div class="ttdef"><b>Definition</b> frames.c:821</div></div>
<div class="ttc" id="aframes_8c_html_adc72577f99a7b076b23e0e44ddbca838"><div class="ttname"><a href="frames_8c.html#adc72577f99a7b076b23e0e44ddbca838">novas_make_frame</a></div><div class="ttdeci">int novas_make_frame(enum novas_accuracy accuracy, const observer *obs, const novas_timespec *time, double xp, double yp, novas_frame *frame)</div><div class="ttdoc">Sets up a observing frame for a specific observer location, time of observation, and accuracy require...</div><div class="ttdef"><b>Definition</b> frames.c:515</div></div>
<div class="ttc" id="anovas_8h_html"><div class="ttname"><a href="novas_8h.html">novas.h</a></div><div class="ttdoc">SuperNOVAS types, definitions, and function prototypes.</div></div>
<div class="ttc" id="anovas_8h_html_a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660"><div class="ttname"><a href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a></div><div class="ttdeci">@ NOVAS_FULL_ACCURACY</div><div class="ttdoc">Use full precision calculations to micro-arcsecond accuracy.</div><div class="ttdef"><b>Definition</b> novas.h:625</div></div>
<div class="ttc" id="anovas_8h_html_a7ba038ea34eb901ccfb8f785708c651eacbee2de517939c156e61fb5f9631e044"><div class="ttname"><a href="novas_8h.html#a7ba038ea34eb901ccfb8f785708c651eacbee2de517939c156e61fb5f9631e044">NOVAS_CIRS</a></div><div class="ttdeci">@ NOVAS_CIRS</div><div class="ttdoc">Celestial Intermediate Reference System: dynamical system of the true equator, with its origin at the...</div><div class="ttdef"><b>Definition</b> novas.h:539</div></div>
<div class="ttc" id="anovas_8h_html_aa642c4ccc7195dc62fd0dc56567ebd0ba328f2523f4f064c5252f4ac858bddc4b"><div class="ttname"><a href="novas_8h.html#aa642c4ccc7195dc62fd0dc56567ebd0ba328f2523f4f064c5252f4ac858bddc4b">NOVAS_TAI</a></div><div class="ttdeci">@ NOVAS_TAI</div><div class="ttdoc">Innternational Atomic Time (TAI)</div><div class="ttdef"><b>Definition</b> novas.h:1343</div></div>
<div class="ttc" id="aobserver_8c_html_aa2f9fc986f99c1ec7092330dbf233fef"><div class="ttname"><a href="observer_8c.html#aa2f9fc986f99c1ec7092330dbf233fef">make_gps_observer</a></div><div class="ttdeci">int make_gps_observer(double latitude, double longitude, double height, observer *obs)</div><div class="ttdoc">Initializes an observer data structure for a ground-based observer with the specified GPS / WGS84 loc...</div><div class="ttdef"><b>Definition</b> observer.c:277</div></div>
<div class="ttc" id="aparse_8c_html_a696e44a2d1c788f9f335611efd7ed958"><div class="ttname"><a href="parse_8c.html#a696e44a2d1c788f9f335611efd7ed958">novas_hms_hours</a></div><div class="ttdeci">double novas_hms_hours(const char *restrict hms)</div><div class="ttdoc">Returns the decimal hours for a HMS string specification.</div><div class="ttdef"><b>Definition</b> parse.c:232</div></div>
<div class="ttc" id="aparse_8c_html_aca89d2a0f49afad45dbddffc09c3adae"><div class="ttname"><a href="parse_8c.html#aca89d2a0f49afad45dbddffc09c3adae">novas_dms_degrees</a></div><div class="ttdeci">double novas_dms_degrees(const char *restrict dms)</div><div class="ttdoc">Returns the decimal degrees for a DMS string specification.</div><div class="ttdef"><b>Definition</b> parse.c:442</div></div>
<div class="ttc" id="astructcat__entry_html"><div class="ttname"><a href="structcat__entry.html">cat_entry</a></div><div class="ttdoc">Basic astrometric data for any sidereal object located outside the solar system.</div><div class="ttdef"><b>Definition</b> novas.h:932</div></div>
<div class="ttc" id="astructnovas__frame_html"><div class="ttname"><a href="structnovas__frame.html">novas_frame</a></div><div class="ttdoc">A set of parameters that uniquely define the place and time of observation.</div><div class="ttdef"><b>Definition</b> novas.h:1453</div></div>
<div class="ttc" id="astructnovas__timespec_html"><div class="ttname"><a href="structnovas__timespec.html">novas_timespec</a></div><div class="ttdoc">A structure, which defines a precise instant of time that can be extpressed in any of the astronomica...</div><div class="ttdef"><b>Definition</b> novas.h:1367</div></div>
<div class="ttc" id="astructobserver_html"><div class="ttname"><a href="structobserver.html">observer</a></div><div class="ttdoc">Observer location.</div><div class="ttdef"><b>Definition</b> novas.h:1266</div></div>
<div class="ttc" id="astructsky__pos_html"><div class="ttname"><a href="structsky__pos.html">sky_pos</a></div><div class="ttdoc">Celestial object&#39;s place on the sky; contains the output from place()</div><div class="ttdef"><b>Definition</b> novas.h:1294</div></div>
<div class="ttc" id="atarget_8c_html_aa040bcfe8bee7d8e1307800f48efddd7"><div class="ttname"><a href="target_8c.html#aa040bcfe8bee7d8e1307800f48efddd7">make_cat_entry</a></div><div class="ttdeci">short make_cat_entry(const char *restrict name, const char *restrict catalog, long cat_num, double ra, double dec, double pm_ra, double pm_dec, double parallax, double rad_vel, cat_entry *source)</div><div class="ttdoc">Fully populates the data structure for a catalog source, such as a star, with all parameters provided...</div><div class="ttdef"><b>Definition</b> target.c:326</div></div>
<div class="ttc" id="atarget_8c_html_ab9b7a622486f2904615ceed1ba94cd8f"><div class="ttname"><a href="target_8c.html#ab9b7a622486f2904615ceed1ba94cd8f">make_cat_object</a></div><div class="ttdeci">int make_cat_object(const cat_entry *star, object *source)</div><div class="ttdoc">Populates and object data structure with the data for a catalog source.</div><div class="ttdef"><b>Definition</b> target.c:482</div></div>
<div class="ttc" id="atimescale_8c_html_a4b5b82161f8eb474aaa650815b7ca66f"><div class="ttname"><a href="timescale_8c.html#a4b5b82161f8eb474aaa650815b7ca66f">novas_set_str_time</a></div><div class="ttdeci">int novas_set_str_time(enum novas_timescale timescale, const char *restrict str, int leap, double dut1, novas_timespec *restrict time)</div><div class="ttdoc">Sets astronomical time in a specific timescale using a string specification.</div><div class="ttdef"><b>Definition</b> timescale.c:495</div></div>
</div><!-- fragment --><p class="endtd"></p>
</td></tr>
</table>
<p>Yes, <b>SuperNOVAS</b> is a bit more verbose, but not painfully so. OK, it's cheating a little bit, but only to make a point. If you look closer, you'll see that some details have been glazed over. For example, <b>astropy</b> will automatically fetch IERS data (leap seconds, and Earth-orientation parameters), whereas in <b>SuperNOVAS</b> you will have to set these explicitly (hence the placeholder <code>LEAP_SECONDS</code>, <code>DUT1</code>, <code>DX</code> and <code>DY</code> constants in the C snippet above). And, of course, the above comparison ignores error checking also. In Python, you can simply surround the above code in a <code>try</code> block, and then catch errors using <code>except</code>. In C, there is no catch-all solution like that. Instead, you will have to check the return values for each line, and decide if you need to bail early, e.g.:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span>(<a class="code hl_function" href="target_8c.html#ab9b7a622486f2904615ceed1ba94cd8f">make_cat_object</a>(&amp;star, &amp;source) != 0) {</div>
<div class="line">  <span class="comment">// oops, the above failed, bail if we must...</span></div>
<div class="line">  <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Regardless of the slight omissions, the difference is not night and day. If you can handle <b>astropy</b>, chances are you can handle <b>SuperNOVAS</b> too. And the reward for dealing with slightly 'uglier' code, is orders of magnitude gain in the speed of execution. It is a trade-off that worth considering, at the least.</p>
<hr  />
<p> Copyright (C) 2025 Attila Kovács </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
