<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuperNOVAS: /github/workspace/src/earth.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('earth_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">earth.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aef1f8daaad470353648de90576aefc66" id="r_aef1f8daaad470353648de90576aefc66"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef1f8daaad470353648de90576aefc66">era</a> (double jd_ut1_high, double jd_ut1_low)</td></tr>
<tr class="separator:aef1f8daaad470353648de90576aefc66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5ca37110e66c8b65f623c9e26ae52e" id="r_ada5ca37110e66c8b65f623c9e26ae52e"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ada5ca37110e66c8b65f623c9e26ae52e">geo_posvel</a> (double jd_tt, double ut1_to_tt, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const <a class="el" href="structobserver.html">observer</a> *restrict obs, double *restrict pos, double *restrict vel)</td></tr>
<tr class="separator:ada5ca37110e66c8b65f623c9e26ae52e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a022957936bc7c5a3e9651776689c9380" id="r_a022957936bc7c5a3e9651776689c9380"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a022957936bc7c5a3e9651776689c9380">limb_angle</a> (const double *pos_src, const double *pos_obs, double *restrict limb_ang, double *restrict nadir_ang)</td></tr>
<tr class="separator:a022957936bc7c5a3e9651776689c9380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fe699281044873f4137344b28884cea" id="r_a3fe699281044873f4137344b28884cea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3fe699281044873f4137344b28884cea">novas_diurnal_eop</a> (double gmst, const <a class="el" href="structnovas__delaunay__args.html">novas_delaunay_args</a> *restrict delaunay, double *restrict dxp, double *restrict dyp, double *restrict dut1)</td></tr>
<tr class="separator:a3fe699281044873f4137344b28884cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087d587e90b4e2138c0dba12d727696e" id="r_a087d587e90b4e2138c0dba12d727696e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a087d587e90b4e2138c0dba12d727696e">novas_diurnal_eop_at_time</a> (const <a class="el" href="structnovas__timespec.html">novas_timespec</a> *restrict time, double *restrict dxp, double *restrict dyp, double *restrict dut1)</td></tr>
<tr class="separator:a087d587e90b4e2138c0dba12d727696e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ab448b9d09b5656cf74fe10ab855fd4" id="r_a9ab448b9d09b5656cf74fe10ab855fd4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ab448b9d09b5656cf74fe10ab855fd4">novas_diurnal_libration</a> (double gmst, const <a class="el" href="structnovas__delaunay__args.html">novas_delaunay_args</a> *restrict delaunay, double *restrict dxp, double *restrict dyp, double *restrict dut1)</td></tr>
<tr class="separator:a9ab448b9d09b5656cf74fe10ab855fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90862cafeee0a3534e9e52055a047286" id="r_a90862cafeee0a3534e9e52055a047286"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90862cafeee0a3534e9e52055a047286">novas_diurnal_ocean_tides</a> (double gmst, const <a class="el" href="structnovas__delaunay__args.html">novas_delaunay_args</a> *restrict delaunay, double *restrict dxp, double *restrict dyp, double *restrict dut1)</td></tr>
<tr class="separator:a90862cafeee0a3534e9e52055a047286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a348c4fd2a4a046e9768038075717b693" id="r_a348c4fd2a4a046e9768038075717b693"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a348c4fd2a4a046e9768038075717b693">novas_gast</a> (double jd_ut1, double ut1_to_tt, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy)</td></tr>
<tr class="separator:a348c4fd2a4a046e9768038075717b693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a231f535f73e846d3867dbd914054d47b" id="r_a231f535f73e846d3867dbd914054d47b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a231f535f73e846d3867dbd914054d47b">novas_gmst</a> (double jd_ut1, double ut1_to_tt)</td></tr>
<tr class="separator:a231f535f73e846d3867dbd914054d47b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eacba14d3c382d67307856a2ea290e3" id="r_a6eacba14d3c382d67307856a2ea290e3"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6eacba14d3c382d67307856a2ea290e3">sidereal_time</a> (double jd_ut1_high, double jd_ut1_low, double ut1_to_tt, enum <a class="el" href="novas_8h.html#ab970f5de5d5e04874cb31865459b0b4f">novas_equinox_type</a> gst_type, enum <a class="el" href="novas_8h.html#a9e882d9c9055f187d3a8dc9b019f0609">novas_earth_rotation_measure</a> erot, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double *restrict gst)</td></tr>
<tr class="separator:a6eacba14d3c382d67307856a2ea290e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc81730affa75f5facc8c6bd280c83c9" id="r_adc81730affa75f5facc8c6bd280c83c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc81730affa75f5facc8c6bd280c83c9">terra</a> (const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, double gast, double *restrict pos, double *restrict vel)</td></tr>
<tr class="separator:adc81730affa75f5facc8c6bd280c83c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead87744eeb3029ce7d5ffb1801ee652" id="r_aead87744eeb3029ce7d5ffb1801ee652"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aead87744eeb3029ce7d5ffb1801ee652">wobble</a> (double jd_tt, enum <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5">novas_wobble_direction</a> direction, double xp, double yp, const double *in, double *out)</td></tr>
<tr class="separator:aead87744eeb3029ce7d5ffb1801ee652"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>Created on Mar 6, 2025 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>G. Kaplan and Attila Kovacs</dd></dl>
<p>Various functions relating to Earth position and rotation. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aef1f8daaad470353648de90576aefc66" name="aef1f8daaad470353648de90576aefc66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef1f8daaad470353648de90576aefc66">&#9670;&#160;</a></span>era()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double era </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_ut1_high</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_ut1_low</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the value of the Earth Rotation Angle (&theta;) for a given UT1 Julian date. The expression used is taken from the note to IAU Resolution B1.8 of 2000. The input Julian date can be split into an into high and low order parts (e.g. integer and fractional parts) for improved accuracy, or else one of the components (e.g. the low part) can be set to zero if no split is desired.</p>
<p>The algorithm used here is equivalent to the canonical &theta; = 0.7790572732640 + 1.00273781191135448 * t, where t is the time in days from J2000 (t = jd_high + jd_low - JD_J2000), but it avoids many two-PI 'wraps' that decrease precision (adopted from SOFA Fortran routine <code>iau_era00</code>).</p>
<p>REFERENCES: </p><ol>
<li>
IERS Conventions 2010, Chapter 5, Eq. 5.15 </li>
<li>
IAU Resolution B1.8, adopted at the 2000 IAU General Assembly, Manchester, UK. </li>
<li>
Kaplan, G. (2005), US Naval Observatory Circular 179. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jd_ut1_high</td><td>[day] High-order part of UT1 Julian date. </td></tr>
    <tr><td class="paramname">jd_ut1_low</td><td>[day] Low-order part of UT1 Julian date. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] The Earth Rotation Angle (theta) in degrees [0:360].</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a348c4fd2a4a046e9768038075717b693">novas_gast()</a>, <a class="el" href="timescale_8c.html#aaf53fcad3fade814381cef3d06779a8c">novas_time_gst()</a> </dd>
<dd>
<a class="el" href="transform_8c.html#aa2768d89d499a7155f90a6fd8c176d8d">cirs_to_itrs()</a>, <a class="el" href="transform_8c.html#a12953f66c0f774284f0700ae785784d0">itrs_to_cirs()</a> </dd></dl>

</div>
</div>
<a id="ada5ca37110e66c8b65f623c9e26ae52e" name="ada5ca37110e66c8b65f623c9e26ae52e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada5ca37110e66c8b65f623c9e26ae52e">&#9670;&#160;</a></span>geo_posvel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short geo_posvel </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ut1_to_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobserver.html">observer</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>vel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the geocentric GCRS position and velocity of an observer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ut1_to_tt</td><td>[s] TT - UT1 time difference in seconds </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">obs</td><td>ITRF / GRS80 geodetic observer location. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Position 3-vector of observer, with respect to origin at geocenter, referred to GCRS axes, components in AU. (It may be NULL if not required.) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] Velocity 3-vector of observer, with respect to origin at geocenter, referred to GCRS axes, components in AU/day. (It must be distinct from the pos output vector, and may be NULL if not required) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if the 'obs' is NULL or the two output vectors are the same, or else 1 if 'accuracy' is invalid, or 2 if 'obserrver-&gt;where' is invalid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="frames_8c.html#adc72577f99a7b076b23e0e44ddbca838">novas_make_frame()</a>, <a class="el" href="observer_8c.html#a0f2096c7954b583fe749553b956ff9d2">make_observer()</a>, <a class="el" href="timescale_8c.html#a4d7470ca705efa1953e8b4beab77c6b6">get_ut1_to_tt()</a> </dd></dl>

<p class="reference">References <a class="el" href="place_8c.html#a713982e1f2bae0a72b39d03007f00d23">ephemeris()</a>, <a class="el" href="#ada5ca37110e66c8b65f623c9e26ae52e">geo_posvel()</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3a1665bf146ca1a4d11380bf4d7d9d7058">NOVAS_AIRBORNE_OBSERVER</a>, <a class="el" href="novas_8h.html#a208120c5fa3e12853eb37cb99d3e27beade504a1c5ccf790ce9d8ad52797bb94c">NOVAS_BARYCENTER</a>, <a class="el" href="novas_8h.html#abad802a863342aebe9a40587b4e47bab">NOVAS_EARTH_INIT</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="#a348c4fd2a4a046e9768038075717b693">novas_gast()</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3aca54b3a0c7d5b31d09090a1f55ff72b2">NOVAS_OBSERVER_AT_GEOCENTER</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3aca418efc57ac159cf541c324c008eb27">NOVAS_OBSERVER_IN_EARTH_ORBIT</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3aadb64b75d1bf5344760b942f241e52e8">NOVAS_OBSERVER_ON_EARTH</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3a82474207bac139bc2a8826b9d317a42c">NOVAS_SOLAR_SYSTEM_OBSERVER</a>, <a class="el" href="#adc81730affa75f5facc8c6bd280c83c9">terra()</a>, <a class="el" href="transform_8c.html#a6871e7fecde44084c7b4e1b8dda5ac70">tod_to_gcrs()</a>, <a class="el" href="timescale_8c.html#a129acca41760da486e1179c93cb9e86d">tt2tdb()</a>, and <a class="el" href="structobserver.html#a11f2eb69df64b674d938b34bbb842ab1">observer::where</a>.</p>

</div>
</div>
<a id="a022957936bc7c5a3e9651776689c9380" name="a022957936bc7c5a3e9651776689c9380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a022957936bc7c5a3e9651776689c9380">&#9670;&#160;</a></span>limb_angle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int limb_angle </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>limb_ang</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>nadir_ang</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines the angle of an object above or below the Earth's limb (horizon). The geometric limb is computed, assuming the Earth to be an airless sphere (no refraction or oblateness is included). The observer can be on or above the Earth. For an observer on the surface of the Earth, this function returns the approximate unrefracted elevation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">pos_src</td><td>[AU] Position 3-vector of observed object, with respect to origin at geocenter, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_obs</td><td>[AU] Position 3-vector of observer, with respect to origin at geocenter, components in AU. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">limb_ang</td><td>[deg] Angle of observed object above (+) or below (-) limb in degrees, or NAN if reurning with an error. It may be NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nadir_ang</td><td>Nadir angle of observed object as a fraction of apparent radius of limb: lt;1.0 if below the limb; 1.0 on the limb; or &gt;1.0 if above the limb. Returns NAN in case of an error return. It may be NULL if not required.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if either of the input vectors is NULL or if either input position is a null vector (at the geocenter). </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>, and <a class="el" href="util_8c.html#a0f41cefb8c872973b07e936b5026d143">novas_vlen()</a>.</p>

</div>
</div>
<a id="a3fe699281044873f4137344b28884cea" name="a3fe699281044873f4137344b28884cea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fe699281044873f4137344b28884cea">&#9670;&#160;</a></span>novas_diurnal_eop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_diurnal_eop </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>gmst</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnovas__delaunay__args.html">novas_delaunay_args</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>delaunay</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dxp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dyp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dut1</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate corrections to the Earth orientation parameters (EOP) due to short term (diurnal and semidiurnal) libration and the ocean tides. See Chapters 5 and 8 of the IERS Conventions. This one is faster than <code><a class="el" href="#a087d587e90b4e2138c0dba12d727696e">novas_diurnal_eop_at_time()</a></code> if the GMST and/or fundamental arguments are readily avaialbe, e.g. from a previous calculation.</p>
<p>These corrections are typically at the sub-milliarcsecond level in polar offsets <em>x</em> and <em>y</em> and sub-millisecond level in UT1. Thus, these diurnal and semi-diurnal variations are important for the highest precision astrometry only, when converting between ITRS and TIRS frames.</p>
<p>REFERENCES: </p><ol>
<li>
IERS Conventions 2010, Chapter 5, <a href="https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf">https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf</a> </li>
<li>
IERS Conventions 2010, Chapter 8, <a href="https://iers-conventions.obspm.fr/content/chapter8/icc8.pdf">https://iers-conventions.obspm.fr/content/chapter8/icc8.pdf</a> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">gmst</td><td>[h] Greenwich Mean Sidereal Time of observation, e.g. as obtained by <code><a class="el" href="#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a></code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">delaunay</td><td>[rad] Delaunay arguments, e.g. as returned by <code><a class="el" href="equinox_8c.html#a312b5ab1a004b179d80463a07ca7da8f">fund_args()</a></code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dxp</td><td>[arcsec] x-pole correction for libration and ocean tides, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dyp</td><td>[arcsec] y-pole corrections for libration and ocean tides, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dut1</td><td>[s] UT1 correction for libration and ocean tides, or NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if the delaunay arguments are NULL (errno set to EINVAL).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.5 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a087d587e90b4e2138c0dba12d727696e">novas_diurnal_eop_at_time()</a> </dd>
<dd>
novas_diurnal_librations(), <a class="el" href="#a90862cafeee0a3534e9e52055a047286">novas_diurnal_ocean_tides()</a> </dd></dl>

</div>
</div>
<a id="a087d587e90b4e2138c0dba12d727696e" name="a087d587e90b4e2138c0dba12d727696e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a087d587e90b4e2138c0dba12d727696e">&#9670;&#160;</a></span>novas_diurnal_eop_at_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_diurnal_eop_at_time </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structnovas__timespec.html">novas_timespec</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>time</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dxp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dyp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dut1</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate corrections to the Earth orientation parameters (EOP) due to short term (diurnal and semidiurnal) libration and the ocean tides at a given astromtric time. See Chapters 5 and 8 of the IERS Conventions.</p>
<p>REFERENCES: </p><ol>
<li>
IERS Conventions 2010, Chapter 5, <a href="https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf">https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf</a> </li>
<li>
IERS Conventions 2010, Chapter 8, <a href="https://iers-conventions.obspm.fr/content/chapter8/icc8.pdf">https://iers-conventions.obspm.fr/content/chapter8/icc8.pdf</a> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>Astrometric time specification </td></tr>
    <tr><td class="paramname">dxp</td><td>[arcsec] x-pole correction for libration and ocean tides, or NULL if not required. </td></tr>
    <tr><td class="paramname">dyp</td><td>[arcsec] y-pole corrections for libration and ocean tides, or NULL if not required. </td></tr>
    <tr><td class="paramname">dut1</td><td>[s] UT1 correction for libration and ocean tides, or NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if the delaunay arguments are NULL (errno set to EINVAL).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.5 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a3fe699281044873f4137344b28884cea">novas_diurnal_eop()</a> </dd></dl>

<p class="reference">References <a class="el" href="equinox_8c.html#a312b5ab1a004b179d80463a07ca7da8f">fund_args()</a>, <a class="el" href="#a3fe699281044873f4137344b28884cea">novas_diurnal_eop()</a>, <a class="el" href="novas_8h.html#a31bf4a08940bfa3e97ae6a1abee80422">NOVAS_JD_J2000</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, and <a class="el" href="timescale_8c.html#aaf53fcad3fade814381cef3d06779a8c">novas_time_gst()</a>.</p>

</div>
</div>
<a id="a9ab448b9d09b5656cf74fe10ab855fd4" name="a9ab448b9d09b5656cf74fe10ab855fd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ab448b9d09b5656cf74fe10ab855fd4">&#9670;&#160;</a></span>novas_diurnal_libration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_diurnal_libration </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>gmst</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnovas__delaunay__args.html">novas_delaunay_args</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>delaunay</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dxp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dyp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dut1</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate diurnal and semi-diurnal libration corrections to the Earth orientation parameters (EOP) for the non-rigid Earth. Only terms with periods less than 2 days are considered, since the longer period terms are included in the IAU2000A nutation model. See Chapter 5 of the IERS Conventions 2010. The typical amplitude of librations is tens of micro-arcseconds (&mu;as) in polar offsets <em>x</em> and <em>y</em> and tens of micro-seconds in UT1.</p>
<p>Normally, you would need the combined effect from librations and ocean tides together to apply diurnal corrections to the Earth orientation parameters (EOP) published by IERS. For that, <code><a class="el" href="#a3fe699281044873f4137344b28884cea">novas_diurnal_eop()</a></code> or <code><a class="el" href="#a087d587e90b4e2138c0dba12d727696e">novas_diurnal_eop_at_time()</a></code> is more directly suited.</p>
<p>REFERENCES: </p><ol>
<li>
IERS Conventions 2010, Chapter 5, Tablea 5.1a and 5.1b, see <a href="https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf">https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf</a> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">gmst</td><td>[h] Greenwich Mean Sidereal Time of observation, e.g. as obtained by <code><a class="el" href="#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a></code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">delaunay</td><td>[rad] Delaunay arguments, e.g. as returned by <code><a class="el" href="equinox_8c.html#a312b5ab1a004b179d80463a07ca7da8f">fund_args()</a></code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dxp</td><td>[arcsec] x-pole correction due to librations, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dyp</td><td>[arcsec] y-pole correction due to librations, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dut1</td><td>[s] UT1 correction due to librations, or NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if the delaunay arguments are NULL (errno set to EINVAL).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.5 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a3fe699281044873f4137344b28884cea">novas_diurnal_eop()</a>, <a class="el" href="#a90862cafeee0a3534e9e52055a047286">novas_diurnal_ocean_tides()</a> </dd></dl>

</div>
</div>
<a id="a90862cafeee0a3534e9e52055a047286" name="a90862cafeee0a3534e9e52055a047286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90862cafeee0a3534e9e52055a047286">&#9670;&#160;</a></span>novas_diurnal_ocean_tides()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_diurnal_ocean_tides </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>gmst</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnovas__delaunay__args.html">novas_delaunay_args</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>delaunay</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dxp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dyp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dut1</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate corrections to the Earth orientation parameters (EOP) due to the ocean tides. See Chapter 8 of the IERS Conventions 2010. Ocean tides manifest at the sub-milliarcsecond level in polar offsets <em>x</em> and <em>y</em> and sub-millisecond level in UT1.</p>
<p>Normally, you would need the combined effect from librations and ocean tides together to apply diurnal corrections to the Earth orientation parameters (EOP) published by IERS. For that, <code><a class="el" href="#a3fe699281044873f4137344b28884cea">novas_diurnal_eop()</a></code> or <code><a class="el" href="#a087d587e90b4e2138c0dba12d727696e">novas_diurnal_eop_at_time()</a></code> is more directly suited.</p>
<p>REFERENCES: </p><ol>
<li>
IERS Conventions 2010, Chapter 8, Tables 8.2a, 8.2b, 8.3a, and 8.3b, see <a href="https://iers-conventions.obspm.fr/content/chapter8/icc8.pdf">https://iers-conventions.obspm.fr/content/chapter8/icc8.pdf</a> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">gmst</td><td>[h] Greenwich Mean Sidereal Time of observation, e.g. as obtained by <code><a class="el" href="#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a></code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">delaunay</td><td>[rad] Delaunay arguments, e.g. as returned by <code><a class="el" href="equinox_8c.html#a312b5ab1a004b179d80463a07ca7da8f">fund_args()</a></code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dxp</td><td>[arcsec] x-pole correction due to ocean tides, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dyp</td><td>[arcsec] y-pole correction due to ocean tides, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dut1</td><td>[s] UT1 correction due to ocean tides, or NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if the delaunay arguments are NULL (errno set to EINVAL).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.5 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a3fe699281044873f4137344b28884cea">novas_diurnal_eop()</a>, novas_diurnal_librations() </dd></dl>

</div>
</div>
<a id="a348c4fd2a4a046e9768038075717b693" name="a348c4fd2a4a046e9768038075717b693"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a348c4fd2a4a046e9768038075717b693">&#9670;&#160;</a></span>novas_gast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_gast </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_ut1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ut1_to_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the Greenwich Apparent Sidereal Time (GAST) for a given UT1 date.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jd_ut1</td><td>[day] UT1-based Julian Date. </td></tr>
    <tr><td class="paramname">ut1_to_tt</td><td>[s] UT1 - UTC time difference. </td></tr>
    <tr><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[h] The Greenwich Apparent Sidereal Time (GAST) in the 0-24 range.</dd></dl>
<p>REFERENCES: </p><ol>
<li>
Capitaine, N. et al. (2003), Astronomy and Astrophysics 412, 567-586, eq. (42). </li>
<li>
Kaplan, G. (2005), US Naval Observatory Circular 179. </li>
<li>
IERS Conventions 2010, Chapter 5, Eq. 5.30 and Table 5.2e, see at <a href="https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf">https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf</a> and <a href="https://iers-conventions.obspm.fr/content/chapter5/additional_info/tab5.2e.txt">https://iers-conventions.obspm.fr/content/chapter5/additional_info/tab5.2e.txt</a> </li>
</ol>
<dl class="section since"><dt>Since</dt><dd>1.5 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a> </dd></dl>

<p class="reference">References <a class="el" href="equinox_8c.html#ab75165e2d69231da10c67de025ee05d8">e_tilt()</a>, and <a class="el" href="#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a>.</p>

</div>
</div>
<a id="a231f535f73e846d3867dbd914054d47b" name="a231f535f73e846d3867dbd914054d47b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a231f535f73e846d3867dbd914054d47b">&#9670;&#160;</a></span>novas_gmst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_gmst </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_ut1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ut1_to_tt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the Greenwich Mean Sidereal Time (GMST) for a given UT1 date, using eq. 42 from Capitaine et al. (2003).</p>
<p>REFERENCES: </p><ol>
<li>
Capitaine, N. et al. (2003), Astronomy and Astrophysics 412, 567-586, eq. (42). </li>
<li>
IERS Conventions 2010, Chapter 5, Eq. 5.32, see at <a href="https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf">https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf</a> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jd_ut1</td><td>[day] UT1-based Julian Date. </td></tr>
    <tr><td class="paramname">ut1_to_tt</td><td>[s] UT1 - UTC time difference. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[h] The Greenwich Mean Sidereal Time (GMST) in the 0-24 range.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.5 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a348c4fd2a4a046e9768038075717b693">novas_gast()</a>, <a class="el" href="timescale_8c.html#aaf53fcad3fade814381cef3d06779a8c">novas_time_gst()</a> </dd></dl>

<p class="reference">References <a class="el" href="#aef1f8daaad470353648de90576aefc66">era()</a>.</p>

</div>
</div>
<a id="a6eacba14d3c382d67307856a2ea290e3" name="a6eacba14d3c382d67307856a2ea290e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eacba14d3c382d67307856a2ea290e3">&#9670;&#160;</a></span>sidereal_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short sidereal_time </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_ut1_high</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_ut1_low</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ut1_to_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#ab970f5de5d5e04874cb31865459b0b4f">novas_equinox_type</a></td>          <td class="paramname"><span class="paramname"><em>gst_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a9e882d9c9055f187d3a8dc9b019f0609">novas_earth_rotation_measure</a></td>          <td class="paramname"><span class="paramname"><em>erot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>gst</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000005">Deprecated</a></b></dt><dd>Use <a class="el" href="#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a> or <a class="el" href="#a348c4fd2a4a046e9768038075717b693">novas_gast()</a> instead to get the same results simpler.</dd></dl>
<p>Computes the Greenwich sidereal time, either mean or apparent, at the specified Julian date. The Julian date can be broken into two parts if convenient, but for the highest precision, set 'jd_high' to be the integral part of the Julian date, and set 'jd_low' to be the fractional part.</p>
<p>NOTES: </p><ol>
<li>
Contains fix for known <a href="https://aa.usno.navy.mil/software/novas_faq">sidereal time units bug.</a> </li>
<li>
As of version 1.5.0, the function uses Eq 42 of Capitaine et al. (2003) exclusively. In prior versions, including NOVAS C the same method was provided twice, with the only difference being an unnecessary change of coordinate basis to GCRS. This latter, mor roundabout way of getting the same answer has been eliminated.&lt;.li&gt; </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Capitaine, N. et al. (2003), Astronomy and Astrophysics 412, 567-586, eq. (42). </li>
<li>
Kaplan, G. (2005), US Naval Observatory Circular 179. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_ut1_high</td><td>[day] High-order part of UT1 Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">jd_ut1_low</td><td>[day] Low-order part of UT1 Julian date. (You can leave it at zero if 'jd_high' specified the date with sufficient precision) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ut1_to_tt</td><td>[s] TT - UT1 Time difference in seconds </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gst_type</td><td>NOVAS_MEAN_EQUINOX (0) or NOVAS_TRUE_EQUINOX (1), depending on whether wanting mean or apparent GST, respectively. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">erot</td><td>Unused as of 1.5.0. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gst</td><td>[h] Greenwich (mean or apparent) sidereal time, in hours [0:24]. (In case the returned error code is &gt;1 the gst value will be set to NAN.) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if the 'gst' argument is NULL, 1 if 'accuracy' is</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a>, <a class="el" href="#a348c4fd2a4a046e9768038075717b693">novas_gast()</a>, <a class="el" href="timescale_8c.html#aaf53fcad3fade814381cef3d06779a8c">novas_time_gst()</a> </dd>
<dd>
<a class="el" href="#aef1f8daaad470353648de90576aefc66">era()</a>, <a class="el" href="timescale_8c.html#a4d7470ca705efa1953e8b4beab77c6b6">get_ut1_to_tt()</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="#a348c4fd2a4a046e9768038075717b693">novas_gast()</a>, <a class="el" href="#a231f535f73e846d3867dbd914054d47b">novas_gmst()</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, and <a class="el" href="novas_8h.html#ab970f5de5d5e04874cb31865459b0b4fa1096785746d1a9bc678ea2c51fc21055">NOVAS_TRUE_EQUINOX</a>.</p>

</div>
</div>
<a id="adc81730affa75f5facc8c6bd280c83c9" name="adc81730affa75f5facc8c6bd280c83c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc81730affa75f5facc8c6bd280c83c9">&#9670;&#160;</a></span>terra()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int terra </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>location</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>gast</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>vel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the position and velocity vectors of a terrestrial observer with respect to the center of the Earth, based on the GRS80 reference ellipsoid, used for the International Terrestrial Reference Frame (ITRF) and its realizations.</p>
<p>This function ignores polar motion, unless the observer's longitude and latitude have been corrected for it, and variation in the length of day (angular velocity of earth).</p>
<p>The true equator and equinox of date do not form an inertial system. Therefore, with respect to an inertial system, the very small velocity component (several meters/day) due to the precession and nutation of the Earth's axis is not accounted for here.</p>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. H. et. al. (1989). Astron. Journ. 97, 1197-1210. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">location</td><td>ITRF / GRS80 geodetic location of observer in Earth's rotating frame. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gast</td><td>[h] Greenwich apparent sidereal time (GAST). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Position vector of observer with respect to center of Earth, equatorial rectangular coordinates, referred to true equator and equinox of date, components in AU. If reference meridian is Greenwich and 'lst' = 0, 'pos' is effectively referred to equator and Greenwich. (It may be NULL if no position data is required). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] Velocity vector of observer with respect to center of Earth, equatorial rectangular coordinates, referred to true equator and equinox of date, components in AU/day. (It must be distinct from the pos output vector, and may be NULL if no velocity data is required).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if location is NULL or if the pos and vel output arguments are identical pointers.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ada5ca37110e66c8b65f623c9e26ae52e">geo_posvel()</a> </dd>
<dd>
<a class="el" href="observer_8c.html#ab5fb62a9fb185632175ae622bce28dea">make_gps_site()</a>, <a class="el" href="observer_8c.html#a236750f494f3dcd943e71ba24aa2a55b">make_itrf_site()</a>, <a class="el" href="observer_8c.html#a9e3cbe310a40919ff94d2d530ffa74ee">make_xyz_site()</a>, <a class="el" href="#a348c4fd2a4a046e9768038075717b693">novas_gast()</a>, <a class="el" href="timescale_8c.html#aaf53fcad3fade814381cef3d06779a8c">novas_time_gst()</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a0a84af1a760ed2aaa01dd93e9e22bdf1">NOVAS_KM</a>.</p>

</div>
</div>
<a id="aead87744eeb3029ce7d5ffb1801ee652" name="aead87744eeb3029ce7d5ffb1801ee652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead87744eeb3029ce7d5ffb1801ee652">&#9670;&#160;</a></span>wobble()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wobble </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5">novas_wobble_direction</a></td>          <td class="paramname"><span class="paramname"><em>direction</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>xp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>yp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Corrects a vector in the ITRS (rotating Earth-fixed system) for polar motion, and also corrects the longitude origin (by a tiny amount) to the Terrestrial Intermediate Origin (TIO). The ITRS vector is thereby transformed to the Terrestrial Intermediate Reference System (TIRS), or equivalently the Pseudo Earth Fixed (PEF), based on the true (rotational) equator and TIO; or vice versa. Because the true equator is the plane orthogonal to the direction of the Celestial Intermediate Pole (CIP), the components of the output vector are referred to <em>z</em> and <em>x</em> axes toward the CIP and TIO, respectively.</p>
<p>NOTES: </p><ol>
<li>
You may obtain Earth orientation parameters from the IERS site and Bulletins. For sub-mas accuracy you should augment the (interpolated) published values for diurnal and semi-diurnal librations and the effect of ocean tides, e.g. by using <code><a class="el" href="#a3fe699281044873f4137344b28884cea">novas_diurnal_eop()</a></code> or <code><a class="el" href="#a087d587e90b4e2138c0dba12d727696e">novas_diurnal_eop_at_time()</a></code>.  </li>
<li>
Generally, this function should not be called if global pole offsets were set via <code><a class="el" href="equinox_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a></code> and then used via <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c">place()</a></code> or one of its variants to calculate Earth orientation corrected (TOD or CIRS) apparent coordinates. In such cases, calling <code><a class="el" href="#aead87744eeb3029ce7d5ffb1801ee652">wobble()</a></code> would apply duplicate corrections. It is generally best to forgo using <code><a class="el" href="equinox_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a></code> going forward, and instead apply Earth orinetation corrections with <code><a class="el" href="#aead87744eeb3029ce7d5ffb1801ee652">wobble()</a></code> only when converting vectors between the Earth-fixed ITRS and TIRS frames.  </li>
<li>
The Earth orientation parameters xp, yp should be provided in the same ITRF realization as the observer location for an Earth-based observer. You can use <code><a class="el" href="itrf_8c.html#a3c8c9b8f709d1e5a7aa3a915f8fafcbb">novas_itrf_transform_eop()</a></code> to convert the EOP values as necessary.  </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. H. et. al. (1989). Astron. Journ. 97, 1197-1210. </li>
<li>
Lambert &amp; Bizouard (2002), Astronomy and Astrophysics 394, 317-321. </li>
<li>
IERS Conventions 2010, Chapter 5, <a href="https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf">https://iers-conventions.obspm.fr/content/chapter5/icc5.pdf</a> </li>
<li>
IERS Conventions 2010, Chapter 8, <a href="https://iers-conventions.obspm.fr/content/chapter8/icc8.pdf">https://iers-conventions.obspm.fr/content/chapter8/icc8.pdf</a> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">direction</td><td>WOBBLE_ITRS_TO_TIRS (0) or WOBBLE_TIRS_TO_ITRS (1) to include corrections for the TIO's longitude (IAU 2006 method); or else WOBBLE_ITRS_TO_PEF (2) or WOBBLE_PEF_TO_ITRS (3) to correct for dx, dy but not for the TIO's longitude (old, pre IAU 2006 method). Negative values default to WOBBLE_TIRS_TO_ITRS. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">xp</td><td>[arcsec] Conventionally-defined X coordinate of Celestial Intermediate Pole with respect to ITRS pole. As measured or else the interpolated published value from IERS, possibly augmented for diurnal variations caused by librations ocean tides if precision below the milliarcsecond level is required. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">yp</td><td>[arcsec] Conventionally-defined Y coordinate of Celestial Intermediate Pole with respect to ITRS pole, in arcseconds. As measured or else the interpolated published value from IERS, possibly augmented for diurnal variations caused by librations ocean tides if precision below the milliarcsecond level is required. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>Input position vector, geocentric equatorial rectangular coordinates, in the original system defined by 'direction' </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Output Position vector, geocentric equatorial rectangular coordinates, in the final system defined by 'direction'. It can be the same vector as the input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if the direction is invalid output vector argument is NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a3fe699281044873f4137344b28884cea">novas_diurnal_eop()</a>, <a class="el" href="#a087d587e90b4e2138c0dba12d727696e">novas_diurnal_eop_at_time()</a>, novas_itrf_transfor_eop() </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a3903b6d439f4a25a6482fd073996d9ec">NOVAS_WOBBLE_DIRECTIONS</a>, <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5ac1fc144f868517a2268a56343cc218a9">WOBBLE_ITRS_TO_PEF</a>, <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5a88d1bc6832a20ed34c4dab5753864851">WOBBLE_ITRS_TO_TIRS</a>, and <a class="el" href="novas_8h.html#aab27106a2d5c2c7fa64b2f208deff7f5a4b792b9dcf18048019f1a4fb486b7c97">WOBBLE_TIRS_TO_ITRS</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="earth_8c.html">earth.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
