<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuperNOVAS: Spectroscopic applications</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__spectral.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Spectroscopic applications</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3ce6b306bc183387d0aaac97abbd82e8" id="r_ga3ce6b306bc183387d0aaac97abbd82e8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3ce6b306bc183387d0aaac97abbd82e8">grav_redshift</a> (double M_kg, double r_m)</td></tr>
<tr class="memdesc:ga3ce6b306bc183387d0aaac97abbd82e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the gravitational redshift (<em>z</em>) for light emitted near a massive spherical body at some distance from its center, and observed at some very large (infinite) distance away.  <br /></td></tr>
<tr class="separator:ga3ce6b306bc183387d0aaac97abbd82e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad80bf94be2efc36c340994829df8207" id="r_gaad80bf94be2efc36c340994829df8207"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaad80bf94be2efc36c340994829df8207">novas_lsr_to_ssb_vel</a> (double epoch, double ra, double dec, double vLSR)</td></tr>
<tr class="memdesc:gaad80bf94be2efc36c340994829df8207"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a Solar System Baricentric (SSB) radial velocity for a radial velocity that is referenced to the Local Standard of Rest (LSR).  <br /></td></tr>
<tr class="separator:gaad80bf94be2efc36c340994829df8207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga99ed25baa029f3980924da8c8af54d1a" id="r_ga99ed25baa029f3980924da8c8af54d1a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga99ed25baa029f3980924da8c8af54d1a">novas_ssb_to_lsr_vel</a> (double epoch, double ra, double dec, double vLSR)</td></tr>
<tr class="memdesc:ga99ed25baa029f3980924da8c8af54d1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a radial-velocity referenced to the Local Standard of Rest (LSR) for a given Solar-System Barycentric (SSB) radial velocity.  <br /></td></tr>
<tr class="separator:ga99ed25baa029f3980924da8c8af54d1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa54cd00024b294d38fa29433c017c65f" id="r_gaa54cd00024b294d38fa29433c017c65f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa54cd00024b294d38fa29433c017c65f">novas_v2z</a> (double vel)</td></tr>
<tr class="memdesc:gaa54cd00024b294d38fa29433c017c65f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a radial recession velocity to a redshift value (z = &Delta;&lambda; / &lambda;<sub>rest</sub>).  <br /></td></tr>
<tr class="separator:gaa54cd00024b294d38fa29433c017c65f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga63621cea3b4985c1bfcc4514a7aa3fb1" id="r_ga63621cea3b4985c1bfcc4514a7aa3fb1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga63621cea3b4985c1bfcc4514a7aa3fb1">novas_z2v</a> (double z)</td></tr>
<tr class="memdesc:ga63621cea3b4985c1bfcc4514a7aa3fb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a redshift value (z = &Delta;&lambda; / &lambda;<sub>rest</sub>) to a radial velocity (i.e.  <br /></td></tr>
<tr class="separator:ga63621cea3b4985c1bfcc4514a7aa3fb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga493ab751eee5804db77157c37e94e5c3" id="r_ga493ab751eee5804db77157c37e94e5c3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga493ab751eee5804db77157c37e94e5c3">novas_z_add</a> (double z1, double z2)</td></tr>
<tr class="memdesc:ga493ab751eee5804db77157c37e94e5c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compounds two redshift corrections, e.g.  <br /></td></tr>
<tr class="separator:ga493ab751eee5804db77157c37e94e5c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1130ad2ce520e948c71f03a25a713075" id="r_ga1130ad2ce520e948c71f03a25a713075"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1130ad2ce520e948c71f03a25a713075">novas_z_inv</a> (double z)</td></tr>
<tr class="memdesc:ga1130ad2ce520e948c71f03a25a713075"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the inverse of a redshift value, that is the redshift for a body moving with the same velocity as the original but in the opposite direction.  <br /></td></tr>
<tr class="separator:ga1130ad2ce520e948c71f03a25a713075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafca24d914664bb60d20fb428177f329a" id="r_gafca24d914664bb60d20fb428177f329a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gafca24d914664bb60d20fb428177f329a">rad_vel</a> (const <a class="el" href="structobject.html">object</a> *restrict source, const double *restrict pos_src, const double *vel_src, const double *vel_obs, double d_obs_geo, double d_obs_sun, double d_src_sun, double *restrict rv)</td></tr>
<tr class="memdesc:gafca24d914664bb60d20fb428177f329a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predicts the radial velocity of the observed object as it would be measured by spectroscopic means.  <br /></td></tr>
<tr class="separator:gafca24d914664bb60d20fb428177f329a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga37f22e463cc06b4e381aa18659e6319d" id="r_ga37f22e463cc06b4e381aa18659e6319d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga37f22e463cc06b4e381aa18659e6319d">rad_vel2</a> (const <a class="el" href="structobject.html">object</a> *restrict source, const double *pos_emit, const double *vel_src, const double *pos_det, const double *vel_obs, double d_obs_geo, double d_obs_sun, double d_src_sun)</td></tr>
<tr class="memdesc:ga37f22e463cc06b4e381aa18659e6319d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predicts the radial velocity of the observed object as it would be measured by spectroscopic means.  <br /></td></tr>
<tr class="separator:ga37f22e463cc06b4e381aa18659e6319d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf56088995d42a0673e03bca1f3891544" id="r_gaf56088995d42a0673e03bca1f3891544"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf56088995d42a0673e03bca1f3891544">redshift_vrad</a> (double vrad, double z)</td></tr>
<tr class="memdesc:gaf56088995d42a0673e03bca1f3891544"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies an incremental redshift correction to a radial velocity.  <br /></td></tr>
<tr class="separator:gaf56088995d42a0673e03bca1f3891544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea89203030ca831260dec18f83081d23" id="r_gaea89203030ca831260dec18f83081d23"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaea89203030ca831260dec18f83081d23">unredshift_vrad</a> (double vrad, double z)</td></tr>
<tr class="memdesc:gaea89203030ca831260dec18f83081d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undoes an incremental redshift correction that was applied to radial velocity.  <br /></td></tr>
<tr class="separator:gaea89203030ca831260dec18f83081d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga3ce6b306bc183387d0aaac97abbd82e8" name="ga3ce6b306bc183387d0aaac97abbd82e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ce6b306bc183387d0aaac97abbd82e8">&#9670;&#160;</a></span>grav_redshift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double grav_redshift </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>M_kg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>r_m</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the gravitational redshift (<em>z</em>) for light emitted near a massive spherical body at some distance from its center, and observed at some very large (infinite) distance away. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">M_kg</td><td>[kg] Mass of gravitating body that is contained inside the emitting radius. </td></tr>
    <tr><td class="paramname">r_m</td><td>[m] Radius at which light is emitted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The gravitational redshift (<em>z</em>) for an observer at very large (infinite) distance from the gravitating body.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaf56088995d42a0673e03bca1f3891544" title="Applies an incremental redshift correction to a radial velocity.">redshift_vrad()</a>, <a class="el" href="#gaea89203030ca831260dec18f83081d23" title="Undoes an incremental redshift correction that was applied to radial velocity.">unredshift_vrad()</a>, <a class="el" href="#ga493ab751eee5804db77157c37e94e5c3" title="Compounds two redshift corrections, e.g.">novas_z_add()</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.2 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>

</div>
</div>
<a id="gaad80bf94be2efc36c340994829df8207" name="gaad80bf94be2efc36c340994829df8207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaad80bf94be2efc36c340994829df8207">&#9670;&#160;</a></span>novas_lsr_to_ssb_vel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_lsr_to_ssb_vel </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>epoch</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>vLSR</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a Solar System Baricentric (SSB) radial velocity for a radial velocity that is referenced to the Local Standard of Rest (LSR). </p>
<p>Internally, NOVAS always uses barycentric radial velocities, but it is just as common to have catalogs define radial velocities referenced to the LSR.</p>
<p>The SSB motion w.r.t. the barycenter is assumed to be (11.1, 12.24, 7.25) km/s in ICRS (Shoenrich et al. 2010).</p>
<p>REFERENCES: </p><ol>
<li>
Ralph Schoenrich, James Binney, Walter Dehnen, Monthly Notices of the Royal Astronomical Society, Volume 403, Issue 4, April 2010, Pages 1829–1833, <a href="https://doi.org/10.1111/j.1365-2966.2010.16253.x">https://doi.org/10.1111/j.1365-2966.2010.16253.x</a> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">epoch</td><td>[yr] Coordinate epoch in which the coordinates and velocities are defined. E.g. 2000.0. </td></tr>
    <tr><td class="paramname">ra</td><td>[h] Right-ascenscion of source at given epoch. </td></tr>
    <tr><td class="paramname">dec</td><td>[deg] Declination of source at given epoch. </td></tr>
    <tr><td class="paramname">vLSR</td><td>[km/s] radial velocity defined against the Local Standard of Rest (LSR), at given epoch.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[km/s] Equivalent Solar-System Barycentric radial velocity.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga99ed25baa029f3980924da8c8af54d1a" title="Returns a radial-velocity referenced to the Local Standard of Rest (LSR) for a given Solar-System Bar...">novas_ssb_to_lsr_vel()</a>, <a class="el" href="group__source.html#gaa040bcfe8bee7d8e1307800f48efddd7" title="Fully populates the data structure for a catalog source, such as a star, with all parameters provided...">make_cat_entry()</a> </dd>
<dd>
<a class="el" href="group__util.html#ga3ed26b6af870f6dbc353f651563afd4a" title="Returns a time or time-like angleparsed from a string that contains either a decimal hours or else a ...">novas_str_hours()</a>, <a class="el" href="group__util.html#ga6d6ada07aab7ce09fb8ea7b12660ebcd" title="Returns an angle parsed from a string that contains either a decimal degrees or else a broken-down DM...">novas_str_degrees()</a> </dd></dl>

<p class="reference">References <a class="el" href="group__time.html#ga31bf4a08940bfa3e97ae6a1abee80422">NOVAS_JD_J2000</a>, <a class="el" href="group__time.html#gabb3df52add3f6fb17e5c1c6a7f428c70">NOVAS_JULIAN_YEAR_DAYS</a>, <a class="el" href="group__earth.html#ga9178358732325399f3a5e3582080ced3">precession()</a>, and <a class="el" href="group__util.html#gae104afd1bc638def9bdbce1801e5054a">radec2vector()</a>.</p>

</div>
</div>
<a id="ga99ed25baa029f3980924da8c8af54d1a" name="ga99ed25baa029f3980924da8c8af54d1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga99ed25baa029f3980924da8c8af54d1a">&#9670;&#160;</a></span>novas_ssb_to_lsr_vel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_ssb_to_lsr_vel </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>epoch</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>vLSR</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a radial-velocity referenced to the Local Standard of Rest (LSR) for a given Solar-System Barycentric (SSB) radial velocity. </p>
<p>Internally, NOVAS always uses barycentric radial velocities, but it is just as common to have catalogs define radial velocities referenced to the LSR.</p>
<p>The SSB motion w.r.t. the barycenter is assumed to be (11.1, 12.24, 7.25) km/s in ICRS (Shoenrich et al. 2010).</p>
<p>REFERENCES: </p><ol>
<li>
Ralph Schoenrich, James Binney, Walter Dehnen, Monthly Notices of the Royal Astronomical Society, Volume 403, Issue 4, April 2010, Pages 1829–1833, <a href="https://doi.org/10.1111/j.1365-2966.2010.16253.x">https://doi.org/10.1111/j.1365-2966.2010.16253.x</a> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">epoch</td><td>[yr] Coordinate epoch in which the coordinates and velocities are defined. E.g. 2000.0. </td></tr>
    <tr><td class="paramname">ra</td><td>[h] Right-ascenscion of source at given epoch. </td></tr>
    <tr><td class="paramname">dec</td><td>[deg] Declination of source at given epoch. </td></tr>
    <tr><td class="paramname">vLSR</td><td>[km/s] radial velocity defined against the Local Standard of Rest (LSR), at given epoch.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[km/s] Equivalent Solar-System Barycentric radial velocity.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaad80bf94be2efc36c340994829df8207" title="Returns a Solar System Baricentric (SSB) radial velocity for a radial velocity that is referenced to ...">novas_lsr_to_ssb_vel()</a>, <a class="el" href="group__source.html#gaa040bcfe8bee7d8e1307800f48efddd7" title="Fully populates the data structure for a catalog source, such as a star, with all parameters provided...">make_cat_entry()</a> </dd>
<dd>
<a class="el" href="group__util.html#ga3ed26b6af870f6dbc353f651563afd4a" title="Returns a time or time-like angleparsed from a string that contains either a decimal hours or else a ...">novas_str_hours()</a>, <a class="el" href="group__util.html#ga6d6ada07aab7ce09fb8ea7b12660ebcd" title="Returns an angle parsed from a string that contains either a decimal degrees or else a broken-down DM...">novas_str_degrees()</a> </dd></dl>

<p class="reference">References <a class="el" href="group__time.html#ga31bf4a08940bfa3e97ae6a1abee80422">NOVAS_JD_J2000</a>, <a class="el" href="group__time.html#gabb3df52add3f6fb17e5c1c6a7f428c70">NOVAS_JULIAN_YEAR_DAYS</a>, <a class="el" href="group__earth.html#ga9178358732325399f3a5e3582080ced3">precession()</a>, and <a class="el" href="group__util.html#gae104afd1bc638def9bdbce1801e5054a">radec2vector()</a>.</p>

</div>
</div>
<a id="gaa54cd00024b294d38fa29433c017c65f" name="gaa54cd00024b294d38fa29433c017c65f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa54cd00024b294d38fa29433c017c65f">&#9670;&#160;</a></span>novas_v2z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_v2z </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>vel</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a radial recession velocity to a redshift value (z = &Delta;&lambda; / &lambda;<sub>rest</sub>). </p>
<p>It is based on the relativistic formula: </p><pre>
 1 + z = sqrt((1 + &beta;) / (1 - &beta;))
</pre><p> where &beta; = <em>v</em><sub>rad</sub> / <em>c</em>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vel</td><td>[km/s] velocity (i.e. rate) of recession. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the corresponding redshift value (z = &Delta;&lambda; / &lambda;<sub>rest</sub>), or NAN if the input velocity is invalid (i.e., it exceeds the speed of light).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.2</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga63621cea3b4985c1bfcc4514a7aa3fb1" title="Converts a redshift value (z = Δλ / λrest) to a radial velocity (i.e.">novas_z2v()</a>, <a class="el" href="#ga493ab751eee5804db77157c37e94e5c3" title="Compounds two redshift corrections, e.g.">novas_z_add()</a> </dd></dl>

<p class="reference">References <a class="el" href="group__source.html#ga7822b81ad3f75b448f446ed4da774e75">NOVAS_KMS</a>.</p>

</div>
</div>
<a id="ga63621cea3b4985c1bfcc4514a7aa3fb1" name="ga63621cea3b4985c1bfcc4514a7aa3fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga63621cea3b4985c1bfcc4514a7aa3fb1">&#9670;&#160;</a></span>novas_z2v()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_z2v </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a redshift value (z = &Delta;&lambda; / &lambda;<sub>rest</sub>) to a radial velocity (i.e. </p>
<p>rate) of recession. It is based on the relativistic formula: </p><pre>
 1 + z = sqrt((1 + &beta;) / (1 - &beta;))
</pre><p> where &beta; = <em>v</em><sub>rad</sub> / <em>c</em>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td>the redshift value (z = &Delta;&lambda; / &lambda;<sub>rest</sub>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[km/s] Corresponding velocity of recession, or NAN if the input redshift is invalid, i.e. z &lt;= -1).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.2</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaa54cd00024b294d38fa29433c017c65f" title="Converts a radial recession velocity to a redshift value (z = Δλ / λrest).">novas_v2z()</a>, <a class="el" href="#gaf56088995d42a0673e03bca1f3891544" title="Applies an incremental redshift correction to a radial velocity.">redshift_vrad()</a> </dd></dl>

<p class="reference">References <a class="el" href="group__source.html#ga7822b81ad3f75b448f446ed4da774e75">NOVAS_KMS</a>.</p>

</div>
</div>
<a id="ga493ab751eee5804db77157c37e94e5c3" name="ga493ab751eee5804db77157c37e94e5c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga493ab751eee5804db77157c37e94e5c3">&#9670;&#160;</a></span>novas_z_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_z_add </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z2</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compounds two redshift corrections, e.g. </p>
<p>to apply (or undo) a series gravitational redshift corrections and/or corrections for a moving observer. It's effectively using</p>
<p>(1 + <em>z</em>) = (1 + <em>z</em><sub>1</sub>) * (1 + <em>z</em><sub>2</sub>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z1</td><td>One of the redshift values </td></tr>
    <tr><td class="paramname">z2</td><td>The other redshift value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The compound redshift value, ot NAN if either input redshift is invalid (errno will be set to EINVAL).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.2 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga3ce6b306bc183387d0aaac97abbd82e8" title="Returns the gravitational redshift (z) for light emitted near a massive spherical body at some distan...">grav_redshift()</a>, <a class="el" href="#gaf56088995d42a0673e03bca1f3891544" title="Applies an incremental redshift correction to a radial velocity.">redshift_vrad()</a>, <a class="el" href="#gaea89203030ca831260dec18f83081d23" title="Undoes an incremental redshift correction that was applied to radial velocity.">unredshift_vrad()</a> </dd></dl>

</div>
</div>
<a id="ga1130ad2ce520e948c71f03a25a713075" name="ga1130ad2ce520e948c71f03a25a713075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1130ad2ce520e948c71f03a25a713075">&#9670;&#160;</a></span>novas_z_inv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_z_inv </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the inverse of a redshift value, that is the redshift for a body moving with the same velocity as the original but in the opposite direction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td>A redhift value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The redshift value for a body moving in the opposite direction with the same speed, or NAN if the input redshift is invalid.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.2 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga493ab751eee5804db77157c37e94e5c3" title="Compounds two redshift corrections, e.g.">novas_z_add()</a> </dd></dl>

</div>
</div>
<a id="gafca24d914664bb60d20fb428177f329a" name="gafca24d914664bb60d20fb428177f329a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafca24d914664bb60d20fb428177f329a">&#9670;&#160;</a></span>rad_vel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rad_vel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structobject.html">object</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>vel_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>vel_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>d_obs_geo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>d_obs_sun</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>d_src_sun</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>rv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Predicts the radial velocity of the observed object as it would be measured by spectroscopic means. </p>
<p>Radial velocity is defined here as a spectroscopic measure, defined by the relation:</p>
<p>&lambda;<sub>obs</sub> / &lambda;<sub>rest</sub> = (1 + <em>z</em>) = sqrt((1 + &beta;) / (1 - &beta;)),</p>
<p>where &beta; = <em>v</em><sub>rad</sub> / <em>c</em>.</p>
<p>For the major planets (and Sun and Moon), it includes gravitational corrections for light originating at the surface and observed from near Earth or else from a large distance away. For other solar system bodies, it applies to a fictitious emitter at the center of the observed object, assumed massless (no gravitational red shift). The corrections do not in general apply to reflected light. For stars, it includes all effects, such as gravitational redshift, contained in the catalog barycentric radial velocity measure, a scalar derived from spectroscopy. Nearby stars with a known kinematic velocity vector (obtained independently of spectroscopy) can be treated like solar system objects.</p>
<p>Gravitational blueshift corrections for the Solar and Earth potential for observers are included. However, the result does not include a blueshift correction for observers (e.g. spacecraft) orbiting other major Solar-system bodies. You may adjust the amount of gravitational redshift correction applied to the radial velocity via <code><a class="el" href="#gaf56088995d42a0673e03bca1f3891544" title="Applies an incremental redshift correction to a radial velocity.">redshift_vrad()</a></code>, <code><a class="el" href="#gaea89203030ca831260dec18f83081d23" title="Undoes an incremental redshift correction that was applied to radial velocity.">unredshift_vrad()</a></code> and <code><a class="el" href="#ga3ce6b306bc183387d0aaac97abbd82e8" title="Returns the gravitational redshift (z) for light emitted near a massive spherical body at some distan...">grav_redshift()</a></code> if necessary.</p>
<p>The input velocities are barycentric, expressed with respect to the ICRS axes. <code>vel_src</code> and <code>vel_obs</code> are kinematic velocities - derived from geometry or dynamics, not spectroscopy.</p>
<p>If the object is outside the solar system, the algorithm used will be consistent with the IAU definition of stellar radial velocity, specifically, the barycentric radial velocity measure, which is derived from spectroscopy. In that case, the vector 'vel_src' can be very approximate &ndash; or, for distant stars or galaxies, zero &ndash; as it will be used only for a small geometric correction that is proportional to proper motion.</p>
<p>Any of the distances (last three input arguments) can be set to zero (0.0) or negative if the corresponding general relativistic gravitational potential term is not to be evaluated. These terms generally are important at the meter/second level only. If <code>d_obs_geo</code> and <code>d_obs_sun</code> are both zero, an average value will be used for the relativistic term for the observer, appropriate for an observer on the surface of the Earth. <code>d_src_sun</code>, if given, is used only for solar system objects.</p>
<p>NOTES: </p><ol>
<li>
This function does not accont for the gravitational deflection of Solar-system sources. For that purpose, the <a class="el" href="#ga37f22e463cc06b4e381aa18659e6319d" title="Predicts the radial velocity of the observed object as it would be measured by spectroscopic means.">rad_vel2()</a> function, introduced in v1.1, is more appropriate. </li>
<li>
The NOVAS C implementation did not include relatistic corrections for a moving observer if both <code>d_obs_geo</code> and <code>d_obs_sun</code> were zero. As of SuperNOVAS v1.1, the relatistic corrections for a moving observer will be included in the radial velocity measure always. </li>
<li>
In a departure from the original NOVAS C, the radial velocity for major planets (and Sun and Moon) includes gravitational redshift corrections for light originating at the surface, assuming it's observed from near Earth or else from a large distance away. </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Lindegren &amp; Dravins (2003), Astronomy &amp; Astrophysics 401, 1185-1201. </li>
<li>
Unlike NOVAS C, this function will return a radial velocity for the Sun that is gravitationally referenced to the Sun's photosphere. (NOVAS C returns the radial velocity for a massless Sun) </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">source</td><td>Celestial object observed </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_src</td><td>[AU|*] Geometric position vector of object with respect to observer. For solar system sources it should be corrected for light-time. For non-solar-system objects, the position vector defines a direction only, with arbitrary magnitude. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vel_src</td><td>[AU/day] Velocity vector of object with respect to solar system barycenter. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vel_obs</td><td>[AU/day] Velocity vector of observer with respect to solar system barycenter. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">d_obs_geo</td><td>[AU] Distance from observer to geocenter, or &lt;=0.0 if gravitational blueshifting due to Earth potential around observer can be ignored. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">d_obs_sun</td><td>[AU] Distance from observer to Sun, or &lt;=0.0 if gravitational bluehifting due to Solar potential around observer can be ignored. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">d_src_sun</td><td>[AU] Distance from object to Sun, or &lt;=0.0 if gravitational redshifting due to Solar potential around source can be ignored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rv</td><td>[km/s] The spectroscopic radial velocity measure from the observer's point of view, or NAN if there was an error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successfule, or else -1 if there was an error (errno will be set to EINVAL if any of the arguments are NULL, or to some other value to indicate the type of error).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga37f22e463cc06b4e381aa18659e6319d" title="Predicts the radial velocity of the observed object as it would be measured by spectroscopic means.">rad_vel2()</a> </dd></dl>

<p class="reference">References <a class="el" href="#ga37f22e463cc06b4e381aa18659e6319d">rad_vel2()</a>.</p>

</div>
</div>
<a id="ga37f22e463cc06b4e381aa18659e6319d" name="ga37f22e463cc06b4e381aa18659e6319d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga37f22e463cc06b4e381aa18659e6319d">&#9670;&#160;</a></span>rad_vel2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double rad_vel2 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structobject.html">object</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_emit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>vel_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_det</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>vel_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>d_obs_geo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>d_obs_sun</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>d_src_sun</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Predicts the radial velocity of the observed object as it would be measured by spectroscopic means. </p>
<p>This is a modified version of the original NOVAS C 3.1 <a class="el" href="#gafca24d914664bb60d20fb428177f329a" title="Predicts the radial velocity of the observed object as it would be measured by spectroscopic means.">rad_vel()</a>, to account for the slightly different directions in which light is emitted vs in which it is detected, e.g. when it is gravitationally deflected.</p>
<p>Radial velocity is defined here as a spectroscopic measure, defined by the relation:</p>
<p>&lambda;<sub>obs</sub> / &lambda;<sub>rest</sub> = (1 + <em>z</em>) = sqrt((1 + &beta;) / (1 - &beta;)),</p>
<p>where &beta; = <em>v</em><sub>rad</sub> / <em>c</em>.</p>
<p>For the major planets (and Sun and Moon), it includes gravitational corrections for light originating at the surface and observed from near Earth or else from a large distance away. For other solar system bodies, it applies to a fictitious emitter at the center of the observed object, assumed massless (no gravitational red shift). The corrections do not in general apply to reflected light. For stars, it includes all effects, such as gravitational redshift, contained in the catalog barycentric radial velocity measure, a scalar derived from spectroscopy. Nearby stars with a known kinematic velocity vector (obtained independently of spectroscopy) can be treated like solar system objects.</p>
<p>Gravitational blueshift corrections for the Solar and Earth potential for observers are included. However, the result does not include a blueshift correction for observers (e.g. spacecraft) orbiting other major Solar-system bodies. You may adjust the amount of gravitational redshift correction applied to the radial velocity via <code><a class="el" href="#gaf56088995d42a0673e03bca1f3891544" title="Applies an incremental redshift correction to a radial velocity.">redshift_vrad()</a></code>, <code><a class="el" href="#gaea89203030ca831260dec18f83081d23" title="Undoes an incremental redshift correction that was applied to radial velocity.">unredshift_vrad()</a></code> and <code><a class="el" href="#ga3ce6b306bc183387d0aaac97abbd82e8" title="Returns the gravitational redshift (z) for light emitted near a massive spherical body at some distan...">grav_redshift()</a></code> if necessary.</p>
<p>The input velocities are barycentric, expressed with respect to the ICRS axes. <code>vel_src</code> and <code>vel_obs</code> are kinematic velocities - derived from geometry or dynamics, not spectroscopy.</p>
<p>If the object is outside the solar system, the algorithm used will be consistent with the IAU definition of stellar radial velocity, specifically, the barycentric radial velocity measure, which is derived from spectroscopy. In that case, the vector 'vel_src' can be very approximate &ndash; or, for distant stars or galaxies, zero &ndash; as it will be used only for a small geometric and relativistic (time dilation) correction, including the proper motion.</p>
<p>Any of the distances (last three input arguments) can be set to a negative value if the corresponding general relativistic gravitational potential term is not to be evaluated. These terms generally are important only at the meter/second level. If <code>d_obs_geo</code> and <code>d_obs_sun</code> are both zero, an average value will be used for the relativistic term for the observer, appropriate for an observer on the surface of the Earth. <code>d_src_sun</code>, if given, is used only for solar system objects.</p>
<p>NOTES: </p><ol>
<li>
This function is called by <code><a class="el" href="group__apparent.html#gac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a></code> and <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c" title="Computes the apparent direction of a celestial object at a specified time and in a specified coordina...">place()</a></code> to calculate radial velocities along with the apparent position of the source. </li>
<li>
For major planets (and Sun and Moon), the radial velocity includes gravitational redshift corrections for light originating at the surface, assuming it's observed from near Earth or else from a large distance away. </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Lindegren &amp; Dravins (2003), Astronomy &amp; Astrophysics 401, 1185-1201. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source</td><td>Celestial object observed </td></tr>
    <tr><td class="paramname">pos_emit</td><td>[AU|*] position vector of object with respect to observer in the direction that light was emitted from the source. For solar system sources it should be corrected for light-time. For non-solar-system objects, the position vector defines a direction only, with arbitrary magnitude. </td></tr>
    <tr><td class="paramname">vel_src</td><td>[AU/day] Velocity vector of object with respect to solar system barycenter. </td></tr>
    <tr><td class="paramname">pos_det</td><td>[AU|*] apparent position vector of source, as seen by the observer. It may be the same vector as <code>pos_emit</code>, in which case the routine behaves like the original NOVAS_C <a class="el" href="#gafca24d914664bb60d20fb428177f329a" title="Predicts the radial velocity of the observed object as it would be measured by spectroscopic means.">rad_vel()</a>. </td></tr>
    <tr><td class="paramname">vel_obs</td><td>[AU/day] Velocity vector of observer with respect to solar system barycenter. </td></tr>
    <tr><td class="paramname">d_obs_geo</td><td>[AU] Distance from observer to geocenter, or &lt;=0.0 if gravitational blueshifting due to Earth potential around observer can be ignored. </td></tr>
    <tr><td class="paramname">d_obs_sun</td><td>[AU] Distance from observer to Sun, or &lt;=0.0 if gravitational bluehifting due to Solar potential around observer can be ignored. </td></tr>
    <tr><td class="paramname">d_src_sun</td><td>[AU] Distance from object to Sun, or &lt;=0.0 if gravitational redshifting due to Solar potential around source can be ignored. Additionally, a value &lt;0 will also skip corrections for light originating at the surface of the observed major solar-system body. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[km/s] The spectroscopic radial velocity measure from the observer's point of view, or NAN if there was an error (errno will be set to EINVAL if any of the arguments are NULL, or to some other value to indicate the type of error).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gafca24d914664bb60d20fb428177f329a" title="Predicts the radial velocity of the observed object as it would be measured by spectroscopic means.">rad_vel()</a> </dd>
<dd>
<a class="el" href="group__apparent.html#gac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a>, <a class="el" href="#gaa54cd00024b294d38fa29433c017c65f" title="Converts a radial recession velocity to a redshift value (z = Δλ / λrest).">novas_v2z()</a> </dd></dl>

<p class="reference">References <a class="el" href="structcat__entry.html#ac4ae7989694321b540abb75c30eec690">cat_entry::dec</a>, <a class="el" href="group__source.html#gga1eecb357eeea0de4759e9c8d55af238fa4f9ab9cec85498c41f90c33794d032e5">NOVAS_CATALOG_OBJECT</a>, <a class="el" href="group__observer.html#ga139f16e134bf6119b6e04c8272c85668">NOVAS_EARTH_RADIUS</a>, <a class="el" href="group__source.html#gga1eecb357eeea0de4759e9c8d55af238fa58f22833170aee0959154d3a7be6c269">NOVAS_EPHEM_OBJECT</a>, <a class="el" href="group__source.html#ga7822b81ad3f75b448f446ed4da774e75">NOVAS_KMS</a>, <a class="el" href="group__source.html#gga1eecb357eeea0de4759e9c8d55af238fa17562d2cd1b0b56d59d31f6ca51c759a">NOVAS_ORBITAL_OBJECT</a>, <a class="el" href="group__source.html#gga1eecb357eeea0de4759e9c8d55af238fad1eeaddaa96b028742a8ba424e311aa8">NOVAS_PLANET</a>, <a class="el" href="solarsystem_8h.html#a0ae90838b446c7d4c1d3386ec8857410">NOVAS_PLANET_GRAV_Z_INIT</a>, <a class="el" href="novas_8h.html#a1853540eae9f8699b6aaff9c0b518e08">NOVAS_PLANETS</a>, <a class="el" href="novas_8h.html#ae548ecdfc646914084936acb32e9c993">NOVAS_SOLAR_RADIUS</a>, <a class="el" href="util_8c.html#a0f41cefb8c872973b07e936b5026d143">novas_vlen()</a>, <a class="el" href="#ga63621cea3b4985c1bfcc4514a7aa3fb1">novas_z2v()</a>, <a class="el" href="structcat__entry.html#a18f7f3626661dbf57ce9eaec51840eb8">cat_entry::parallax</a>, <a class="el" href="structcat__entry.html#a713a0c71a86d92fa6892fdb2cb7c9422">cat_entry::ra</a>, and <a class="el" href="structcat__entry.html#aa2b5e5ca3a5df1765b49a6c6b110a36a">cat_entry::radialvelocity</a>.</p>

</div>
</div>
<a id="gaf56088995d42a0673e03bca1f3891544" name="gaf56088995d42a0673e03bca1f3891544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf56088995d42a0673e03bca1f3891544">&#9670;&#160;</a></span>redshift_vrad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double redshift_vrad </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>vrad</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies an incremental redshift correction to a radial velocity. </p>
<p>For example, you may use this function to correct a radial velocity calculated by <code><a class="el" href="#gafca24d914664bb60d20fb428177f329a" title="Predicts the radial velocity of the observed object as it would be measured by spectroscopic means.">rad_vel()</a></code> or <code><a class="el" href="#ga37f22e463cc06b4e381aa18659e6319d" title="Predicts the radial velocity of the observed object as it would be measured by spectroscopic means.">rad_vel2()</a></code> for a Solar-system body to account for the gravitational redshift for light originating at a specific distance away from the body. For the Sun, you may want to undo the redshift correction applied for the photosphere using <code><a class="el" href="#gaea89203030ca831260dec18f83081d23" title="Undoes an incremental redshift correction that was applied to radial velocity.">unredshift_vrad()</a></code> first.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vrad</td><td>[km/s] Radial velocity </td></tr>
    <tr><td class="paramname">z</td><td>Redshift correction to apply </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[km/s] The redshift corrected radial velocity or NAN if the redshift value is invalid (errno will be set to EINVAL).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.2 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaea89203030ca831260dec18f83081d23" title="Undoes an incremental redshift correction that was applied to radial velocity.">unredshift_vrad()</a>, <a class="el" href="#ga3ce6b306bc183387d0aaac97abbd82e8" title="Returns the gravitational redshift (z) for light emitted near a massive spherical body at some distan...">grav_redshift()</a>, <a class="el" href="#ga493ab751eee5804db77157c37e94e5c3" title="Compounds two redshift corrections, e.g.">novas_z_add()</a> </dd></dl>

<p class="reference">References <a class="el" href="#gaa54cd00024b294d38fa29433c017c65f">novas_v2z()</a>, and <a class="el" href="#ga63621cea3b4985c1bfcc4514a7aa3fb1">novas_z2v()</a>.</p>

</div>
</div>
<a id="gaea89203030ca831260dec18f83081d23" name="gaea89203030ca831260dec18f83081d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaea89203030ca831260dec18f83081d23">&#9670;&#160;</a></span>unredshift_vrad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double unredshift_vrad </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>vrad</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Undoes an incremental redshift correction that was applied to radial velocity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vrad</td><td>[km/s] Radial velocity </td></tr>
    <tr><td class="paramname">z</td><td>Redshift correction to apply </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[km/s] The radial velocity without the redshift correction or NAN if the redshift value is invalid. (errno will be set to EINVAL)</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.2 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaf56088995d42a0673e03bca1f3891544" title="Applies an incremental redshift correction to a radial velocity.">redshift_vrad()</a>, <a class="el" href="#ga3ce6b306bc183387d0aaac97abbd82e8" title="Returns the gravitational redshift (z) for light emitted near a massive spherical body at some distan...">grav_redshift()</a> </dd></dl>

<p class="reference">References <a class="el" href="#gaa54cd00024b294d38fa29433c017c65f">novas_v2z()</a>, and <a class="el" href="#ga63621cea3b4985c1bfcc4514a7aa3fb1">novas_z2v()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
