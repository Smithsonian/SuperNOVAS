<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuperNOVAS: /github/workspace/src/grav.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('grav_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">grav.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a48f90ac20950507fad9b880a7f7f2383" id="r_a48f90ac20950507fad9b880a7f7f2383"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48f90ac20950507fad9b880a7f7f2383">grav_def</a> (double jd_tdb, enum <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3">novas_observer_place</a> unused, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const double *pos_src, const double *pos_obs, double *out)</td></tr>
<tr class="memdesc:a48f90ac20950507fad9b880a7f7f2383"><td class="mdescLeft">&#160;</td><td class="mdescRight">(<em>primarily for internal use</em>) Computes the total gravitational deflection of light for the observed object due to the major gravitating bodies in the solar system.  <br /></td></tr>
<tr class="separator:a48f90ac20950507fad9b880a7f7f2383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae36bc31e1dad8a68f94f7a6414f0519f" id="r_ae36bc31e1dad8a68f94f7a6414f0519f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae36bc31e1dad8a68f94f7a6414f0519f">grav_planets</a> (const double *pos_src, const double *pos_obs, const <a class="el" href="structnovas__planet__bundle.html">novas_planet_bundle</a> *restrict planets, double *out)</td></tr>
<tr class="memdesc:ae36bc31e1dad8a68f94f7a6414f0519f"><td class="mdescLeft">&#160;</td><td class="mdescRight">(<em>primarily for internal use</em>) Computes the total gravitational deflection of light for the observed object due to the specified gravitating bodies in the solar system.  <br /></td></tr>
<tr class="separator:ae36bc31e1dad8a68f94f7a6414f0519f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ce6b306bc183387d0aaac97abbd82e8" id="r_a3ce6b306bc183387d0aaac97abbd82e8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ce6b306bc183387d0aaac97abbd82e8">grav_redshift</a> (double M_kg, double r_m)</td></tr>
<tr class="memdesc:a3ce6b306bc183387d0aaac97abbd82e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the gravitational redshift (<em>z</em>) for light emitted near a massive spherical body at some distance from its center, and observed at some very large (infinite) distance away.  <br /></td></tr>
<tr class="separator:a3ce6b306bc183387d0aaac97abbd82e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaae33249717912663bbb00be4fa4e6c3" id="r_aaae33249717912663bbb00be4fa4e6c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaae33249717912663bbb00be4fa4e6c3">grav_undef</a> (double jd_tdb, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const double *pos_app, const double *pos_obs, double *out)</td></tr>
<tr class="memdesc:aaae33249717912663bbb00be4fa4e6c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">(<em>primarily for internal use</em>) Computes the gravitationally undeflected position of an observed source position due to the major gravitating bodies in the solar system.  <br /></td></tr>
<tr class="separator:aaae33249717912663bbb00be4fa4e6c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b107a24b9fadc79cc5df8c6f5505d16" id="r_a1b107a24b9fadc79cc5df8c6f5505d16"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b107a24b9fadc79cc5df8c6f5505d16">grav_undo_planets</a> (const double *pos_app, const double *pos_obs, const <a class="el" href="structnovas__planet__bundle.html">novas_planet_bundle</a> *restrict planets, double *out)</td></tr>
<tr class="memdesc:a1b107a24b9fadc79cc5df8c6f5505d16"><td class="mdescLeft">&#160;</td><td class="mdescRight">(<em>primarily for internal use</em>) Computes the gravitationally undeflected position of an observed source position due to the specified Solar-system bodies.  <br /></td></tr>
<tr class="separator:a1b107a24b9fadc79cc5df8c6f5505d16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08a008572e2746a70bec19739b5fb7e6" id="r_a08a008572e2746a70bec19739b5fb7e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08a008572e2746a70bec19739b5fb7e6">grav_vec</a> (const double *pos_src, const double *pos_obs, const double *pos_body, double rmass, double *out)</td></tr>
<tr class="memdesc:a08a008572e2746a70bec19739b5fb7e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">(<em>primarily for internal use</em>) Corrects position vector for the deflection of light in the gravitational field of anarbitrary body.  <br /></td></tr>
<tr class="separator:a08a008572e2746a70bec19739b5fb7e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a18647d39520d1a15a137661f698cb12a" id="r_a18647d39520d1a15a137661f698cb12a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a18647d39520d1a15a137661f698cb12a">grav_bodies_full_accuracy</a> = <a class="el" href="novas_8h.html#a4cb74da554b236c835302480688cfaac">DEFAULT_GRAV_BODIES_FULL_ACCURACY</a></td></tr>
<tr class="memdesc:a18647d39520d1a15a137661f698cb12a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current set of gravitating bodies to use for deflection calculations in full accuracy mode.  <br /></td></tr>
<tr class="separator:a18647d39520d1a15a137661f698cb12a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a4df8961a0cd05f89aca478d2dcd24" id="r_a03a4df8961a0cd05f89aca478d2dcd24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03a4df8961a0cd05f89aca478d2dcd24">grav_bodies_reduced_accuracy</a> = <a class="el" href="novas_8h.html#aec64bf67d5a03b2b4fb2583e5918f1de">DEFAULT_GRAV_BODIES_REDUCED_ACCURACY</a></td></tr>
<tr class="memdesc:a03a4df8961a0cd05f89aca478d2dcd24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current set of gravitating bodies to use for deflection calculations in reduced accuracy mode.  <br /></td></tr>
<tr class="separator:a03a4df8961a0cd05f89aca478d2dcd24"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>Created on Mar 6, 2025 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs and G. Kaplan</dd></dl>
<p>Various functions to deal with gravitational effects of the major Solar-system bodies on the astrometry. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a48f90ac20950507fad9b880a7f7f2383" name="a48f90ac20950507fad9b880a7f7f2383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f90ac20950507fad9b880a7f7f2383">&#9670;&#160;</a></span>grav_def()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short grav_def </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tdb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a6140c39d1526b137f827e2091ecc36b3">novas_observer_place</a></td>          <td class="paramname"><span class="paramname"><em>unused</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(<em>primarily for internal use</em>) Computes the total gravitational deflection of light for the observed object due to the major gravitating bodies in the solar system. </p>
<p>This function valid for an observed body within the solar system as well as for a star.</p>
<p>If 'accuracy' is NOVAS_FULL_ACCURACY (0), the deflections due to the Sun, Jupiter, Saturn, and Earth are calculated. Otherwise, only the deflection due to the Sun is calculated. In either case, deflection for a given body is ignored if the observer is within ~1500 km of the center of the gravitating body.</p>
<p>The number of bodies used at full and reduced accuracy can be set by changing the <code>grav_bodies_reduced_accuracy</code>, and <code>grav_bodies_full_accuracy</code> lobal variables.</p>
<p>NOTES: </p><ol>
<li>
This function is called by <code><a class="el" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a></code> <code><a class="el" href="frames_8c.html#ab7db8026c598e8e126a4725ac3b388bf" title="Converts an observed apparent sky position of a source to an ICRS geometric position,...">novas_app_to_geom()</a>,</code><a class="el" href="frames_8c.html#a4817703c9357f702a27812584c91f87c" title="Converts an geometric position in ICRS to an apparent position on sky, by applying appropriate correc...">novas_geom_to_app()</a><code> and</code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c" title="Computes the apparent direction of a celestial object at a specified time and in a specified coordina...">place()</a>` to calculate gravitational deflections as appropriate for positioning sources precisely. The gravitational deflection due to planets requires a planet calculator function to be configured, e.g. via <a class="el" href="plugin_8c.html#a418f45a11ce7f92ba0ef817558415640" title="Set a custom function to use for high precision (see NOVAS_FULL_ACCURACY) ephemeris calculations inst...">set_planet_provider_hp()</a>.  </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Klioner, S. (2003), Astronomical Journal 125, 1580-1597, Section 6. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">unused</td><td>The type of observer frame (no longer used) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1). In full accuracy mode, it will calculate the deflection due to the Sun, Jupiter, Saturn and Earth. In reduced accuracy mode, only the deflection due to the Sun is calculated. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_src</td><td>[AU] Position 3-vector of observed object, with respect to origin at observer (or the geocenter), referred to ICRS axes, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_obs</td><td>[AU] Position 3-vector of observer (or the geocenter), with respect to origin at solar system barycenter, referred to ICRS axes, components in AU. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>[AU] Position vector of observed object, with respect to origin at observer (or the geocenter), referred to ICRS axes, corrected for gravitational deflection, components in AU. It can be the same vector as the input, but not the same as pos_obs. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if any of the pointer arguments is NULL or if the output vector is the same as pos_obs, or the error from <a class="el" href="observer_8c.html#a07490a134a685fe0842b2b4816559292" title="Calculates the positions and velocities for the Solar-system bodies, e.g.">obs_planets()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#aaae33249717912663bbb00be4fa4e6c3" title="(primarily for internal use) Computes the gravitationally undeflected position of an observed source ...">grav_undef()</a> </dd>
<dd>
<a class="el" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a>, <a class="el" href="frames_8c.html#a4817703c9357f702a27812584c91f87c" title="Converts an geometric position in ICRS to an apparent position on sky, by applying appropriate correc...">novas_geom_to_app()</a>, <a class="el" href="frames_8c.html#ab7db8026c598e8e126a4725ac3b388bf" title="Converts an observed apparent sky position of a source to an ICRS geometric position,...">novas_app_to_geom()</a>, <a class="el" href="plugin_8c.html#a418f45a11ce7f92ba0ef817558415640" title="Set a custom function to use for high precision (see NOVAS_FULL_ACCURACY) ephemeris calculations inst...">set_planet_provider_hp()</a>, <a class="el" href="#a18647d39520d1a15a137661f698cb12a" title="Current set of gravitating bodies to use for deflection calculations in full accuracy mode.">grav_bodies_full_accuracy</a>, <a class="el" href="#a03a4df8961a0cd05f89aca478d2dcd24" title="Current set of gravitating bodies to use for deflection calculations in reduced accuracy mode.">grav_bodies_reduced_accuracy</a> </dd></dl>

<p class="reference">References <a class="el" href="#a18647d39520d1a15a137661f698cb12a">grav_bodies_full_accuracy</a>, <a class="el" href="#a03a4df8961a0cd05f89aca478d2dcd24">grav_bodies_reduced_accuracy</a>, <a class="el" href="#ae36bc31e1dad8a68f94f7a6414f0519f">grav_planets()</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, and <a class="el" href="observer_8c.html#a07490a134a685fe0842b2b4816559292">obs_planets()</a>.</p>

</div>
</div>
<a id="ae36bc31e1dad8a68f94f7a6414f0519f" name="ae36bc31e1dad8a68f94f7a6414f0519f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae36bc31e1dad8a68f94f7a6414f0519f">&#9670;&#160;</a></span>grav_planets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grav_planets </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnovas__planet__bundle.html">novas_planet_bundle</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>planets</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(<em>primarily for internal use</em>) Computes the total gravitational deflection of light for the observed object due to the specified gravitating bodies in the solar system. </p>
<p>This function is valid for an observed body within the solar system as well as for a star.</p>
<p>NOTES: </p><ol>
<li>
The gravitational deflection due to planets requires a planet calculator function to be configured, e.g. via <a class="el" href="plugin_8c.html#a418f45a11ce7f92ba0ef817558415640" title="Set a custom function to use for high precision (see NOVAS_FULL_ACCURACY) ephemeris calculations inst...">set_planet_provider_hp()</a>. </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Klioner, S. (2003), Astronomical Journal 125, 1580-1597, Section 6. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">pos_src</td><td>[AU] Position 3-vector of observed object, with respect to origin at observer (or the geocenter), referred to ICRS axes, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_obs</td><td>[AU] Position 3-vector of observer (or the geocenter), with respect to origin at solar system barycenter, referred to ICRS axes, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">planets</td><td>Apparent planet data containing positions and velocities for the major gravitating bodies in the solar-system. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>[AU] Position vector of observed object, with respect to origin at observer (or the geocenter), referred to ICRS axes, corrected for gravitational deflection, components in AU. It can be the same vector as the input, but not the same as pos_obs. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if any of the pointer arguments is NULL or if the output vector is the same as pos_obs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a48f90ac20950507fad9b880a7f7f2383" title="(primarily for internal use) Computes the total gravitational deflection of light for the observed ob...">grav_def()</a>, <a class="el" href="#a1b107a24b9fadc79cc5df8c6f5505d16" title="(primarily for internal use) Computes the gravitationally undeflected position of an observed source ...">grav_undo_planets()</a> </dd>
<dd>
<a class="el" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a>, <a class="el" href="frames_8c.html#a4817703c9357f702a27812584c91f87c" title="Converts an geometric position in ICRS to an apparent position on sky, by applying appropriate correc...">novas_geom_to_app()</a>, <a class="el" href="observer_8c.html#a07490a134a685fe0842b2b4816559292" title="Calculates the positions and velocities for the Solar-system bodies, e.g.">obs_planets()</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>

<p class="reference">References <a class="el" href="util_8c.html#ad799864f637c483fb49491bde5a93e25">d_light()</a>, <a class="el" href="#a08a008572e2746a70bec19739b5fb7e6">grav_vec()</a>, <a class="el" href="novas_8h.html#a1853540eae9f8699b6aaff9c0b518e08">NOVAS_PLANETS</a>, <a class="el" href="novas_8h.html#a5ddc7a011476a8cffaec1866beaa0095">NOVAS_RMASS_INIT</a>, and <a class="el" href="util_8c.html#a0f41cefb8c872973b07e936b5026d143">novas_vlen()</a>.</p>

</div>
</div>
<a id="a3ce6b306bc183387d0aaac97abbd82e8" name="a3ce6b306bc183387d0aaac97abbd82e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ce6b306bc183387d0aaac97abbd82e8">&#9670;&#160;</a></span>grav_redshift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double grav_redshift </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>M_kg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>r_m</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the gravitational redshift (<em>z</em>) for light emitted near a massive spherical body at some distance from its center, and observed at some very large (infinite) distance away. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">M_kg</td><td>[kg] Mass of gravitating body that is contained inside the emitting radius. </td></tr>
    <tr><td class="paramname">r_m</td><td>[m] Radius at which light is emitted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The gravitational redshift (<em>z</em>) for an observer at very large (infinite) distance from the gravitating body.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="spectral_8c.html#af56088995d42a0673e03bca1f3891544" title="Applies an incremental redshift correction to a radial velocity.">redshift_vrad()</a>, <a class="el" href="spectral_8c.html#aea89203030ca831260dec18f83081d23" title="Undoes an incremental redshift correction that was applied to radial velocity.">unredshift_vrad()</a>, <a class="el" href="spectral_8c.html#a493ab751eee5804db77157c37e94e5c3" title="Compounds two redshift corrections, e.g.">novas_z_add()</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.2 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>

</div>
</div>
<a id="aaae33249717912663bbb00be4fa4e6c3" name="aaae33249717912663bbb00be4fa4e6c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaae33249717912663bbb00be4fa4e6c3">&#9670;&#160;</a></span>grav_undef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grav_undef </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tdb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_app</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(<em>primarily for internal use</em>) Computes the gravitationally undeflected position of an observed source position due to the major gravitating bodies in the solar system. </p>
<p>This function is valid for an observed body within the solar system as well as for a star.</p>
<p>If 'accuracy' is set to zero (full accuracy), three bodies (Sun, Jupiter, and Saturn) are used in the calculation. If the reduced-accuracy option is set, only the Sun is used in the calculation. In both cases, if the observer is not at the geocenter, the deflection due to the Earth is included.</p>
<p>he number of bodies used at full and reduced accuracy can be set by changing the <code>grav_bodies_reduced_accuracy</code>, and <code>grav_bodies_full_accuracy</code> lobal variables.</p>
<p>REFERENCES: </p><ol>
<li>
Klioner, S. (2003), Astronomical Journal 125, 1580-1597, Section 6. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_app</td><td>[AU] Apparent position 3-vector of observed object, with respect to origin at observer (or the geocenter), referred to ICRS axes, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_obs</td><td>[AU] Position 3-vector of observer (or the geocenter), with respect to origin at solar system barycenter, referred to ICRS axes, components in AU. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>[AU] Nominal position vector of observed object, with respect to origin at observer (or the geocenter), referred to ICRS axes, without gravitational deflection, components in AU. It can be the same vector as the input, but not the same as pos_obs. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if any of the pointer arguments is NULL (errno = EINVAL) or if the result did not converge (errno = ECANCELED), or else an error from <a class="el" href="observer_8c.html#a07490a134a685fe0842b2b4816559292" title="Calculates the positions and velocities for the Solar-system bodies, e.g.">obs_planets()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a48f90ac20950507fad9b880a7f7f2383" title="(primarily for internal use) Computes the total gravitational deflection of light for the observed ob...">grav_def()</a> </dd>
<dd>
<a class="el" href="frames_8c.html#ab7db8026c598e8e126a4725ac3b388bf" title="Converts an observed apparent sky position of a source to an ICRS geometric position,...">novas_app_to_geom()</a>, <a class="el" href="plugin_8c.html#a418f45a11ce7f92ba0ef817558415640" title="Set a custom function to use for high precision (see NOVAS_FULL_ACCURACY) ephemeris calculations inst...">set_planet_provider_hp()</a>, <a class="el" href="#a18647d39520d1a15a137661f698cb12a" title="Current set of gravitating bodies to use for deflection calculations in full accuracy mode.">grav_bodies_full_accuracy</a>, <a class="el" href="#a03a4df8961a0cd05f89aca478d2dcd24" title="Current set of gravitating bodies to use for deflection calculations in reduced accuracy mode.">grav_bodies_reduced_accuracy</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>

<p class="reference">References <a class="el" href="#a18647d39520d1a15a137661f698cb12a">grav_bodies_full_accuracy</a>, <a class="el" href="#a03a4df8961a0cd05f89aca478d2dcd24">grav_bodies_reduced_accuracy</a>, <a class="el" href="#a1b107a24b9fadc79cc5df8c6f5505d16">grav_undo_planets()</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, and <a class="el" href="observer_8c.html#a07490a134a685fe0842b2b4816559292">obs_planets()</a>.</p>

</div>
</div>
<a id="a1b107a24b9fadc79cc5df8c6f5505d16" name="a1b107a24b9fadc79cc5df8c6f5505d16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b107a24b9fadc79cc5df8c6f5505d16">&#9670;&#160;</a></span>grav_undo_planets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grav_undo_planets </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_app</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnovas__planet__bundle.html">novas_planet_bundle</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>planets</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(<em>primarily for internal use</em>) Computes the gravitationally undeflected position of an observed source position due to the specified Solar-system bodies. </p>
<p>REFERENCES: </p><ol>
<li>
Klioner, S. (2003), Astronomical Journal 125, 1580-1597, Section 6. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">pos_app</td><td>[AU] Apparent position 3-vector of observed object, with respect to origin at observer (or the geocenter), referred to ICRS axes, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_obs</td><td>[AU] Position 3-vector of observer (or the geocenter), with respect to origin at solar system barycenter, referred to ICRS axes, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">planets</td><td>Apparent planet data containing positions and velocities for the major gravitating bodies in the solar-system. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>[AU] Nominal position vector of observed object, with respect to origin at observer (or the geocenter), referred to ICRS axes, without gravitational deflection, components in AU. It can be the same vector as the input, but not the same as pos_obs. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if any of the pointer arguments is NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ae36bc31e1dad8a68f94f7a6414f0519f" title="(primarily for internal use) Computes the total gravitational deflection of light for the observed ob...">grav_planets()</a>, <a class="el" href="#aaae33249717912663bbb00be4fa4e6c3" title="(primarily for internal use) Computes the gravitationally undeflected position of an observed source ...">grav_undef()</a> </dd>
<dd>
<a class="el" href="frames_8c.html#ab7db8026c598e8e126a4725ac3b388bf" title="Converts an observed apparent sky position of a source to an ICRS geometric position,...">novas_app_to_geom()</a>, <a class="el" href="observer_8c.html#a07490a134a685fe0842b2b4816559292" title="Calculates the positions and velocities for the Solar-system bodies, e.g.">obs_planets()</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>

<p class="reference">References <a class="el" href="#ae36bc31e1dad8a68f94f7a6414f0519f">grav_planets()</a>, <a class="el" href="util_8c.html#ad2b933ce2f58e8b04bbe76ffbff99eb0">novas_inv_max_iter</a>, and <a class="el" href="util_8c.html#a0f41cefb8c872973b07e936b5026d143">novas_vlen()</a>.</p>

</div>
</div>
<a id="a08a008572e2746a70bec19739b5fb7e6" name="a08a008572e2746a70bec19739b5fb7e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08a008572e2746a70bec19739b5fb7e6">&#9670;&#160;</a></span>grav_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grav_vec </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_body</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>rmass</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(<em>primarily for internal use</em>) Corrects position vector for the deflection of light in the gravitational field of anarbitrary body. </p>
<p>This function valid for an observed body within the solar system as well as for a star.</p>
<p>NOTES: </p><ol>
<li>
This function is called by <a class="el" href="#a48f90ac20950507fad9b880a7f7f2383" title="(primarily for internal use) Computes the total gravitational deflection of light for the observed ob...">grav_def()</a> to calculate appropriate gravitational deflections around the massive Solar-system objects.  </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Murray, C.A. (1981) Mon. Notices Royal Ast. Society 195, 639-648. </li>
<li>
See also formulae in Section B of the Astronomical Almanac, or </li>
<li>
Kaplan, G. et al. (1989) Astronomical Journal 97, 1197-1210, section iii f. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">pos_src</td><td>[AU] Position 3-vector of observed object, with respect to origin at observer (or the geocenter), components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_obs</td><td>[AU] Position vector of gravitating body, with respect to origin at solar system barycenter, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_body</td><td>[AU] Position 3-vector of gravitating body, with respect to origin at solar system barycenter, components in AU. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rmass</td><td>[1/Msun] Reciprocal mass of gravitating body in solar mass units, that is, Sun mass / body mass. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>[AU] Position 3-vector of observed object, with respect to origin at observer (or the geocenter), corrected for gravitational deflection, components in AU. It can the same vector as the input. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if any of the input vectors is NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a48f90ac20950507fad9b880a7f7f2383" title="(primarily for internal use) Computes the total gravitational deflection of light for the observed ob...">grav_def()</a> </dd></dl>

<p class="reference">References <a class="el" href="util_8c.html#a0f41cefb8c872973b07e936b5026d143">novas_vlen()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a18647d39520d1a15a137661f698cb12a" name="a18647d39520d1a15a137661f698cb12a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18647d39520d1a15a137661f698cb12a">&#9670;&#160;</a></span>grav_bodies_full_accuracy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grav_bodies_full_accuracy = <a class="el" href="novas_8h.html#a4cb74da554b236c835302480688cfaac">DEFAULT_GRAV_BODIES_FULL_ACCURACY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current set of gravitating bodies to use for deflection calculations in full accuracy mode. </p>
<p>Each bit signifies whether a given body is to be accounted for as a gravitating body that bends light, such as the bit <code>(1 &lt;&lt; NOVAS_JUPITER)</code> indicates whether or not Jupiter is considered as a deflecting body. You should also be sure that you provide ephemeris data for bodies that are designated for the deflection calculation.</p>
<dl class="section since"><dt>Since</dt><dd>1.1</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="novas_8h.html#a48f90ac20950507fad9b880a7f7f2383" title="(primarily for internal use) Computes the total gravitational deflection of light for the observed ob...">grav_def()</a>, <a class="el" href="novas_8h.html#ae36bc31e1dad8a68f94f7a6414f0519f" title="(primarily for internal use) Computes the total gravitational deflection of light for the observed ob...">grav_planets()</a>, <a class="el" href="novas_8h.html#a4cb74da554b236c835302480688cfaac" title="Default set of gravitating bodies to use for deflection calculations in full accuracy mode.">DEFAULT_GRAV_BODIES_FULL_ACCURACY</a> </dd>
<dd>
set_ephem_provider_hp() </dd></dl>

</div>
</div>
<a id="a03a4df8961a0cd05f89aca478d2dcd24" name="a03a4df8961a0cd05f89aca478d2dcd24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03a4df8961a0cd05f89aca478d2dcd24">&#9670;&#160;</a></span>grav_bodies_reduced_accuracy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grav_bodies_reduced_accuracy = <a class="el" href="novas_8h.html#aec64bf67d5a03b2b4fb2583e5918f1de">DEFAULT_GRAV_BODIES_REDUCED_ACCURACY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current set of gravitating bodies to use for deflection calculations in reduced accuracy mode. </p>
<p>Each bit signifies whether a given body is to be accounted for as a gravitating body that bends light, such as the bit <code>(1 &lt;&lt; NOVAS_JUPITER)</code> indicates whether or not Jupiter is considered as a deflecting body. You should also be sure that you provide ephemeris data for bodies that are designated for the deflection calculation.</p>
<dl class="section since"><dt>Since</dt><dd>1.1</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="novas_8h.html#a48f90ac20950507fad9b880a7f7f2383" title="(primarily for internal use) Computes the total gravitational deflection of light for the observed ob...">grav_def()</a>, <a class="el" href="novas_8h.html#ae36bc31e1dad8a68f94f7a6414f0519f" title="(primarily for internal use) Computes the total gravitational deflection of light for the observed ob...">grav_planets()</a>, <a class="el" href="novas_8h.html#aec64bf67d5a03b2b4fb2583e5918f1de" title="Default set of gravitating bodies to use for deflection calculations in reduced accuracy mode.">DEFAULT_GRAV_BODIES_REDUCED_ACCURACY</a> </dd>
<dd>
<a class="el" href="plugin_8c.html#a6097083c438a8d1872c2e00a66360030" title="Sets the function to use for obtaining position / velocity information for minor planets,...">set_ephem_provider()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="grav_8c.html">grav.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
