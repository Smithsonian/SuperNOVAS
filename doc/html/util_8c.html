<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuperNOVAS: /github/workspace/src/util.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('util_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">util.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad799864f637c483fb49491bde5a93e25" id="r_ad799864f637c483fb49491bde5a93e25"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad799864f637c483fb49491bde5a93e25">d_light</a> (const double *pos_src, const double *pos_body)</td></tr>
<tr class="memdesc:ad799864f637c483fb49491bde5a93e25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the difference in light-time, for a star, between the barycenter of the solar system and the observer (or the geocenter) (<em>Usage A</em>).  <br /></td></tr>
<tr class="separator:ad799864f637c483fb49491bde5a93e25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab45a580efb78b53bcb4a09d40868e4d" id="r_aab45a580efb78b53bcb4a09d40868e4d"><td class="memItemLeft" align="right" valign="top">PROTECTED void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab45a580efb78b53bcb4a09d40868e4d">novas_debug</a> (enum <a class="el" href="novas_8h.html#a9d8d2a1f5c06b488e4c817bc9877e3ba">novas_debug_mode</a> mode)</td></tr>
<tr class="memdesc:aab45a580efb78b53bcb4a09d40868e4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables or disables reporting errors and traces to the standard error stream.  <br /></td></tr>
<tr class="separator:aab45a580efb78b53bcb4a09d40868e4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f7e06b2fa5b3145b37aec4f9c2d1602" id="r_a4f7e06b2fa5b3145b37aec4f9c2d1602"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f7e06b2fa5b3145b37aec4f9c2d1602">novas_equ_sep</a> (double ra1, double dec1, double ra2, double dec2)</td></tr>
<tr class="memdesc:a4f7e06b2fa5b3145b37aec4f9c2d1602"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the angular separation of two equatorial locations on a sphere.  <br /></td></tr>
<tr class="separator:a4f7e06b2fa5b3145b37aec4f9c2d1602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29cad12337acfce5f1e370320dcefb79" id="r_a29cad12337acfce5f1e370320dcefb79"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="novas_8h.html#a9d8d2a1f5c06b488e4c817bc9877e3ba">novas_debug_mode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a29cad12337acfce5f1e370320dcefb79">novas_get_debug_mode</a> ()</td></tr>
<tr class="memdesc:a29cad12337acfce5f1e370320dcefb79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current, thread-local, mode for reporting errors encountered (and traces).  <br /></td></tr>
<tr class="separator:a29cad12337acfce5f1e370320dcefb79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85334614a0f399e0d3cbde68075d0766" id="r_a85334614a0f399e0d3cbde68075d0766"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85334614a0f399e0d3cbde68075d0766">novas_norm_ang</a> (double angle)</td></tr>
<tr class="memdesc:a85334614a0f399e0d3cbde68075d0766"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the normalized angle in the [0:2&pi;) range.  <br /></td></tr>
<tr class="separator:a85334614a0f399e0d3cbde68075d0766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f33de2b26a19a5e20827e9e918b3375" id="r_a9f33de2b26a19a5e20827e9e918b3375"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f33de2b26a19a5e20827e9e918b3375">novas_sep</a> (double lon1, double lat1, double lon2, double lat2)</td></tr>
<tr class="memdesc:a9f33de2b26a19a5e20827e9e918b3375"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the angular separation of two locations on a sphere.  <br /></td></tr>
<tr class="separator:a9f33de2b26a19a5e20827e9e918b3375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f41cefb8c872973b07e936b5026d143" id="r_a0f41cefb8c872973b07e936b5026d143"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f41cefb8c872973b07e936b5026d143">novas_vlen</a> (const double *restrict v)</td></tr>
<tr class="memdesc:a0f41cefb8c872973b07e936b5026d143"><td class="mdescLeft">&#160;</td><td class="mdescRight">(<em>for internal use only</em>) Calculates the length of a 3-vector  <br /></td></tr>
<tr class="separator:a0f41cefb8c872973b07e936b5026d143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae104afd1bc638def9bdbce1801e5054a" id="r_ae104afd1bc638def9bdbce1801e5054a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae104afd1bc638def9bdbce1801e5054a">radec2vector</a> (double ra, double dec, double dist, double *restrict pos)</td></tr>
<tr class="memdesc:ae104afd1bc638def9bdbce1801e5054a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts equatorial spherical coordinates to a vector (equatorial rectangular coordinates).  <br /></td></tr>
<tr class="separator:ae104afd1bc638def9bdbce1801e5054a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4090e519d7ce7ab1fcdb24b10126eb4" id="r_af4090e519d7ce7ab1fcdb24b10126eb4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4090e519d7ce7ab1fcdb24b10126eb4">spin</a> (double angle, const double *in, double *out)</td></tr>
<tr class="memdesc:af4090e519d7ce7ab1fcdb24b10126eb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms a vector from one coordinate system to another with same origin and axes rotated about the z-axis.  <br /></td></tr>
<tr class="separator:af4090e519d7ce7ab1fcdb24b10126eb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84f672dc1c37e3af374198f29cbcfba9" id="r_a84f672dc1c37e3af374198f29cbcfba9"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84f672dc1c37e3af374198f29cbcfba9">vector2radec</a> (const double *restrict pos, double *restrict ra, double *restrict dec)</td></tr>
<tr class="memdesc:a84f672dc1c37e3af374198f29cbcfba9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an vector in equatorial rectangular coordinates to equatorial spherical coordinates.  <br /></td></tr>
<tr class="separator:a84f672dc1c37e3af374198f29cbcfba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad2b933ce2f58e8b04bbe76ffbff99eb0" id="r_ad2b933ce2f58e8b04bbe76ffbff99eb0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2b933ce2f58e8b04bbe76ffbff99eb0">novas_inv_max_iter</a> = 100</td></tr>
<tr class="memdesc:ad2b933ce2f58e8b04bbe76ffbff99eb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of iterations for convergent inverse calculations.  <br /></td></tr>
<tr class="separator:ad2b933ce2f58e8b04bbe76ffbff99eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>Created on Mar 6, 2025 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>G. Kaplan and A. Kovacs</dd></dl>
<p>Various commonly used routines used throughout the SuperNOVAS library. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad799864f637c483fb49491bde5a93e25" name="ad799864f637c483fb49491bde5a93e25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad799864f637c483fb49491bde5a93e25">&#9670;&#160;</a></span>d_light()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double d_light </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_body</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the difference in light-time, for a star, between the barycenter of the solar system and the observer (or the geocenter) (<em>Usage A</em>). </p>
<p>Alternatively (<em>Usage B</em>), this function returns the light-time from the observer (or the geocenter) to a point on a light ray that is closest to a specific solar system body. For this purpose, 'pos_src' is the position vector toward observed object, with respect to origin at observer (or the geocenter); 'pos_body' is the position vector of solar system body, with respect to origin at observer (or the geocenter), components in AU; and the returned value is the light time to point on line defined by 'pos' that is closest to solar system body (positive if light passes body before hitting observer, i.e., if 'pos_body' is within 90 degrees of 'pos_src').</p>
<p>NOTES: </p><ol>
<li>
This function is called by <code><a class="el" href="frames_8c.html#ac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a></code>, <a class="el" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a>, or <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c" title="Computes the apparent direction of a celestial object at a specified time and in a specified coordina...">place()</a></code> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos_src</td><td>Position vector towards observed object, with respect to the SSB (<em>Usage A</em>), or relative to the observer / geocenter (<em>Usage B</em>). </td></tr>
    <tr><td class="paramname">pos_body</td><td>[AU] Position of observer relative to SSB (<em>Usage A</em>), or position of intermediate solar-system body with respect to the observer / geocenter (<em>Usage B</em>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[day] Difference in light time to observer, either relative to SSB (<em>Usage A</em>) or relative intermediate solar-system body (<em>Usage B</em>); or else NAN if either of the input arguments is NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="frames_8c.html#ac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a>, <a class="el" href="frames_8c.html#ac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a> </dd></dl>

<p class="reference">References <a class="el" href="#a0f41cefb8c872973b07e936b5026d143">novas_vlen()</a>.</p>

</div>
</div>
<a id="aab45a580efb78b53bcb4a09d40868e4d" name="aab45a580efb78b53bcb4a09d40868e4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab45a580efb78b53bcb4a09d40868e4d">&#9670;&#160;</a></span>novas_debug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PROTECTED void novas_debug </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a9d8d2a1f5c06b488e4c817bc9877e3ba">novas_debug_mode</a></td>          <td class="paramname"><span class="paramname"><em>mode</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables or disables reporting errors and traces to the standard error stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td>NOVAS_DEBUG_OFF (0; or &lt;0), NOVAS_DEBUG_ON (1), or NOVAS_DEBUG_EXTRA (2; or &gt;2).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a29cad12337acfce5f1e370320dcefb79" title="Returns the current, thread-local, mode for reporting errors encountered (and traces).">novas_get_debug_mode()</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a9d8d2a1f5c06b488e4c817bc9877e3baaa03b175422e9603e87ab87f93a45c07c">NOVAS_DEBUG_EXTRA</a>.</p>

</div>
</div>
<a id="a4f7e06b2fa5b3145b37aec4f9c2d1602" name="a4f7e06b2fa5b3145b37aec4f9c2d1602"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f7e06b2fa5b3145b37aec4f9c2d1602">&#9670;&#160;</a></span>novas_equ_sep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_equ_sep </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ra1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ra2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec2</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the angular separation of two equatorial locations on a sphere. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ra1</td><td>[h] right ascension of first location </td></tr>
    <tr><td class="paramname">dec1</td><td>[deg] declination of first location </td></tr>
    <tr><td class="paramname">ra2</td><td>[h] right ascension of second location </td></tr>
    <tr><td class="paramname">dec2</td><td>[deg] declination of second location </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] the angular separation of the two locations.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a9f33de2b26a19a5e20827e9e918b3375" title="Returns the angular separation of two locations on a sphere.">novas_sep()</a>, <a class="el" href="frames_8c.html#a2d1ef3bc6d99aa473511e45c6e0481e9" title="Returns the apparent angular distance of a source from the Sun from the observer&#39;s point of view.">novas_sun_angle()</a>, <a class="el" href="frames_8c.html#a121940d7f0ef41297d28fab8e6df5998" title="Returns the apparent angular distance of a source from the Moon from the observer&#39;s point of view.">novas_moon_angle()</a> </dd></dl>

<p class="reference">References <a class="el" href="#a9f33de2b26a19a5e20827e9e918b3375">novas_sep()</a>.</p>

</div>
</div>
<a id="a29cad12337acfce5f1e370320dcefb79" name="a29cad12337acfce5f1e370320dcefb79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29cad12337acfce5f1e370320dcefb79">&#9670;&#160;</a></span>novas_get_debug_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="novas_8h.html#a9d8d2a1f5c06b488e4c817bc9877e3ba">novas_debug_mode</a> novas_get_debug_mode </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the current, thread-local, mode for reporting errors encountered (and traces). </p>
<dl class="section return"><dt>Returns</dt><dd>The current debug mode in the calling thread.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#aab45a580efb78b53bcb4a09d40868e4d" title="Enables or disables reporting errors and traces to the standard error stream.">novas_debug()</a> </dd></dl>

</div>
</div>
<a id="a85334614a0f399e0d3cbde68075d0766" name="a85334614a0f399e0d3cbde68075d0766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85334614a0f399e0d3cbde68075d0766">&#9670;&#160;</a></span>novas_norm_ang()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_norm_ang </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>angle</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the normalized angle in the [0:2&pi;) range. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">angle</td><td>[rad] an angle in radians. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[rad] the normalized angle in the [0:2&pi;) range.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a4912c64aec0c943b7985db6cb61ff83a">TWOPI</a>.</p>

</div>
</div>
<a id="a9f33de2b26a19a5e20827e9e918b3375" name="a9f33de2b26a19a5e20827e9e918b3375"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f33de2b26a19a5e20827e9e918b3375">&#9670;&#160;</a></span>novas_sep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_sep </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lon1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lat1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lon2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lat2</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the angular separation of two locations on a sphere. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lon1</td><td>[deg] longitude of first location </td></tr>
    <tr><td class="paramname">lat1</td><td>[deg] latitude of first location </td></tr>
    <tr><td class="paramname">lon2</td><td>[deg] longitude of second location </td></tr>
    <tr><td class="paramname">lat2</td><td>[deg] latitude of second location </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] the angular separation of the two locations.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a4f7e06b2fa5b3145b37aec4f9c2d1602" title="Returns the angular separation of two equatorial locations on a sphere.">novas_equ_sep()</a>, <a class="el" href="frames_8c.html#a2d1ef3bc6d99aa473511e45c6e0481e9" title="Returns the apparent angular distance of a source from the Sun from the observer&#39;s point of view.">novas_sun_angle()</a>, <a class="el" href="frames_8c.html#a121940d7f0ef41297d28fab8e6df5998" title="Returns the apparent angular distance of a source from the Moon from the observer&#39;s point of view.">novas_moon_angle()</a> </dd></dl>

</div>
</div>
<a id="a0f41cefb8c872973b07e936b5026d143" name="a0f41cefb8c872973b07e936b5026d143"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f41cefb8c872973b07e936b5026d143">&#9670;&#160;</a></span>novas_vlen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_vlen </td>
          <td>(</td>
          <td class="paramtype">const double *restrict</td>          <td class="paramname"><span class="paramname"><em>v</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(<em>for internal use only</em>) Calculates the length of a 3-vector </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Pointer to a 3-component (x, y, z) vector. The argument cannot be NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the length of the vector</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd>novas_vdot(), novas_vdist() </dd></dl>

</div>
</div>
<a id="ae104afd1bc638def9bdbce1801e5054a" name="ae104afd1bc638def9bdbce1801e5054a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae104afd1bc638def9bdbce1801e5054a">&#9670;&#160;</a></span>radec2vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int radec2vector </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts equatorial spherical coordinates to a vector (equatorial rectangular coordinates). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">ra</td><td>[h] Right ascension (hours). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dec</td><td>[deg] Declination (degrees). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dist</td><td>[AU] Distance (AU) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Position 3-vector, equatorial rectangular coordinates (AU).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if the vector argument is NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a84f672dc1c37e3af374198f29cbcfba9" title="Converts an vector in equatorial rectangular coordinates to equatorial spherical coordinates.">vector2radec()</a>, <a class="el" href="target_8c.html#a27bae6c9efdab763dba9f1ae36a04669" title="Converts angular quantities for stars to vectors.">starvectors()</a> </dd></dl>

</div>
</div>
<a id="af4090e519d7ce7ab1fcdb24b10126eb4" name="af4090e519d7ce7ab1fcdb24b10126eb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4090e519d7ce7ab1fcdb24b10126eb4">&#9670;&#160;</a></span>spin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spin </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>angle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transforms a vector from one coordinate system to another with same origin and axes rotated about the z-axis. </p>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. H. et. al. (1989). Astron. Journ. 97, 1197-1210. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">angle</td><td>[deg] Angle of coordinate system rotation, positive counterclockwise when viewed from +z, in degrees. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>Input position vector. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Position vector expressed in new coordinate system rotated about z by 'angle'. It can be the same vector as the input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if the output vector is NULL. </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a4912c64aec0c943b7985db6cb61ff83a">TWOPI</a>.</p>

</div>
</div>
<a id="a84f672dc1c37e3af374198f29cbcfba9" name="a84f672dc1c37e3af374198f29cbcfba9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84f672dc1c37e3af374198f29cbcfba9">&#9670;&#160;</a></span>vector2radec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short vector2radec </td>
          <td>(</td>
          <td class="paramtype">const double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an vector in equatorial rectangular coordinates to equatorial spherical coordinates. </p>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. H. et. al. (1989). Astron. Journ. 97, 1197-1210. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">pos</td><td>Position 3-vector, equatorial rectangular coordinates. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ra</td><td>[h] Right ascension in hours [0:24] or NAN if the position vector is NULL or a null-vector. It may be NULL if notrequired. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dec</td><td>[deg] Declination in degrees [-90:90] or NAN if the position vector is NULL or a null-vector. It may be NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 of any of the arguments are NULL, or 1 if all input components are 0 so 'ra' and 'dec' are indeterminate, or else 2 if both x and y are zero, but z is nonzero, and so 'ra' is indeterminate.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ae104afd1bc638def9bdbce1801e5054a" title="Converts equatorial spherical coordinates to a vector (equatorial rectangular coordinates).">radec2vector()</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad2b933ce2f58e8b04bbe76ffbff99eb0" name="ad2b933ce2f58e8b04bbe76ffbff99eb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2b933ce2f58e8b04bbe76ffbff99eb0">&#9670;&#160;</a></span>novas_inv_max_iter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_inv_max_iter = 100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of iterations for convergent inverse calculations. </p>
<p>Most iterative inverse functions should normally converge in a handful of iterations. In some pathological cases more iterations may be required. This variable sets an absolute maximum for the number of iterations in order to avoid runaway (zombie) behaviour. If inverse functions fail to converge, they will return a value indicating an error, and errno should be set to ECANCELED.</p>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="util_8c.html">util.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
