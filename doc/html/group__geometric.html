<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuperNOVAS: Geometric equatorial positions and velocities</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Sigmyne-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__geometric.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Geometric equatorial positions and velocities</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9ea79f60493a3a21a9228d048fa5a9a2" id="r_ga9ea79f60493a3a21a9228d048fa5a9a2"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9ea79f60493a3a21a9228d048fa5a9a2">astro_planet</a> (double jd_tt, const <a class="el" href="structobject.html">object</a> *restrict ss_body, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double *restrict ra, double *restrict dec, double *restrict dis)</td></tr>
<tr class="memdesc:ga9ea79f60493a3a21a9228d048fa5a9a2"><td class="mdescLeft">&#160;</td><td class="mdescRight"><b>reference_system</b>: ICRS / GCRS <br  />
 <b>observer location</b>: geocenter <br  />
 <b>position_type</b>: geometric <br  />
  <br /></td></tr>
<tr class="separator:ga9ea79f60493a3a21a9228d048fa5a9a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9530c770e83db2cbc5a31d8d1f8c36f4" id="r_ga9530c770e83db2cbc5a31d8d1f8c36f4"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9530c770e83db2cbc5a31d8d1f8c36f4">astro_star</a> (double jd_tt, const <a class="el" href="structcat__entry.html">cat_entry</a> *restrict star, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double *restrict ra, double *restrict dec)</td></tr>
<tr class="memdesc:ga9530c770e83db2cbc5a31d8d1f8c36f4"><td class="mdescLeft">&#160;</td><td class="mdescRight"><b>reference_system</b>: ICRS / GCRS <br  />
 <b>observer location</b>: geocenter <br  />
 <b>position_type</b>: geometric <br  />
  <br /></td></tr>
<tr class="separator:ga9530c770e83db2cbc5a31d8d1f8c36f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga713982e1f2bae0a72b39d03007f00d23" id="r_ga713982e1f2bae0a72b39d03007f00d23"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga713982e1f2bae0a72b39d03007f00d23">ephemeris</a> (const double *restrict jd_tdb, const <a class="el" href="structobject.html">object</a> *restrict body, enum <a class="el" href="group__solar-system.html#ga208120c5fa3e12853eb37cb99d3e27be">novas_origin</a> origin, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double *restrict pos, double *restrict vel)</td></tr>
<tr class="memdesc:ga713982e1f2bae0a72b39d03007f00d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the position and velocity of a solar system body using the currently configured plugins that provide them.  <br /></td></tr>
<tr class="separator:ga713982e1f2bae0a72b39d03007f00d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada5ca37110e66c8b65f623c9e26ae52e" id="r_gada5ca37110e66c8b65f623c9e26ae52e"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gada5ca37110e66c8b65f623c9e26ae52e">geo_posvel</a> (double jd_tt, double ut1_to_tt, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const <a class="el" href="structobserver.html">observer</a> *restrict obs, double *restrict pos, double *restrict vel)</td></tr>
<tr class="memdesc:gada5ca37110e66c8b65f623c9e26ae52e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the geocentric GCRS position and velocity of an observer.  <br /></td></tr>
<tr class="separator:gada5ca37110e66c8b65f623c9e26ae52e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb2cc37c7bdcd34c5c167afe092aed68" id="r_gafb2cc37c7bdcd34c5c167afe092aed68"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gafb2cc37c7bdcd34c5c167afe092aed68">light_time</a> (double jd_tdb, const <a class="el" href="structobject.html">object</a> *restrict body, const double *pos_obs, double tlight0, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double *pos_src_obs, double *restrict tlight)</td></tr>
<tr class="memdesc:gafb2cc37c7bdcd34c5c167afe092aed68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the geocentric position of a solar system body, as antedated for light-time.  <br /></td></tr>
<tr class="separator:gafb2cc37c7bdcd34c5c167afe092aed68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5c940b62732d74e6c6b1c844931aaa76" id="r_ga5c940b62732d74e6c6b1c844931aaa76"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga5c940b62732d74e6c6b1c844931aaa76">light_time2</a> (double jd_tdb, const <a class="el" href="structobject.html">object</a> *restrict body, const double *restrict pos_obs, double tlight0, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double *p_src_obs, double *restrict v_ssb, double *restrict tlight)</td></tr>
<tr class="memdesc:ga5c940b62732d74e6c6b1c844931aaa76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the geocentric position and velocity of a solar system body, as antedated for light-time.  <br /></td></tr>
<tr class="separator:ga5c940b62732d74e6c6b1c844931aaa76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ead627eed7fabd8583f1353e89f42e7" id="r_ga9ead627eed7fabd8583f1353e89f42e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9ead627eed7fabd8583f1353e89f42e7">novas_approx_heliocentric</a> (enum <a class="el" href="group__source.html#ga219df36b21dc4476656e708d14d08045">novas_planet</a> id, double jd_tdb, double *restrict pos, double *restrict vel)</td></tr>
<tr class="memdesc:ga9ead627eed7fabd8583f1353e89f42e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the approximate geometric heliocentric orbital positions and velocities for the major planets, Sun, or Earth-Moon Barycenter (EMB).  <br /></td></tr>
<tr class="separator:ga9ead627eed7fabd8583f1353e89f42e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6652ee3257621080dac342313d0a0a7" id="r_gac6652ee3257621080dac342313d0a0a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac6652ee3257621080dac342313d0a0a7">novas_geom_posvel</a> (const <a class="el" href="structobject.html">object</a> *restrict source, const <a class="el" href="structnovas__frame.html">novas_frame</a> *restrict frame, enum <a class="el" href="group__equatorial.html#ga7ba038ea34eb901ccfb8f785708c651e">novas_reference_system</a> sys, double *restrict pos, double *restrict vel)</td></tr>
<tr class="memdesc:gac6652ee3257621080dac342313d0a0a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the geometric position and velocity vectors, relative to the observer, for a source in the given observing frame, in the specified coordinate system of choice.  <br /></td></tr>
<tr class="separator:gac6652ee3257621080dac342313d0a0a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4817703c9357f702a27812584c91f87c" id="r_ga4817703c9357f702a27812584c91f87c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4817703c9357f702a27812584c91f87c">novas_geom_to_app</a> (const <a class="el" href="structnovas__frame.html">novas_frame</a> *restrict frame, const double *restrict pos, enum <a class="el" href="group__equatorial.html#ga7ba038ea34eb901ccfb8f785708c651e">novas_reference_system</a> sys, <a class="el" href="structsky__pos.html">sky_pos</a> *restrict out)</td></tr>
<tr class="memdesc:ga4817703c9357f702a27812584c91f87c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an geometric position in ICRS to an apparent position on sky, by applying appropriate corrections for aberration and gravitational deflection for the observer's frame.  <br /></td></tr>
<tr class="separator:ga4817703c9357f702a27812584c91f87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b88d2403a3051ab32229244cf98d7ab" id="r_ga6b88d2403a3051ab32229244cf98d7ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6b88d2403a3051ab32229244cf98d7ab">novas_orbit_native_posvel</a> (double jd_tdb, const <a class="el" href="structnovas__orbital.html">novas_orbital</a> *restrict orbit, double *restrict pos, double *restrict vel)</td></tr>
<tr class="memdesc:ga6b88d2403a3051ab32229244cf98d7ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a rectangular equatorial position and velocity vector for the given orbital elements for the specified time of observation, in the native coordinate system in which the orbital is defined (e.g.  <br /></td></tr>
<tr class="separator:ga6b88d2403a3051ab32229244cf98d7ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa77895c891e9eeb4b1541f03acfd154e" id="r_gaa77895c891e9eeb4b1541f03acfd154e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa77895c891e9eeb4b1541f03acfd154e">novas_transform_vector</a> (const double *in, const <a class="el" href="structnovas__transform.html">novas_transform</a> *restrict transform, double *out)</td></tr>
<tr class="memdesc:gaa77895c891e9eeb4b1541f03acfd154e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms a position or velocity 3-vector from one coordinate reference system to another.  <br /></td></tr>
<tr class="separator:gaa77895c891e9eeb4b1541f03acfd154e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e4e5ff7c37e6521ca75ae62aaf4050e" id="r_ga0e4e5ff7c37e6521ca75ae62aaf4050e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0e4e5ff7c37e6521ca75ae62aaf4050e">obs_posvel</a> (double jd_tdb, double ut1_to_tt, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const <a class="el" href="structobserver.html">observer</a> *restrict obs, const double *restrict geo_pos, const double *restrict geo_vel, double *restrict pos, double *restrict vel)</td></tr>
<tr class="memdesc:ga0e4e5ff7c37e6521ca75ae62aaf4050e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the ICRS position and velocity of the observer relative to the Solar System Barycenter (SSB).  <br /></td></tr>
<tr class="separator:ga0e4e5ff7c37e6521ca75ae62aaf4050e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga9ea79f60493a3a21a9228d048fa5a9a2" name="ga9ea79f60493a3a21a9228d048fa5a9a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ea79f60493a3a21a9228d048fa5a9a2">&#9670;&#160;</a></span>astro_planet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short astro_planet </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobject.html">object</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>ss_body</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dis</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><b>reference_system</b>: ICRS / GCRS <br  />
 <b>observer location</b>: geocenter <br  />
 <b>position_type</b>: geometric <br  />
 </p>
<p>Computes the astrometric place of a solar system body, as would be seen by a non-moving observer located at the current position of the geocenter, referenced to the ICRS without light deflection or aberration. This is the same as calling <a class="el" href="place_8c.html#ad465eafe65e3d701fc4bd57efa793a12" title="reference_system: ICRS / GCRS   observer location: geocenter   position_type: geometric">place_icrs()</a> for the body, except the different set of return values used.</p>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. H. et. al. (1989). Astron. Journ. 97, 1197-1210. </li>
<li>
Explanatory Supplement to the Astronomical Almanac (1992),Chapter 3. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terretrial Time (TT) based Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ss_body</td><td>Pointer to structure containing the body designation for the solar system body. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ra</td><td>[h] Astrometric (geometric) right ascension for a fictitous geocentric observer, referred to the ICRS, without light deflection or aberration. (It may be NULL if not required) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dec</td><td>[deg] Astrometric (geometric) declination, for a fictitous geocentric observer, referred to the ICRS, without light deflection or aberration. (It may be NULL if not required) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dis</td><td>[AU] Apparent distance from Earth to the body at 'jd_tt' (it may be NULL if not needed). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if the object is NULL, or else 1 if the value of 'type' in structure 'ss_body' is invalid, or 10 + the error from <a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c" title="Computes the apparent direction of a celestial object at a specified time and in a specified coordina...">place()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="place_8c.html#ad465eafe65e3d701fc4bd57efa793a12" title="reference_system: ICRS / GCRS   observer location: geocenter   position_type: geometric">place_icrs()</a>, <a class="el" href="group__apparent.html#gac28dd9a362982cfce150751001a96a8a" title="reference_system: TOD   observer location: geocenter   position_type: apparent">app_planet()</a>, <a class="el" href="place_8c.html#adcb9b273dfda5d97a1c01379a16997f9" title="reference_system: ICRS/GCRS   observer location: topocentric (on Earth)   position_type: apparent">local_planet()</a>, <a class="el" href="place_8c.html#aaf3d450c87f545acfa7ab7e2b6c229d9" title="reference_system: TOD   observer location: topocentric (on Earth)   position_type: apparent">topo_planet()</a>, <a class="el" href="group__apparent.html#ga0dc172d82eec79f78c2d218c1a7b9cbe" title="reference_system: ICRS / GCRS   observer location: geocenter   position_type: apparent">virtual_planet()</a>, <a class="el" href="#ga9530c770e83db2cbc5a31d8d1f8c36f4" title="reference_system: ICRS / GCRS   observer location: geocenter   position_type: geometric">astro_star()</a> </dd>
<dd>
<a class="el" href="#gac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a>, <a class="el" href="group__observer.html#gaabb3ab0d99aa6e487cdcf6b454949b75" title="Populates an &#39;observer&#39; data structure for a hypothetical observer located at Earth&#39;s geocenter.">make_observer_at_geocenter()</a>, <a class="el" href="group__equatorial.html#gga7ba038ea34eb901ccfb8f785708c651ea8c3e21e3d68b39b0b0ca28f99b8cacf4" title="Geocentric Celestial Reference system.">NOVAS_GCRS</a> </dd></dl>

<p class="reference">References <a class="el" href="group__equatorial.html#gga7ba038ea34eb901ccfb8f785708c651ea5bf6e497c776a4a8168b23db062e8a10">NOVAS_ICRS</a>, and <a class="el" href="place_8c.html#a918c8244e44c69f1589d9f4bf5355d16">radec_planet()</a>.</p>

</div>
</div>
<a id="ga9530c770e83db2cbc5a31d8d1f8c36f4" name="ga9530c770e83db2cbc5a31d8d1f8c36f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9530c770e83db2cbc5a31d8d1f8c36f4">&#9670;&#160;</a></span>astro_star()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short astro_star </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcat__entry.html">cat_entry</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>star</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><b>reference_system</b>: ICRS / GCRS <br  />
 <b>observer location</b>: geocenter <br  />
 <b>position_type</b>: geometric <br  />
 </p>
<p>Computes the astrometric place of a star, as would be seen by a non-moving observer at the current location of the geocenter, referred to the ICRS without light deflection or aberration, at date 'jd_tt', given its catalog mean place, proper motion, parallax, and radial velocity.</p>
<p>Notwithstanding the different set of return values, this is the same as calling <a class="el" href="place_8c.html#a1504058672e6e3cf24ce6b7189ede005" title="Computes the apparent place of a star at the specified date, given its catalog mean place,...">place_star()</a> with a NULL observer location and NOVAS_ICRS as the system, or <a class="el" href="place_8c.html#ad465eafe65e3d701fc4bd57efa793a12" title="reference_system: ICRS / GCRS   observer location: geocenter   position_type: geometric">place_icrs()</a> for an object that specifies the star.</p>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. H. et. al. (1989). Astron. Journ. 97, 1197-1210. </li>
<li>
Explanatory Supplement to the Astronomical Almanac (1992), Chapter 3. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">star</td><td>Pointer to catalog entry structure containing catalog data for the object in the ICRS. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ra</td><td>[h] Astrometric (geometric) right ascension for a fictitous geocentric observer, referred to the ICRS, without light deflection or aberration. (It may be NULL if not required) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dec</td><td>[deg] Astrometric (geometric) declination for a fictitous geocentric observer, referred to the ICRS, without light deflection or aberration. (It may be NULL if not required) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if a required pointer argument is NULL, or 20 + the error from <a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c" title="Computes the apparent direction of a celestial object at a specified time and in a specified coordina...">place()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="place_8c.html#a1504058672e6e3cf24ce6b7189ede005" title="Computes the apparent place of a star at the specified date, given its catalog mean place,...">place_star()</a>, <a class="el" href="place_8c.html#ad465eafe65e3d701fc4bd57efa793a12" title="reference_system: ICRS / GCRS   observer location: geocenter   position_type: geometric">place_icrs()</a>, <a class="el" href="group__apparent.html#ga906b17f06b42e31a29cafad4856f565f" title="reference_system: TOD   observer location: geocenter   position_type: apparent">app_star()</a>, <a class="el" href="place_8c.html#acd56c41e811a002d6280b3b315730fbd" title="reference_system: ICRS / GCRS   observer location: topocentric (on Earth)   position_type: apparent">local_star()</a>, <a class="el" href="place_8c.html#a86e4f52e832879a33aefc28803e2690f" title="reference_system: TOD   observer location: topocentric (on Earth)   position_type: apparent">topo_star()</a>, <a class="el" href="group__apparent.html#gaaf187624a93349391518f9d6bb3051e5" title="reference_system: ICRS / GCRS   observer location: geocenter   position_type: apparent">virtual_star()</a>, <a class="el" href="#ga9ea79f60493a3a21a9228d048fa5a9a2" title="reference_system: ICRS / GCRS   observer location: geocenter   position_type: geometric">astro_planet()</a> </dd>
<dd>
<a class="el" href="#gac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a>, <a class="el" href="group__observer.html#gaabb3ab0d99aa6e487cdcf6b454949b75" title="Populates an &#39;observer&#39; data structure for a hypothetical observer located at Earth&#39;s geocenter.">make_observer_at_geocenter()</a>, <a class="el" href="group__equatorial.html#gga7ba038ea34eb901ccfb8f785708c651ea5bf6e497c776a4a8168b23db062e8a10" title="International Celestial Reference system.">NOVAS_ICRS</a> </dd></dl>

<p class="reference">References <a class="el" href="group__equatorial.html#gga7ba038ea34eb901ccfb8f785708c651ea5bf6e497c776a4a8168b23db062e8a10">NOVAS_ICRS</a>, and <a class="el" href="place_8c.html#a0f307c2a37d594a68e99c5c8af6d50c9">radec_star()</a>.</p>

</div>
</div>
<a id="ga713982e1f2bae0a72b39d03007f00d23" name="ga713982e1f2bae0a72b39d03007f00d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga713982e1f2bae0a72b39d03007f00d23">&#9670;&#160;</a></span>ephemeris()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short ephemeris </td>
          <td>(</td>
          <td class="paramtype">const double *restrict</td>          <td class="paramname"><span class="paramname"><em>jd_tdb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobject.html">object</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>body</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__solar-system.html#ga208120c5fa3e12853eb37cb99d3e27be">novas_origin</a></td>          <td class="paramname"><span class="paramname"><em>origin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>vel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the position and velocity of a solar system body using the currently configured plugins that provide them. </p>
<p>It is recommended that the input structure 'cel_obj' be created using <a class="el" href="target_8c.html#a411f70fb77582d750c5269fcd64b0ce2">make_object()</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamic Time (TDB) based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">body</td><td>Pointer to structure containing the designation of the body of interest </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">origin</td><td>NOVAS_BARYCENTER (0) or NOVAS_HELIOCENTER (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOCAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Pointer to structure containing the designation of the body of interest </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] Velocity vector of the body at 'jd_tdb'; equatorial rectangular coordinates in AU/day referred to the ICRS. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if the 'jd_tdb' or input object argument is NULL, or else 1 if 'origin' is invalid, 2 if <code>cel_obj-&gt;type</code> is invalid, 10 + the error code from the currently configured <code><a class="el" href="group__solar-system.html#gae8d7c10a8b9e69b1f0654ef4038482fd" title="Provides the position and velocity of major planets (as well as the Sun, Moon, Solar-system Barycente...">novas_planet_provider_hp</a></code> call, or 20 + the error code from <code><a class="el" href="novas_8h.html#aa5f22db2fa785675372d45b88f2f1736">readeph()</a></code>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__solar-system.html#ga9904c454bc7148b42d0f927b82ea3973" title="Set a custom function to use for regular precision (see NOVAS_REDUCED_ACCURACY) ephemeris calculation...">set_planet_provider()</a>, <a class="el" href="group__solar-system.html#ga418f45a11ce7f92ba0ef817558415640" title="Set a custom function to use for high precision (see NOVAS_FULL_ACCURACY) ephemeris calculations inst...">set_planet_provider_hp()</a>, <a class="el" href="group__solar-system.html#ga6097083c438a8d1872c2e00a66360030" title="Sets the function to use for obtaining position / velocity information for minor planets,...">set_ephem_provider()</a> </dd>
<dd>
<a class="el" href="group__source.html#ga4c7846be95299769f4d0377bf127bcf5" title="Sets a celestial object to be a major planet, or the Sun, Moon, Solar-system Barycenter,...">make_planet()</a>, <a class="el" href="group__source.html#gaa22303f98df2d63edf6d8452ff3a43b2" title="Sets a celestial object to be a Solar-system ephemeris body.">make_ephem_object()</a> </dd></dl>

<p class="reference">References <a class="el" href="#ga713982e1f2bae0a72b39d03007f00d23">ephemeris()</a>, <a class="el" href="group__solar-system.html#gaa6fad38297a49ba78a6bd49cedf889b1">get_ephem_provider()</a>, <a class="el" href="group__source.html#ga4c7846be95299769f4d0377bf127bcf5">make_planet()</a>, <a class="el" href="group__solar-system.html#gga208120c5fa3e12853eb37cb99d3e27beade504a1c5ccf790ce9d8ad52797bb94c">NOVAS_BARYCENTER</a>, <a class="el" href="group__source.html#gga1eecb357eeea0de4759e9c8d55af238fa58f22833170aee0959154d3a7be6c269">NOVAS_EPHEM_OBJECT</a>, <a class="el" href="group__frame.html#gga3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="group__solar-system.html#gga208120c5fa3e12853eb37cb99d3e27bea13c0711a025b9aebd4186ab9127cbd7b">NOVAS_HELIOCENTER</a>, <a class="el" href="group__source.html#ga4510a3235a693f122899983901211c30">novas_orbit_posvel()</a>, <a class="el" href="group__source.html#gga1eecb357eeea0de4759e9c8d55af238fa17562d2cd1b0b56d59d31f6ca51c759a">NOVAS_ORBITAL_OBJECT</a>, <a class="el" href="novas_8h.html#aab57b6b4c8c96ed32414fe3964813e5f">NOVAS_ORIGIN_TYPES</a>, <a class="el" href="group__source.html#gga1eecb357eeea0de4759e9c8d55af238fad1eeaddaa96b028742a8ba424e311aa8">NOVAS_PLANET</a>, <a class="el" href="group__source.html#gga219df36b21dc4476656e708d14d08045aaeb39686d0e998c9188b47c31ee9c6b5">NOVAS_SSB</a>, <a class="el" href="group__source.html#gga219df36b21dc4476656e708d14d08045a170e1c704bd29c8d46f66d4d9a03d9c2">NOVAS_SUN</a>, and <a class="el" href="novas_8h.html#aa5f22db2fa785675372d45b88f2f1736">readeph()</a>.</p>

</div>
</div>
<a id="gada5ca37110e66c8b65f623c9e26ae52e" name="gada5ca37110e66c8b65f623c9e26ae52e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada5ca37110e66c8b65f623c9e26ae52e">&#9670;&#160;</a></span>geo_posvel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short geo_posvel </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ut1_to_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobserver.html">observer</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>vel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the geocentric GCRS position and velocity of an observer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ut1_to_tt</td><td>[s] TT - UT1 time difference in seconds </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">obs</td><td>ITRF / GRS80 geodetic observer location. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Position 3-vector of observer, with respect to origin at geocenter, referred to GCRS axes, components in AU. (It may be NULL if not required.) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] Velocity 3-vector of observer, with respect to origin at geocenter, referred to GCRS axes, components in AU/day. (It must be distinct from the pos output vector, and may be NULL if not required) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if the 'obs' is NULL or the two output vectors are the same, or else 1 if 'accuracy' is invalid, or 2 if 'obserrver-&gt;where' is invalid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__frame.html#gadc72577f99a7b076b23e0e44ddbca838" title="Sets up a observing frame for a specific observer location, time of observation, and accuracy require...">novas_make_frame()</a>, <a class="el" href="observer_8c.html#a0f2096c7954b583fe749553b956ff9d2">make_observer()</a>, <a class="el" href="group__time.html#ga4d7470ca705efa1953e8b4beab77c6b6" title="Returns the TT - UT1 time difference given the leap seconds and the actual UT1 - UTC time difference ...">get_ut1_to_tt()</a> </dd></dl>

<p class="reference">References <a class="el" href="#ga713982e1f2bae0a72b39d03007f00d23">ephemeris()</a>, <a class="el" href="#gada5ca37110e66c8b65f623c9e26ae52e">geo_posvel()</a>, <a class="el" href="group__observer.html#gga6140c39d1526b137f827e2091ecc36b3a1665bf146ca1a4d11380bf4d7d9d7058">NOVAS_AIRBORNE_OBSERVER</a>, <a class="el" href="group__solar-system.html#gga208120c5fa3e12853eb37cb99d3e27beade504a1c5ccf790ce9d8ad52797bb94c">NOVAS_BARYCENTER</a>, <a class="el" href="group__source.html#gabad802a863342aebe9a40587b4e47bab">NOVAS_EARTH_INIT</a>, <a class="el" href="group__frame.html#gga3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="group__earth.html#ga348c4fd2a4a046e9768038075717b693">novas_gast()</a>, <a class="el" href="group__observer.html#gga6140c39d1526b137f827e2091ecc36b3aca54b3a0c7d5b31d09090a1f55ff72b2">NOVAS_OBSERVER_AT_GEOCENTER</a>, <a class="el" href="group__observer.html#gga6140c39d1526b137f827e2091ecc36b3aca418efc57ac159cf541c324c008eb27">NOVAS_OBSERVER_IN_EARTH_ORBIT</a>, <a class="el" href="group__observer.html#gga6140c39d1526b137f827e2091ecc36b3aadb64b75d1bf5344760b942f241e52e8">NOVAS_OBSERVER_ON_EARTH</a>, <a class="el" href="group__frame.html#gga3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, <a class="el" href="group__observer.html#gga6140c39d1526b137f827e2091ecc36b3a82474207bac139bc2a8826b9d317a42c">NOVAS_SOLAR_SYSTEM_OBSERVER</a>, <a class="el" href="group__earth.html#gadc81730affa75f5facc8c6bd280c83c9">terra()</a>, <a class="el" href="group__equatorial.html#ga6871e7fecde44084c7b4e1b8dda5ac70">tod_to_gcrs()</a>, <a class="el" href="group__time.html#ga129acca41760da486e1179c93cb9e86d">tt2tdb()</a>, and <a class="el" href="structobserver.html#a11f2eb69df64b674d938b34bbb842ab1">observer::where</a>.</p>

</div>
</div>
<a id="gafb2cc37c7bdcd34c5c167afe092aed68" name="gafb2cc37c7bdcd34c5c167afe092aed68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafb2cc37c7bdcd34c5c167afe092aed68">&#9670;&#160;</a></span>light_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short light_time </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tdb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobject.html">object</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>body</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>pos_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>tlight0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>pos_src_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>tlight</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the geocentric position of a solar system body, as antedated for light-time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">body</td><td>Pointer to structure containing the designation for the solar system body </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_obs</td><td>[AU] Position 3-vector of observer (or the geocenter), with respect to origin at solar system barycenter, referred to ICRS axes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">tlight0</td><td>[day] First approximation to light-time (can be set to 0.0 if not readily available &ndash; it will then be computed as needed). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos_src_obs</td><td>[AU] Position 3-vector of body, with respect to origin at observer (or the geocenter), referred to ICRS axes. It can be the same vector as either of the inputs. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tlight</td><td>[day] Calculated light time</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if any of the poiinter arguments is NULL, 1 if the algorithm failed to converge after 10 iterations, or 10 + the error from <a class="el" href="#ga713982e1f2bae0a72b39d03007f00d23" title="Retrieves the position and velocity of a solar system body using the currently configured plugins tha...">ephemeris()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga5c940b62732d74e6c6b1c844931aaa76" title="Computes the geocentric position and velocity of a solar system body, as antedated for light-time.">light_time2()</a>, <a class="el" href="group__frame.html#gadc72577f99a7b076b23e0e44ddbca838" title="Sets up a observing frame for a specific observer location, time of observation, and accuracy require...">novas_make_frame()</a> </dd></dl>

<p class="reference">References <a class="el" href="#ga5c940b62732d74e6c6b1c844931aaa76">light_time2()</a>.</p>

</div>
</div>
<a id="ga5c940b62732d74e6c6b1c844931aaa76" name="ga5c940b62732d74e6c6b1c844931aaa76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5c940b62732d74e6c6b1c844931aaa76">&#9670;&#160;</a></span>light_time2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int light_time2 </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tdb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobject.html">object</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>body</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>tlight0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p_src_obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>v_ssb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>tlight</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the geocentric position and velocity of a solar system body, as antedated for light-time. </p>
<p>It is effectively the same as the original NOVAS C <a class="el" href="#gafb2cc37c7bdcd34c5c167afe092aed68" title="Computes the geocentric position of a solar system body, as antedated for light-time.">light_time()</a>, except that this returns the antedated source velocity vector also.</p>
<p>NOTES: </p><ol>
<li>
This function is called by <code><a class="el" href="#gac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a></code> or <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c" title="Computes the apparent direction of a celestial object at a specified time and in a specified coordina...">place()</a></code> to calculate observed positions, radial velocity, and distance for the time when the observed light originated from the source. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">body</td><td>Pointer to structure containing the designation for the solar system body </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos_obs</td><td>[AU] Position 3-vector of observer (or the geocenter), with respect to origin at solar system barycenter, referred to ICRS axes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">tlight0</td><td>[day] First approximation to light-time (can be set to 0.0 if not readily avasilable &ndash; so it will be calculated as needed). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p_src_obs</td><td>[AU] Position 3-vector of body, relative to observer, referred to ICRS axes, components in AU. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v_ssb</td><td>[AU/day] Velocity 3-vector of body, with respect to the Solar-system barycenter, referred to ICRS axes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tlight</td><td>[day] Calculated light time, or NAN when returning with an error code.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if any of the pointer arguments is NULL or if the output vectors are the same or if they are the same as pos_obs, 1 if the algorithm failed to converge after 10 iterations, or 10 + the error from <a class="el" href="#ga713982e1f2bae0a72b39d03007f00d23" title="Retrieves the position and velocity of a solar system body using the currently configured plugins tha...">ephemeris()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gafb2cc37c7bdcd34c5c167afe092aed68" title="Computes the geocentric position of a solar system body, as antedated for light-time.">light_time()</a> </dd>
<dd>
<a class="el" href="group__apparent.html#gac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>

<p class="reference">References <a class="el" href="observer_8c.html#a1d58fd371e7604f75df315365672941e">bary2obs()</a>, <a class="el" href="#ga713982e1f2bae0a72b39d03007f00d23">ephemeris()</a>, <a class="el" href="group__solar-system.html#gga208120c5fa3e12853eb37cb99d3e27beade504a1c5ccf790ce9d8ad52797bb94c">NOVAS_BARYCENTER</a>, <a class="el" href="group__frame.html#gga3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, and <a class="el" href="util_8c.html#ad2b933ce2f58e8b04bbe76ffbff99eb0">novas_inv_max_iter</a>.</p>

</div>
</div>
<a id="ga9ead627eed7fabd8583f1353e89f42e7" name="ga9ead627eed7fabd8583f1353e89f42e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ead627eed7fabd8583f1353e89f42e7">&#9670;&#160;</a></span>novas_approx_heliocentric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_approx_heliocentric </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="group__source.html#ga219df36b21dc4476656e708d14d08045">novas_planet</a></td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tdb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>vel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the approximate geometric heliocentric orbital positions and velocities for the major planets, Sun, or Earth-Moon Barycenter (EMB). </p>
<p>The returned positions and velocities are not suitable for precise calculations. However, they may be used to provide rough guidance about the approximate locations of the planets, e.g. for determining approximate rise or set times or the approximate azimuth / elevation angles from an observing site.</p>
<p>The orbitals can provide planet positions to arcmin-level precision for the rocky inner planets, and to a fraction of a degree precision for the gas and ice giants and Pluto. The accuracies for Uranus, Neptune, and Pluto are significantly improved (to the arcmin level) if used in the time range of 1800 AD to 2050 AD. For a more detailed summary of the typical accuracies, see either of the top two references below.</p>
<p>For accurate positions, you should use planetary ephemerides (such as the JPL ephemerides via the CALCEPH or CSPICE plugins) and <code><a class="el" href="#gac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a></code> instead.</p>
<p>While this function is generally similar to creating an orbital object with an orbit initialized with <code><a class="el" href="group__source.html#ga63b094e813d8b752a6f3344419e80031" title="Get approximate current heliocentric orbital elements for the major planets.">novas_make_planet_orbit()</a></code> or <code><a class="el" href="group__source.html#gad6e6c7f6dc2745030e3fd4d407e982bd" title="Gets an approximation of the current Keplerian orbital elements for the Moon relative to the geocente...">novas_make_moon_orbit()</a></code>, and then calling <code><a class="el" href="#gac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a></code>, there are a few important differences:</p>
<ol>
<li>
This function returns geometric positions referenced to the Sun (i.e., heliocentric), whereas <code><a class="el" href="#gac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a></code> references the calculated positions to the Solar-system Barycenter (SSB). </li>
<li>
This function calculates Earth and Moon positions about the Keplerian orbital position of the Earth-Moon Barycenter (EMB). In constrast, <code><a class="el" href="group__source.html#ga63b094e813d8b752a6f3344419e80031" title="Get approximate current heliocentric orbital elements for the major planets.">novas_make_planet_orbit()</a></code> does not provide orbitals for the Earth directly, and <code>make_moot_orbit()</code> references the Moon's orbital to the Earth position returned by the currently configured planet calculator function (see <code><a class="el" href="group__solar-system.html#ga9904c454bc7148b42d0f927b82ea3973" title="Set a custom function to use for regular precision (see NOVAS_REDUCED_ACCURACY) ephemeris calculation...">set_planet_provider()</a></code>). </li>
</ol>
<p>NOTES: </p><ol>
<li>
The Sun's position w.r.t. the Solar-system Barycenter is calculated using <code><a class="el" href="group__solar-system.html#ga580f5949c8a29cdd7bf4787aee891f2b" title="Provides the position and velocity of the Earth and Sun only at epoch &#39;jd_tdb&#39; by evaluating a closed...">earth_sun_calc()</a></code>. All other orbitals are also referenced to the Sun's position calculated that way. </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
E.M. Standish and J.G. Williams 1992. </li>
<li>
<a href="https://ssd.jpl.nasa.gov/planets/approx_pos.html">https://ssd.jpl.nasa.gov/planets/approx_pos.html</a> </li>
<li>
Chapront, J. et al., 2002, A&amp;A 387, 700709 </li>
<li>
Chapront-Touze, M, and Chapront, J. 1983, Astronomy and Astrophysics (ISSN 0004-6361), vol. 124, no. 1, July 1983, p. 50-62. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">id</td><td>NOVAS major planet ID. All major planets, plus the Sun, Moon, Earth-Moon Barycenter (EMB), and Pluto system Barycenter are supported. (For Pluto, the Pluto System Barycenter value are returned.) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian Date. Dates between 3000 BC and 3000 AD are supported. For dates between 1800 AD and 2050 AD the returned positions are somewhat more accurate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Output Heliocentric ICRS position vector, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] Output Heliocentric ICRS velocity vector, or NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or if the JD date is outside of the range with valid parameters, or else -1 if the planet ID is not supported or if both output vectors are NULL. In case of errors errno will be set to indicate the type of error.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.4 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__apparent.html#ga4cb01609f76b0ff8487817b9446a3a62" title="Calculates an approximate apparent location on sky for a major planet, Sun, Moon, Earth-Moon Barycent...">novas_approx_sky_pos()</a>, <a class="el" href="group__solar-system.html#ga580f5949c8a29cdd7bf4787aee891f2b" title="Provides the position and velocity of the Earth and Sun only at epoch &#39;jd_tdb&#39; by evaluating a closed...">earth_sun_calc()</a>, <a class="el" href="#gac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a> </dd>
<dd>
<a class="el" href="group__solar-system.html#ga35fc86a939602ec910dbdfde180d7f31" title="Sets a ephemeris provider for Solar-system objects using the CALCEPH C library and the specified set ...">novas_use_calceph()</a>, <a class="el" href="group__solar-system.html#ga9b44218bca5fce1e9e5103494c15dde4" title="Sets CSPICE as the default ephemeris provider for all types of Solar-system objects (both NOVAS_PLANE...">novas_use_cspice()</a> </dd></dl>

<p class="reference">References <a class="el" href="group__source.html#gga219df36b21dc4476656e708d14d08045adc941f5a3613952d6d6102281e70e5c0">NOVAS_EARTH</a>, <a class="el" href="group__source.html#gga219df36b21dc4476656e708d14d08045ad1785b619d72877c4eb78d61aedf9e1a">NOVAS_EMB</a>, <a class="el" href="group__source.html#gad6e6c7f6dc2745030e3fd4d407e982bd">novas_make_moon_orbit()</a>, <a class="el" href="group__source.html#ga63b094e813d8b752a6f3344419e80031">novas_make_planet_orbit()</a>, <a class="el" href="group__source.html#gga219df36b21dc4476656e708d14d08045a9fcf58133828600a062725ced448cfcf">NOVAS_MOON</a>, <a class="el" href="group__source.html#ga85243a6b9eee259d3fb84ee1a587e065">NOVAS_ORBIT_INIT</a>, <a class="el" href="group__source.html#ga4510a3235a693f122899983901211c30">novas_orbit_posvel()</a>, <a class="el" href="group__frame.html#gga3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, and <a class="el" href="group__source.html#gga219df36b21dc4476656e708d14d08045a170e1c704bd29c8d46f66d4d9a03d9c2">NOVAS_SUN</a>.</p>

</div>
</div>
<a id="gac6652ee3257621080dac342313d0a0a7" name="gac6652ee3257621080dac342313d0a0a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac6652ee3257621080dac342313d0a0a7">&#9670;&#160;</a></span>novas_geom_posvel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_geom_posvel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structobject.html">object</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnovas__frame.html">novas_frame</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>frame</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__equatorial.html#ga7ba038ea34eb901ccfb8f785708c651e">novas_reference_system</a></td>          <td class="paramname"><span class="paramname"><em>sys</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>vel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the geometric position and velocity vectors, relative to the observer, for a source in the given observing frame, in the specified coordinate system of choice. </p>
<p>The geometric position includes proper motion, and for solar-system bodies it is antedated for light travel time, so it effectively represents the geometric position as seen by the observer. However, the geometric does not include aberration correction, nor gravitational deflection.</p>
<p>If you want apparent positions, which account for aberration and gravitational deflection, use novas_skypos() instead.</p>
<p>You can also use <a class="el" href="#gaa77895c891e9eeb4b1541f03acfd154e" title="Transforms a position or velocity 3-vector from one coordinate reference system to another.">novas_transform_vector()</a> to convert the output position and velocity vectors to a dfferent coordinate system of choice afterwards if you want the results expressed in more than one coordinate system.</p>
<p>It implements the same geometric transformations as <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c" title="Computes the apparent direction of a celestial object at a specified time and in a specified coordina...">place()</a></code> but at a reduced computational cost. See <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c" title="Computes the apparent direction of a celestial object at a specified time and in a specified coordina...">place()</a></code> for references.</p>
<p>NOTES: </p><ol>
<li>
As of SuperNOVAS v1.3, the returned velocity vector is a proper observer-based velocity measure. In prior releases, and in NOVAS C 3.1, this was inconsistent, with pseudo LSR-based measures being returned for catalog sources. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">source</td><td>Pointer to a celestial source data structure that is observed. Catalog sources should have coordinates and properties in ICRS. You can use <code><a class="el" href="group__source.html#ga59caeca70d1fdd02e41ed62f20675e6c" title="Transform a star&#39;s catalog quantities for a change the coordinate system and/or the date for which th...">transform_cat()</a></code> to convert catalog entries to ICRS as necessary. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">frame</td><td>Observer frame, defining the location and time of observation </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sys</td><td>The coordinate system in which to return positions and velocities. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Calculated geometric position vector of the source relative to the observer location, in the designated coordinate system. It may be NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] The calculated velocity vector of the source relative to the observer in the designated coordinate system. It must be distinct from the pos output vector, and may be NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if any of the arguments is invalid, 50&ndash;70 error is 50 + error from <a class="el" href="#ga5c940b62732d74e6c6b1c844931aaa76" title="Computes the geocentric position and velocity of a solar system body, as antedated for light-time.">light_time2()</a>.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga4817703c9357f702a27812584c91f87c" title="Converts an geometric position in ICRS to an apparent position on sky, by applying appropriate correc...">novas_geom_to_app()</a>, <a class="el" href="group__apparent.html#gac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a>, </dd>
<dd>
<a class="el" href="#gaa77895c891e9eeb4b1541f03acfd154e" title="Transforms a position or velocity 3-vector from one coordinate reference system to another.">novas_transform_vector()</a>, <a class="el" href="group__frame.html#gadc72577f99a7b076b23e0e44ddbca838" title="Sets up a observing frame for a specific observer location, time of observation, and accuracy require...">novas_make_frame()</a> </dd></dl>

<p class="reference">References <a class="el" href="observer_8c.html#a1d58fd371e7604f75df315365672941e">bary2obs()</a>, <a class="el" href="util_8c.html#ad799864f637c483fb49491bde5a93e25">d_light()</a>, <a class="el" href="#ga5c940b62732d74e6c6b1c844931aaa76">light_time2()</a>, <a class="el" href="group__source.html#gga1eecb357eeea0de4759e9c8d55af238fa4f9ab9cec85498c41f90c33794d032e5">NOVAS_CATALOG_OBJECT</a>, <a class="el" href="group__frame.html#gga3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="group__time.html#gae30e3dd8e30bdcf4e8486cfce696fb98">novas_get_time()</a>, <a class="el" href="group__time.html#ga31bf4a08940bfa3e97ae6a1abee80422">NOVAS_JD_J2000</a>, <a class="el" href="group__source.html#gga1eecb357eeea0de4759e9c8d55af238fad1eeaddaa96b028742a8ba424e311aa8">NOVAS_PLANET</a>, <a class="el" href="group__frame.html#gga3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, <a class="el" href="group__time.html#ggaa642c4ccc7195dc62fd0dc56567ebd0baf5d992bdf01b4f3fd7b22e3e24c6974d">NOVAS_TDB</a>, <a class="el" href="group__source.html#ga24b69e1809a33113d4a041dd3e4082ad">proper_motion()</a>, and <a class="el" href="group__source.html#ga27bae6c9efdab763dba9f1ae36a04669">starvectors()</a>.</p>

</div>
</div>
<a id="ga4817703c9357f702a27812584c91f87c" name="ga4817703c9357f702a27812584c91f87c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4817703c9357f702a27812584c91f87c">&#9670;&#160;</a></span>novas_geom_to_app()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_geom_to_app </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structnovas__frame.html">novas_frame</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>frame</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__equatorial.html#ga7ba038ea34eb901ccfb8f785708c651e">novas_reference_system</a></td>          <td class="paramname"><span class="paramname"><em>sys</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsky__pos.html">sky_pos</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an geometric position in ICRS to an apparent position on sky, by applying appropriate corrections for aberration and gravitational deflection for the observer's frame. </p>
<p>Unlike <code><a class="el" href="place_8c.html#aca09ed0d2379ac4a4841c9e3edeeee4c" title="Computes the apparent direction of a celestial object at a specified time and in a specified coordina...">place()</a></code> the output reports the distance calculated from the parallax for sidereal sources. The radial velocity of the output is set to NAN (if needed use <a class="el" href="group__apparent.html#gac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a> instead).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">frame</td><td>The observer frame, defining the location and time of observation </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pos</td><td>[AU] Geometric position of source in ICRS coordinates </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sys</td><td>The coordinate system in which to return the apparent sky location </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Pointer to the data structure which is populated with the calculated apparent location in the designated coordinate system. It may be the same pounter as the input position. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or an error from grav_def2(), or else -1 (errno will indicate the type of error).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__apparent.html#gab7db8026c598e8e126a4725ac3b388bf" title="Converts an observed apparent sky position of a source to an ICRS geometric position,...">novas_app_to_geom()</a> </dd>
<dd>
<a class="el" href="group__apparent.html#ga3cd947f2e48d6c5cc88ad7a1bab9b8ca" title="Converts an observed apparent position vector in the specified coordinate system to local horizontal ...">novas_app_to_hor()</a>, <a class="el" href="group__apparent.html#gac365a1e015ae1f875dc5a66fd5435b2f" title="Calculates an apparent location on sky for the source.">novas_sky_pos()</a>, <a class="el" href="#gac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a> </dd></dl>

<p class="reference">References <a class="el" href="grav_8c.html#ae36bc31e1dad8a68f94f7a6414f0519f">grav_planets()</a>, <a class="el" href="group__frame.html#gga3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="group__frame.html#gga3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, <a class="el" href="util_8c.html#a0f41cefb8c872973b07e936b5026d143">novas_vlen()</a>, and <a class="el" href="group__util.html#ga84f672dc1c37e3af374198f29cbcfba9">vector2radec()</a>.</p>

</div>
</div>
<a id="ga6b88d2403a3051ab32229244cf98d7ab" name="ga6b88d2403a3051ab32229244cf98d7ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6b88d2403a3051ab32229244cf98d7ab">&#9670;&#160;</a></span>novas_orbit_native_posvel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_orbit_native_posvel </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tdb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnovas__orbital.html">novas_orbital</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>orbit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>vel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a rectangular equatorial position and velocity vector for the given orbital elements for the specified time of observation, in the native coordinate system in which the orbital is defined (e.g. </p>
<p>ecliptic for heliocentric orbitals).</p>
<p>REFERENCES: </p><ol>
<li>
E.M. Standish and J.G. Williams 1992. </li>
<li>
<a href="https://ssd.jpl.nasa.gov/planets/approx_pos.html">https://ssd.jpl.nasa.gov/planets/approx_pos.html</a> </li>
<li>
<a href="https://en.wikipedia.org/wiki/Orbital_elements">https://en.wikipedia.org/wiki/Orbital_elements</a> </li>
<li>
<a href="https://orbitalofficial.com/">https://orbitalofficial.com/</a> </li>
<li>
<a href="https://downloads.rene-schwarz.com/download/M001-Keplerian_Orbit_Elements_to_Cartesian_State_Vectors.pdf">https://downloads.rene-schwarz.com/download/M001-Keplerian_Orbit_Elements_to_Cartesian_State_Vectors.pdf</a> </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamic Time (TDB) based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">orbit</td><td>Orbital parameters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Output ICRS equatorial position vector around orbital center, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] Output ICRS velocity vector rel. to orbital center, in the native system of the orbital, or NULL if not required. 0 if successful, or else -1 if the orbital parameters are NULL, or if the position and velocity output vectors are the same or the orbital system is ill defined (errno set to EINVAL), or if the calculation did not converge (errno set to ECANCELED).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.4</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gac6652ee3257621080dac342313d0a0a7" title="Calculates the geometric position and velocity vectors, relative to the observer, for a source in the...">novas_geom_posvel()</a>, <a class="el" href="#ga713982e1f2bae0a72b39d03007f00d23" title="Retrieves the position and velocity of a solar system body using the currently configured plugins tha...">ephemeris()</a>, <a class="el" href="group__source.html#ga3c5e215babeeba078ca7b3e9be42e555" title="Sets a celestial object to be a Solar-system orbital body.">make_orbital_object()</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a4912c64aec0c943b7985db6cb61ff83a">TWOPI</a>.</p>

</div>
</div>
<a id="gaa77895c891e9eeb4b1541f03acfd154e" name="gaa77895c891e9eeb4b1541f03acfd154e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa77895c891e9eeb4b1541f03acfd154e">&#9670;&#160;</a></span>novas_transform_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_transform_vector </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnovas__transform.html">novas_transform</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>transform</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transforms a position or velocity 3-vector from one coordinate reference system to another. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>Input 3-vector in the original coordinate reference system </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">transform</td><td>Pointer to a coordinate transformation matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Output 3-vector in the new coordinate reference system. It may be the same as the input. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if there was an error (errno will indicate the type of error).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__frame.html#ga4d179c8573319fc25c775ce56ba055dc" title="Calculates a transformation matrix that can be used to convert positions and velocities from one coor...">novas_make_transform()</a>, novas_transform_skypos() </dd></dl>

</div>
</div>
<a id="ga0e4e5ff7c37e6521ca75ae62aaf4050e" name="ga0e4e5ff7c37e6521ca75ae62aaf4050e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e4e5ff7c37e6521ca75ae62aaf4050e">&#9670;&#160;</a></span>obs_posvel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int obs_posvel </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tdb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ut1_to_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structobserver.html">observer</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>obs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *restrict</td>          <td class="paramname"><span class="paramname"><em>geo_pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *restrict</td>          <td class="paramname"><span class="paramname"><em>geo_vel</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>vel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the ICRS position and velocity of the observer relative to the Solar System Barycenter (SSB). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tdb</td><td>[day] Barycentric Dynamical Time (TDB) based Julian date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ut1_to_tt</td><td>[s] TT - UT1 time difference. Used only when 'location-&gt;where' is NOVAS_OBSERVER_ON_EARTH (1) or NOVAS_OBSERVER_IN_EARTH_ORBIT (2). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">obs</td><td>The observer location, relative to which the output positions and velocities are to be calculated </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">geo_pos</td><td>[AU] ICRS position vector of the geocenter w.r.t. the Solar System Barycenter (SSB). If either geo_pos or geo_vel is NULL, it will be calculated when needed. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">geo_vel</td><td>[AU/day] ICRS velocity vector of the geocenter w.r.t. the Solar System Barycenter (SSB). If either geo_pos or geo_vel is NULL, it will be calculated when needed. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pos</td><td>[AU] Position 3-vector of the observer w.r.t. the Solar System Barycenter (SSB). It may be NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vel</td><td>[AU/day] Velocity 3-vector of the observer w.r.t. the Solar System Barycenter (SSB). It must be distinct from the pos output vector, and may be NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or the error from <a class="el" href="#gada5ca37110e66c8b65f623c9e26ae52e" title="Computes the geocentric GCRS position and velocity of an observer.">geo_posvel()</a>, or else -1 (with errno indicating the type of error).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__frame.html#gadc72577f99a7b076b23e0e44ddbca838" title="Sets up a observing frame for a specific observer location, time of observation, and accuracy require...">novas_make_frame()</a> </dd></dl>

<p class="reference">References <a class="el" href="#ga713982e1f2bae0a72b39d03007f00d23">ephemeris()</a>, <a class="el" href="#gada5ca37110e66c8b65f623c9e26ae52e">geo_posvel()</a>, <a class="el" href="group__observer.html#gga6140c39d1526b137f827e2091ecc36b3a1665bf146ca1a4d11380bf4d7d9d7058">NOVAS_AIRBORNE_OBSERVER</a>, <a class="el" href="group__solar-system.html#gga208120c5fa3e12853eb37cb99d3e27beade504a1c5ccf790ce9d8ad52797bb94c">NOVAS_BARYCENTER</a>, <a class="el" href="group__source.html#gabad802a863342aebe9a40587b4e47bab">NOVAS_EARTH_INIT</a>, <a class="el" href="group__observer.html#gga6140c39d1526b137f827e2091ecc36b3aca418efc57ac159cf541c324c008eb27">NOVAS_OBSERVER_IN_EARTH_ORBIT</a>, <a class="el" href="group__observer.html#gga6140c39d1526b137f827e2091ecc36b3aadb64b75d1bf5344760b942f241e52e8">NOVAS_OBSERVER_ON_EARTH</a>, <a class="el" href="novas_8h.html#a7af86c48f77394688f4ad43eb20760f4">NOVAS_OBSERVER_PLACES</a>, <a class="el" href="group__observer.html#gga6140c39d1526b137f827e2091ecc36b3a82474207bac139bc2a8826b9d317a42c">NOVAS_SOLAR_SYSTEM_OBSERVER</a>, and <a class="el" href="group__time.html#ga129acca41760da486e1179c93cb9e86d">tt2tdb()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
