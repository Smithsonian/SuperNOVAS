<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuperNOVAS: Atmospheric refraction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__refract.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Atmospheric refraction</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga4f7dee9d4c9db4cf201af8383c72d4db" id="r_ga4f7dee9d4c9db4cf201af8383c72d4db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4f7dee9d4c9db4cf201af8383c72d4db">NOVAS_DEFAULT_WAVELENGTH</a>&#160;&#160;&#160;0.55</td></tr>
<tr class="memdesc:ga4f7dee9d4c9db4cf201af8383c72d4db"><td class="mdescLeft">&#160;</td><td class="mdescRight">[&mu;m] Default wavelength, e.g.  <br /></td></tr>
<tr class="separator:ga4f7dee9d4c9db4cf201af8383c72d4db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gad4899a6116cfbbe17400e7ef0c8426a9" id="r_gad4899a6116cfbbe17400e7ef0c8426a9"><td class="memItemLeft" align="right" valign="top">typedef double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad4899a6116cfbbe17400e7ef0c8426a9">RefractionModel</a>) (double jd_tt, const <a class="el" href="structon__surface.html">on_surface</a> *loc, enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a> type, double el)</td></tr>
<tr class="memdesc:gad4899a6116cfbbe17400e7ef0c8426a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function that returns a refraction correction for a given date/time of observation at the given site on earth, and for a given astrometric source elevation.  <br /></td></tr>
<tr class="separator:gad4899a6116cfbbe17400e7ef0c8426a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gabe97e2d459a30db9d0f67d8c60af3b81" id="r_gabe97e2d459a30db9d0f67d8c60af3b81"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a> { <br />
&#160;&#160;<a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81ace535f58f84fa374a973aa9d4e6a52e8">NOVAS_NO_ATMOSPHERE</a> = 0
, <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81a7ed64c314f06fdf9acfa72beb531e73d">NOVAS_STANDARD_ATMOSPHERE</a>
, <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81aaf3bef1a45c5d59df8e779da09cecb68">NOVAS_WEATHER_AT_LOCATION</a>
, <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81a165a8cec5e4cd5aeb6f26530022a4761">NOVAS_RADIO_REFRACTION</a>
, <br />
&#160;&#160;<a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81a75c80913155eddef17af869d6b0d62f6">NOVAS_WAVE_REFRACTION</a>
<br />
 }</td></tr>
<tr class="memdesc:gabe97e2d459a30db9d0f67d8c60af3b81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constants that determine whether what model (if any) to use for implicit refraction calculations.  <a href="#gabe97e2d459a30db9d0f67d8c60af3b81">More...</a><br /></td></tr>
<tr class="separator:gabe97e2d459a30db9d0f67d8c60af3b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c77758e10b1d3dc8dbd3ab0b694e468" id="r_ga8c77758e10b1d3dc8dbd3ab0b694e468"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a> { <a class="el" href="#gga8c77758e10b1d3dc8dbd3ab0b694e468a29a320ab3459dafa0d18e7ebef3ae8fe">NOVAS_REFRACT_OBSERVED</a> = -1
, <a class="el" href="#gga8c77758e10b1d3dc8dbd3ab0b694e468a4255a64975ec93df2f228c63c38096a0">NOVAS_REFRACT_ASTROMETRIC</a>
 }</td></tr>
<tr class="memdesc:ga8c77758e10b1d3dc8dbd3ab0b694e468"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of elevation value for which to calculate a refraction.  <a href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">More...</a><br /></td></tr>
<tr class="separator:ga8c77758e10b1d3dc8dbd3ab0b694e468"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga81da80ae3ab1d0a444f39bde2af3a732" id="r_ga81da80ae3ab1d0a444f39bde2af3a732"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga81da80ae3ab1d0a444f39bde2af3a732">novas_inv_refract</a> (<a class="el" href="#gad4899a6116cfbbe17400e7ef0c8426a9">RefractionModel</a> model, double jd_tt, const <a class="el" href="structon__surface.html">on_surface</a> *restrict loc, enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a> type, double el0)</td></tr>
<tr class="memdesc:ga81da80ae3ab1d0a444f39bde2af3a732"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the reverse atmospheric refraction for a given refraction model.  <br /></td></tr>
<tr class="separator:ga81da80ae3ab1d0a444f39bde2af3a732"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4511a80a1defbb1e1fdc29c289e7de4" id="r_gae4511a80a1defbb1e1fdc29c289e7de4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae4511a80a1defbb1e1fdc29c289e7de4">novas_optical_refraction</a> (double jd_tt, const <a class="el" href="structon__surface.html">on_surface</a> *loc, enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a> type, double el)</td></tr>
<tr class="memdesc:gae4511a80a1defbb1e1fdc29c289e7de4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an optical refraction correction using the weather parameters defined for the observer location.  <br /></td></tr>
<tr class="separator:gae4511a80a1defbb1e1fdc29c289e7de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b49f92f8f818f2272613e3432185a39" id="r_ga6b49f92f8f818f2272613e3432185a39"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6b49f92f8f818f2272613e3432185a39">novas_radio_refraction</a> (double jd_tt, const <a class="el" href="structon__surface.html">on_surface</a> *loc, enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a> type, double el)</td></tr>
<tr class="memdesc:ga6b49f92f8f818f2272613e3432185a39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Atmospheric refraction model for radio wavelengths (Berman &amp; Rockwell 1976).  <br /></td></tr>
<tr class="separator:ga6b49f92f8f818f2272613e3432185a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac673c4fef94847b796dc2aa2f4d0807d" id="r_gac673c4fef94847b796dc2aa2f4d0807d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac673c4fef94847b796dc2aa2f4d0807d">novas_refract_wavelength</a> (double microns)</td></tr>
<tr class="memdesc:gac673c4fef94847b796dc2aa2f4d0807d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the observing wavelength for which refraction is to be calculated when using a wavelength-depenendent model, such as <a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4" title="The wavelength-dependent IAU atmospheric refraction model, based on the SOFA iauRefco() function,...">novas_wave_refraction()</a>.  <br /></td></tr>
<tr class="separator:gac673c4fef94847b796dc2aa2f4d0807d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab04bff3b97c132e358e11c3a5b7a3081" id="r_gab04bff3b97c132e358e11c3a5b7a3081"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab04bff3b97c132e358e11c3a5b7a3081">novas_standard_refraction</a> (double jd_tt, const <a class="el" href="structon__surface.html">on_surface</a> *loc, enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a> type, double el)</td></tr>
<tr class="memdesc:gab04bff3b97c132e358e11c3a5b7a3081"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an optical refraction correction for a standard atmosphere.  <br /></td></tr>
<tr class="separator:gab04bff3b97c132e358e11c3a5b7a3081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b9ad6dfbd86e4faa2d8068c7d64fac4" id="r_ga7b9ad6dfbd86e4faa2d8068c7d64fac4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4">novas_wave_refraction</a> (double jd_tt, const <a class="el" href="structon__surface.html">on_surface</a> *loc, enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a> type, double el)</td></tr>
<tr class="memdesc:ga7b9ad6dfbd86e4faa2d8068c7d64fac4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The wavelength-dependent IAU atmospheric refraction model, based on the SOFA <code>iauRefco()</code> function, in compliance to the 'SOFA Software License' terms of the original source.  <br /></td></tr>
<tr class="separator:ga7b9ad6dfbd86e4faa2d8068c7d64fac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac7ed2a1a5fb5aea3063d116d3d980eeb" id="r_gac7ed2a1a5fb5aea3063d116d3d980eeb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac7ed2a1a5fb5aea3063d116d3d980eeb">refract</a> (const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, enum <a class="el" href="#gabe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a> model, double zd_obs)</td></tr>
<tr class="memdesc:gac7ed2a1a5fb5aea3063d116d3d980eeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes atmospheric optical refraction for an observed (already refracted!) zenith distance through the atmosphere.  <br /></td></tr>
<tr class="separator:gac7ed2a1a5fb5aea3063d116d3d980eeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe1d4e96dd66676f5567a279e83e88d9" id="r_gafe1d4e96dd66676f5567a279e83e88d9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gafe1d4e96dd66676f5567a279e83e88d9">refract_astro</a> (const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, enum <a class="el" href="#gabe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a> model, double zd_astro)</td></tr>
<tr class="memdesc:gafe1d4e96dd66676f5567a279e83e88d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes atmospheric optical refraction for a source at an astrometric zenith distance (e.g.  <br /></td></tr>
<tr class="separator:gafe1d4e96dd66676f5567a279e83e88d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga4f7dee9d4c9db4cf201af8383c72d4db" name="ga4f7dee9d4c9db4cf201af8383c72d4db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4f7dee9d4c9db4cf201af8383c72d4db">&#9670;&#160;</a></span>NOVAS_DEFAULT_WAVELENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NOVAS_DEFAULT_WAVELENGTH&#160;&#160;&#160;0.55</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>[&mu;m] Default wavelength, e.g. </p>
<p>for wavelength-dependent refraction models. It is set to the median wavelength of visible light. </p><dl class="section since"><dt>Since</dt><dd>1.4 </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gac673c4fef94847b796dc2aa2f4d0807d" title="Sets the observing wavelength for which refraction is to be calculated when using a wavelength-depene...">novas_refract_wavelength()</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gad4899a6116cfbbe17400e7ef0c8426a9" name="gad4899a6116cfbbe17400e7ef0c8426a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad4899a6116cfbbe17400e7ef0c8426a9">&#9670;&#160;</a></span>RefractionModel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef double(* RefractionModel) (double jd_tt, const <a class="el" href="structon__surface.html">on_surface</a> *loc, enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a> type, double el)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function that returns a refraction correction for a given date/time of observation at the given site on earth, and for a given astrometric source elevation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian data of observation </td></tr>
    <tr><td class="paramname">loc</td><td>Pointer to structure defining the observer's location on earth, and local weather </td></tr>
    <tr><td class="paramname">type</td><td>Whether the input elevation is observed or astrometric: REFRACT_OBSERVED (-1) or REFRACT_ASTROMETRIC (0). </td></tr>
    <tr><td class="paramname">el</td><td>[deg] Astrometric (unrefracted) source elevation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[arcsec] Estimated refraction, or NAN if there was an error (it should also set errno to indicate the type of error).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__apparent.html#ga3cd947f2e48d6c5cc88ad7a1bab9b8ca" title="Converts an observed apparent position vector in the specified coordinate system to local horizontal ...">novas_app_to_hor()</a>, <a class="el" href="group__nonequatorial.html#gaa57cbcae2001fece2ee4a2babfbc5f89" title="Converts an observed azimuth and elevation coordinate to right ascension (R.A.) and declination coord...">novas_hor_to_app()</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="gabe97e2d459a30db9d0f67d8c60af3b81" name="gabe97e2d459a30db9d0f67d8c60af3b81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe97e2d459a30db9d0f67d8c60af3b81">&#9670;&#160;</a></span>novas_refraction_model</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#gabe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constants that determine whether what model (if any) to use for implicit refraction calculations. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structon__surface.html" title="Data for an observer&#39;s location on the surface of the Earth, and optional local weather data for refr...">on_surface</a>, <a class="el" href="group__apparent.html#ga3cd947f2e48d6c5cc88ad7a1bab9b8ca" title="Converts an observed apparent position vector in the specified coordinate system to local horizontal ...">novas_app_to_hor()</a>, <a class="el" href="group__nonequatorial.html#gaa57cbcae2001fece2ee4a2babfbc5f89" title="Converts an observed azimuth and elevation coordinate to right ascension (R.A.) and declination coord...">novas_hor_to_app()</a>, <a class="el" href="#gac7ed2a1a5fb5aea3063d116d3d980eeb" title="Computes atmospheric optical refraction for an observed (already refracted!) zenith distance through ...">refract()</a>, <a class="el" href="#gafe1d4e96dd66676f5567a279e83e88d9" title="Computes atmospheric optical refraction for a source at an astrometric zenith distance (e....">refract_astro()</a> </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggabe97e2d459a30db9d0f67d8c60af3b81ace535f58f84fa374a973aa9d4e6a52e8" name="ggabe97e2d459a30db9d0f67d8c60af3b81ace535f58f84fa374a973aa9d4e6a52e8"></a>NOVAS_NO_ATMOSPHERE&#160;</td><td class="fielddoc"><p>Do not apply atmospheric refraction correction. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggabe97e2d459a30db9d0f67d8c60af3b81a7ed64c314f06fdf9acfa72beb531e73d" name="ggabe97e2d459a30db9d0f67d8c60af3b81a7ed64c314f06fdf9acfa72beb531e73d"></a>NOVAS_STANDARD_ATMOSPHERE&#160;</td><td class="fielddoc"><p>Uses a standard atmospheric model, ignoring any weather values defined for the specific observing location. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gab04bff3b97c132e358e11c3a5b7a3081" title="Returns an optical refraction correction for a standard atmosphere.">novas_standard_refraction()</a>, <a class="el" href="group__observer.html#ga0fc8f315f8606e09571ab49efb13baca" title="Sets default weather parameters based on an approximate global model to the mean annualized temperatu...">novas_set_default_weather()</a> </dd></dl>
</td></tr>
<tr><td class="fieldname"><a id="ggabe97e2d459a30db9d0f67d8c60af3b81aaf3bef1a45c5d59df8e779da09cecb68" name="ggabe97e2d459a30db9d0f67d8c60af3b81aaf3bef1a45c5d59df8e779da09cecb68"></a>NOVAS_WEATHER_AT_LOCATION&#160;</td><td class="fielddoc"><p>Uses the weather parameters that are specified together with the observing location. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae4511a80a1defbb1e1fdc29c289e7de4" title="Returns an optical refraction correction using the weather parameters defined for the observer locati...">novas_optical_refraction()</a> </dd></dl>
</td></tr>
<tr><td class="fieldname"><a id="ggabe97e2d459a30db9d0f67d8c60af3b81a165a8cec5e4cd5aeb6f26530022a4761" name="ggabe97e2d459a30db9d0f67d8c60af3b81a165a8cec5e4cd5aeb6f26530022a4761"></a>NOVAS_RADIO_REFRACTION&#160;</td><td class="fielddoc"><p>Uses the Berman &amp; Rockwell 1976 refraction model for Radio wavelengths with the weather parameters specified together with the observing location. </p>
<dl class="section since"><dt>Since</dt><dd>1.4 </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga6b49f92f8f818f2272613e3432185a39" title="Atmospheric refraction model for radio wavelengths (Berman &amp; Rockwell 1976).">novas_radio_refraction()</a> </dd></dl>
</td></tr>
<tr><td class="fieldname"><a id="ggabe97e2d459a30db9d0f67d8c60af3b81a75c80913155eddef17af869d6b0d62f6" name="ggabe97e2d459a30db9d0f67d8c60af3b81a75c80913155eddef17af869d6b0d62f6"></a>NOVAS_WAVE_REFRACTION&#160;</td><td class="fielddoc"><p>Uses the IAU / SOFA wavelength-depended refraction model with the weather parameters specified together with the observing location. </p>
<p>The wavelength can be specified via <code><a class="el" href="#gac673c4fef94847b796dc2aa2f4d0807d" title="Sets the observing wavelength for which refraction is to be calculated when using a wavelength-depene...">novas_refract_wavelength()</a></code> or else it is assumed to be 550 nm (visible light). </p><dl class="section since"><dt>Since</dt><dd>1.4 </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4" title="The wavelength-dependent IAU atmospheric refraction model, based on the SOFA iauRefco() function,...">novas_wave_refraction()</a>, <a class="el" href="#gac673c4fef94847b796dc2aa2f4d0807d" title="Sets the observing wavelength for which refraction is to be calculated when using a wavelength-depene...">novas_refract_wavelength()</a> </dd></dl>
</td></tr>
</table>

</div>
</div>
<a id="ga8c77758e10b1d3dc8dbd3ab0b694e468" name="ga8c77758e10b1d3dc8dbd3ab0b694e468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">&#9670;&#160;</a></span>novas_refraction_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The type of elevation value for which to calculate a refraction. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gad4899a6116cfbbe17400e7ef0c8426a9" title="A function that returns a refraction correction for a given date/time of observation at the given sit...">RefractionModel</a>, <a class="el" href="group__apparent.html#ga3cd947f2e48d6c5cc88ad7a1bab9b8ca" title="Converts an observed apparent position vector in the specified coordinate system to local horizontal ...">novas_app_to_hor()</a>, <a class="el" href="group__nonequatorial.html#gaa57cbcae2001fece2ee4a2babfbc5f89" title="Converts an observed azimuth and elevation coordinate to right ascension (R.A.) and declination coord...">novas_hor_to_app()</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga8c77758e10b1d3dc8dbd3ab0b694e468a29a320ab3459dafa0d18e7ebef3ae8fe" name="gga8c77758e10b1d3dc8dbd3ab0b694e468a29a320ab3459dafa0d18e7ebef3ae8fe"></a>NOVAS_REFRACT_OBSERVED&#160;</td><td class="fielddoc"><p>Refract observed elevation value. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8c77758e10b1d3dc8dbd3ab0b694e468a4255a64975ec93df2f228c63c38096a0" name="gga8c77758e10b1d3dc8dbd3ab0b694e468a4255a64975ec93df2f228c63c38096a0"></a>NOVAS_REFRACT_ASTROMETRIC&#160;</td><td class="fielddoc"><p>Refract astrometric elevation value. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga81da80ae3ab1d0a444f39bde2af3a732" name="ga81da80ae3ab1d0a444f39bde2af3a732"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga81da80ae3ab1d0a444f39bde2af3a732">&#9670;&#160;</a></span>novas_inv_refract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_inv_refract </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gad4899a6116cfbbe17400e7ef0c8426a9">RefractionModel</a></td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>el0</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the reverse atmospheric refraction for a given refraction model. </p>
<p>Thus if a refraction model takes observed elevation as an input, the reverse refraction takes astrometric elevation as its input, and vice versa.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>The original refraction model </td></tr>
    <tr><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian data of observation </td></tr>
    <tr><td class="paramname">loc</td><td>Pointer to structure defining the observer's location on earth, and local weather </td></tr>
    <tr><td class="paramname">type</td><td>Refraction type to use for the original model: NOVAS_REFRACT_OBSERVED (-1) or NOVAS_REFRACT_ASTROMETRIC (0). </td></tr>
    <tr><td class="paramname">el0</td><td>[deg] input elevation for the inverse refraction model. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] Estimated refraction, or NAN if there was an error (it should also set errno to indicate the type of error).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gafe1d4e96dd66676f5567a279e83e88d9" title="Computes atmospheric optical refraction for a source at an astrometric zenith distance (e....">refract_astro()</a>, <a class="el" href="group__nonequatorial.html#gaef3c1f8e4c443e51e65003018449768a" title="Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zen...">itrs_to_hor()</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>

<p class="reference">References <a class="el" href="util_8c.html#ad2b933ce2f58e8b04bbe76ffbff99eb0">novas_inv_max_iter</a>, and <a class="el" href="#gga8c77758e10b1d3dc8dbd3ab0b694e468a29a320ab3459dafa0d18e7ebef3ae8fe">NOVAS_REFRACT_OBSERVED</a>.</p>

</div>
</div>
<a id="gae4511a80a1defbb1e1fdc29c289e7de4" name="gae4511a80a1defbb1e1fdc29c289e7de4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4511a80a1defbb1e1fdc29c289e7de4">&#9670;&#160;</a></span>novas_optical_refraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_optical_refraction </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>el</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an optical refraction correction using the weather parameters defined for the observer location. </p>
<p>As such, make sure that temperature and pressure are defined, e.g. set after calling e.g. <code><a class="el" href="group__observer.html#gab5fb62a9fb185632175ae622bce28dea" title="Initializes an observing site with the specified GPS / WGS84 location, and sets mean (annual) weather...">make_gps_site()</a></code>, <code><a class="el" href="group__observer.html#ga236750f494f3dcd943e71ba24aa2a55b" title="Initializes an observing site with the specified International Terrestrial Reference Frame (ITRF) / G...">make_itrf_site()</a></code>, <code><a class="el" href="group__observer.html#ga9e3cbe310a40919ff94d2d530ffa74ee" title="Initializes an observing site with the specified Cartesian geocentric xyz location,...">make_xyz_site()</a></code>, or similar call that initializes the observing site.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian data of observation (unused in this implementation of <a class="el" href="#gad4899a6116cfbbe17400e7ef0c8426a9" title="A function that returns a refraction correction for a given date/time of observation at the given sit...">RefractionModel</a>) </td></tr>
    <tr><td class="paramname">loc</td><td>Pointer to structure defining the observer's location on earth, and local weather values (temperature and pressure are used by this call). </td></tr>
    <tr><td class="paramname">type</td><td>Whether the input elevation is observed or astrometric: NOVAS_REFRACT_OBSERVED (-1) or NOVAS_REFRACT_ASTROMETRIC (0). </td></tr>
    <tr><td class="paramname">el</td><td>[deg] Astrometric (unrefracted) source elevation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[arcsec] Estimated refraction, or NAN if there was an error (it should also set errno to indicate the type of error).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4" title="The wavelength-dependent IAU atmospheric refraction model, based on the SOFA iauRefco() function,...">novas_wave_refraction()</a>, <a class="el" href="#ga6b49f92f8f818f2272613e3432185a39" title="Atmospheric refraction model for radio wavelengths (Berman &amp; Rockwell 1976).">novas_radio_refraction()</a>, <a class="el" href="#gab04bff3b97c132e358e11c3a5b7a3081" title="Returns an optical refraction correction for a standard atmosphere.">novas_standard_refraction()</a> </dd>
<dd>
<a class="el" href="#gac7ed2a1a5fb5aea3063d116d3d980eeb" title="Computes atmospheric optical refraction for an observed (already refracted!) zenith distance through ...">refract()</a>, <a class="el" href="#gafe1d4e96dd66676f5567a279e83e88d9" title="Computes atmospheric optical refraction for a source at an astrometric zenith distance (e....">refract_astro()</a> </dd></dl>

<p class="reference">References <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81aaf3bef1a45c5d59df8e779da09cecb68">NOVAS_WEATHER_AT_LOCATION</a>.</p>

</div>
</div>
<a id="ga6b49f92f8f818f2272613e3432185a39" name="ga6b49f92f8f818f2272613e3432185a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6b49f92f8f818f2272613e3432185a39">&#9670;&#160;</a></span>novas_radio_refraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_radio_refraction </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>el</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Atmospheric refraction model for radio wavelengths (Berman &amp; Rockwell 1976). </p>
<p>It uses the weather parameters defined for the location, including humidity. As such, make sure the weather data is fully defined, and that the humidity was explicitly set after calling e.g. <code><a class="el" href="group__observer.html#gab5fb62a9fb185632175ae622bce28dea" title="Initializes an observing site with the specified GPS / WGS84 location, and sets mean (annual) weather...">make_gps_site()</a></code>, <code><a class="el" href="group__observer.html#ga236750f494f3dcd943e71ba24aa2a55b" title="Initializes an observing site with the specified International Terrestrial Reference Frame (ITRF) / G...">make_itrf_site()</a>,</code><a class="el" href="group__observer.html#ga9e3cbe310a40919ff94d2d530ffa74ee" title="Initializes an observing site with the specified Cartesian geocentric xyz location,...">make_xyz_site()</a>`, or similar call that initializes the observing site.</p>
<p>Adapted from FORTAN code provided by Berman &amp; Rockwell 1976.</p>
<p>REFERENCES: </p><ol>
<li>
Berman, Allan L., and Rockwell, Stephen T. (1976), NASA JPL Technical Report 32-1601 </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian data of observation (unused in this implementation of <a class="el" href="#gad4899a6116cfbbe17400e7ef0c8426a9" title="A function that returns a refraction correction for a given date/time of observation at the given sit...">RefractionModel</a>) </td></tr>
    <tr><td class="paramname">loc</td><td>Pointer to structure defining the observer's location on earth, and local weather. Make sure all weather values, including humidity (added in v1.1), are fully populated. </td></tr>
    <tr><td class="paramname">type</td><td>Whether the input elevation is observed or astrometric: NOVAS_REFRACT_OBSERVED (-1) or NOVAS_REFRACT_ASTROMETRIC (0). </td></tr>
    <tr><td class="paramname">el</td><td>[deg] source elevation of the specified type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] Estimated refraction, or NAN if there was an error (it should also set errno to indicate the type of error). An error is returned if the location is NULL, or if the weather parameters are way outside of their resonable ranges, or if the elevation is outside the supported [-1:90] range.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae4511a80a1defbb1e1fdc29c289e7de4" title="Returns an optical refraction correction using the weather parameters defined for the observer locati...">novas_optical_refraction()</a>, <a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4" title="The wavelength-dependent IAU atmospheric refraction model, based on the SOFA iauRefco() function,...">novas_wave_refraction()</a>, <a class="el" href="#gab04bff3b97c132e358e11c3a5b7a3081" title="Returns an optical refraction correction for a standard atmosphere.">novas_standard_refraction()</a> </dd>
<dd>
<a class="el" href="group__observer.html#ga236750f494f3dcd943e71ba24aa2a55b" title="Initializes an observing site with the specified International Terrestrial Reference Frame (ITRF) / G...">make_itrf_site()</a>, <a class="el" href="group__observer.html#gab5fb62a9fb185632175ae622bce28dea" title="Initializes an observing site with the specified GPS / WGS84 location, and sets mean (annual) weather...">make_gps_site()</a>, <a class="el" href="group__observer.html#ga9e3cbe310a40919ff94d2d530ffa74ee" title="Initializes an observing site with the specified Cartesian geocentric xyz location,...">make_xyz_site()</a>, <a class="el" href="group__observer.html#gad8b2d2e6ca9570f09a0ca1f82957ed48" title="Initializes an observer data structure for a ground-based observer with the specified International T...">make_itrf_observer()</a>, <a class="el" href="group__observer.html#gaa2f9fc986f99c1ec7092330dbf233fef" title="Initializes an observer data structure for a ground-based observer with the specified GPS / WGS84 loc...">make_gps_observer()</a> </dd></dl>

<p class="reference">References <a class="el" href="structon__surface.html#a987616dbcfdfc936af3e5874ef5a41e7">on_surface::humidity</a>, <a class="el" href="#ga81da80ae3ab1d0a444f39bde2af3a732">novas_inv_refract()</a>, <a class="el" href="#ga6b49f92f8f818f2272613e3432185a39">novas_radio_refraction()</a>, <a class="el" href="#gga8c77758e10b1d3dc8dbd3ab0b694e468a4255a64975ec93df2f228c63c38096a0">NOVAS_REFRACT_ASTROMETRIC</a>, <a class="el" href="#gga8c77758e10b1d3dc8dbd3ab0b694e468a29a320ab3459dafa0d18e7ebef3ae8fe">NOVAS_REFRACT_OBSERVED</a>, <a class="el" href="structon__surface.html#aee1c5d07ac79c5c036195858afe33405">on_surface::pressure</a>, and <a class="el" href="structon__surface.html#ab4b11c8d9c758430960896bc3fe82ead">on_surface::temperature</a>.</p>

</div>
</div>
<a id="gac673c4fef94847b796dc2aa2f4d0807d" name="gac673c4fef94847b796dc2aa2f4d0807d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac673c4fef94847b796dc2aa2f4d0807d">&#9670;&#160;</a></span>novas_refract_wavelength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_refract_wavelength </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>microns</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the observing wavelength for which refraction is to be calculated when using a wavelength-depenendent model, such as <a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4" title="The wavelength-dependent IAU atmospheric refraction model, based on the SOFA iauRefco() function,...">novas_wave_refraction()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">microns</td><td>[&mu;m] Observed wavelength to assume in refraction calculations </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 (errno set to <code>EINVAL</code>) if the wavelength invalid (zero, negative, or NaN).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.4 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4" title="The wavelength-dependent IAU atmospheric refraction model, based on the SOFA iauRefco() function,...">novas_wave_refraction()</a>, <a class="el" href="refract_8c.html#a4f7dee9d4c9db4cf201af8383c72d4db" title="[Î¼m] Median wavelength of visible light.">NOVAS_DEFAULT_WAVELENGTH</a> </dd></dl>

</div>
</div>
<a id="gab04bff3b97c132e358e11c3a5b7a3081" name="gab04bff3b97c132e358e11c3a5b7a3081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab04bff3b97c132e358e11c3a5b7a3081">&#9670;&#160;</a></span>novas_standard_refraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_standard_refraction </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>el</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an optical refraction correction for a standard atmosphere. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian data of observation (unused in this implementation of <a class="el" href="#gad4899a6116cfbbe17400e7ef0c8426a9" title="A function that returns a refraction correction for a given date/time of observation at the given sit...">RefractionModel</a>) </td></tr>
    <tr><td class="paramname">loc</td><td>Pointer to structure defining the observer's location on earth, and local weather </td></tr>
    <tr><td class="paramname">type</td><td>Whether the input elevation is observed or astrometric: NOVAS_REFRACT_OBSERVED (-1) or NOVAS_REFRACT_ASTROMETRIC (0). </td></tr>
    <tr><td class="paramname">el</td><td>[deg] Astrometric (unrefracted) source elevation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] Estimated refraction, or NAN if there was an error (it should also set errno to indicate the type of error).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae4511a80a1defbb1e1fdc29c289e7de4" title="Returns an optical refraction correction using the weather parameters defined for the observer locati...">novas_optical_refraction()</a>, <a class="el" href="#ga6b49f92f8f818f2272613e3432185a39" title="Atmospheric refraction model for radio wavelengths (Berman &amp; Rockwell 1976).">novas_radio_refraction()</a>, <a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4" title="The wavelength-dependent IAU atmospheric refraction model, based on the SOFA iauRefco() function,...">novas_wave_refraction()</a> </dd>
<dd>
<a class="el" href="#gac7ed2a1a5fb5aea3063d116d3d980eeb" title="Computes atmospheric optical refraction for an observed (already refracted!) zenith distance through ...">refract()</a>, <a class="el" href="#gafe1d4e96dd66676f5567a279e83e88d9" title="Computes atmospheric optical refraction for a source at an astrometric zenith distance (e....">refract_astro()</a> </dd></dl>

<p class="reference">References <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81a7ed64c314f06fdf9acfa72beb531e73d">NOVAS_STANDARD_ATMOSPHERE</a>.</p>

</div>
</div>
<a id="ga7b9ad6dfbd86e4faa2d8068c7d64fac4" name="ga7b9ad6dfbd86e4faa2d8068c7d64fac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4">&#9670;&#160;</a></span>novas_wave_refraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_wave_refraction </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *</td>          <td class="paramname"><span class="paramname"><em>loc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#ga8c77758e10b1d3dc8dbd3ab0b694e468">novas_refraction_type</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>el</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The wavelength-dependent IAU atmospheric refraction model, based on the SOFA <code>iauRefco()</code> function, in compliance to the 'SOFA Software License' terms of the original source. </p>
<p>Our implementation is not provided nor it is endorsed by SOFA. The original function has been modified slightly, such as:</p>
<ol>
<li>
Out-of-range weather parameters will return with an error (<code>errno</code> set to <code>EINVAL</code>), unlike the SOFA implementation, which sets minimal or maximal allowed values for these. </li>
<li>
The algorithm has been simplified to use fewer variables and simpler logic. </li>
<li>
The SOFA function this implementation is based on returns A/B coefficients, whereas this implementation returns the refraction correction angle. </li>
</ol>
<p>The refraction is calculated for the observing wavelenth previously set via <code><a class="el" href="#gac673c4fef94847b796dc2aa2f4d0807d" title="Sets the observing wavelength for which refraction is to be calculated when using a wavelength-depene...">novas_refract_wavelength()</a></code>, or for visible light at 550 nm by default.</p>
<p>The function uses the weather parameters defined for the location, including humidity. As such, make sure the weather data is fully defined, and that the humidity was explicitly set after calling e.g. <code><a class="el" href="group__observer.html#gab5fb62a9fb185632175ae622bce28dea" title="Initializes an observing site with the specified GPS / WGS84 location, and sets mean (annual) weather...">make_gps_site()</a></code>, <code><a class="el" href="group__observer.html#ga236750f494f3dcd943e71ba24aa2a55b" title="Initializes an observing site with the specified International Terrestrial Reference Frame (ITRF) / G...">make_itrf_site()</a>,</code><a class="el" href="group__observer.html#ga9e3cbe310a40919ff94d2d530ffa74ee" title="Initializes an observing site with the specified Cartesian geocentric xyz location,...">make_xyz_site()</a>`, or similar call that initializes the observing site.</p>
<p>According to the documentation of SOFA's <code>iauRefco()</code> function, the model has the following accuracy for elevation angles between 15 and 75 degrees, under a range of typical surface conditions:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadCenter">worst   </th><th class="markdownTableHeadCenter">RMS    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">optical/IR   </td><td class="markdownTableBodyCenter">62 mas   </td><td class="markdownTableBodyCenter">8 mas    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">radio   </td><td class="markdownTableBodyCenter">319 mas   </td><td class="markdownTableBodyCenter">49 mas   </td></tr>
</table>
<p>NOTES: </p><ol>
<li>
From the SOFA documentation: "The model balances speed and accuracy to give good results in
applications where performance at low altitudes is not paramount. Performance is maintained
across a range of conditions, and applies to both optical/IR and radio."  </li>
<li>
The model is divergent in the observed direction of the horizon. As such, it should not be used for calculating refraction at or below the horizon itself. </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Crane, R.K., Meeks, M.L. (ed), "Refraction Effects in the Neutral
    Atmosphere", Methods of Experimental Physics: Astrophysics 12B, Academic Press, 1976.  </li>
<li>
Gill, Adrian E., "Atmosphere-Ocean Dynamics", Academic Press, 1982.  </li>
<li>
Green, R.M., "Spherical Astronomy", Cambridge University Press, 1987.  </li>
<li>
Hohenkerk, C.Y., &amp; Sinclair, A.T., NAO Technical Note No. 63, 1985.  </li>
<li>
Rueger, J.M., "Refractive Index Formulae for Electronic Distance
    Measurement with Radio and Millimetre Waves", in Unisurv Report S-68, School of Surveying and Spatial Information Systems, University of New South Wales, Sydney, Australia, 2002.  </li>
<li>
Stone, Ronald C., P.A.S.P. 108, 1051-1058, 1996.  </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian data of observation (unused in this implementation of <a class="el" href="#gad4899a6116cfbbe17400e7ef0c8426a9" title="A function that returns a refraction correction for a given date/time of observation at the given sit...">RefractionModel</a>) </td></tr>
    <tr><td class="paramname">loc</td><td>Pointer to structure defining the observer's location on earth, and local weather. Make sure all weather values, including humidity (added in v1.1), are fully populated. </td></tr>
    <tr><td class="paramname">type</td><td>Whether the input elevation is observed or astrometric: NOVAS_REFRACT_OBSERVED (-1) or NOVAS_REFRACT_ASTROMETRIC (0). </td></tr>
    <tr><td class="paramname">el</td><td>[deg] observed source elevation of the specified type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] Estimated refraction, or NAN if there was an error (it should also set errno to indicate the type of error), e.g. because the location is NULL, or because the weather parameters are outside of the supported (sensible) range, or because the elevation is outside of the supported (0:90] range, or because the wavelength set is below 100 nm (0.1 &mu;m);</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.4 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gac673c4fef94847b796dc2aa2f4d0807d" title="Sets the observing wavelength for which refraction is to be calculated when using a wavelength-depene...">novas_refract_wavelength()</a>, <a class="el" href="#gae4511a80a1defbb1e1fdc29c289e7de4" title="Returns an optical refraction correction using the weather parameters defined for the observer locati...">novas_optical_refraction()</a>, <a class="el" href="#ga6b49f92f8f818f2272613e3432185a39" title="Atmospheric refraction model for radio wavelengths (Berman &amp; Rockwell 1976).">novas_radio_refraction()</a> </dd>
<dd>
<a class="el" href="group__observer.html#gab5fb62a9fb185632175ae622bce28dea" title="Initializes an observing site with the specified GPS / WGS84 location, and sets mean (annual) weather...">make_gps_site()</a>, <a class="el" href="group__observer.html#ga236750f494f3dcd943e71ba24aa2a55b" title="Initializes an observing site with the specified International Terrestrial Reference Frame (ITRF) / G...">make_itrf_site()</a>, <a class="el" href="group__observer.html#ga9e3cbe310a40919ff94d2d530ffa74ee" title="Initializes an observing site with the specified Cartesian geocentric xyz location,...">make_xyz_site()</a>, <a class="el" href="group__observer.html#gaa2f9fc986f99c1ec7092330dbf233fef" title="Initializes an observer data structure for a ground-based observer with the specified GPS / WGS84 loc...">make_gps_observer()</a>, <a class="el" href="group__observer.html#gad8b2d2e6ca9570f09a0ca1f82957ed48" title="Initializes an observer data structure for a ground-based observer with the specified International T...">make_itrf_observer()</a> </dd></dl>

<p class="reference">References <a class="el" href="structon__surface.html#a987616dbcfdfc936af3e5874ef5a41e7">on_surface::humidity</a>, <a class="el" href="#ga81da80ae3ab1d0a444f39bde2af3a732">novas_inv_refract()</a>, <a class="el" href="#gga8c77758e10b1d3dc8dbd3ab0b694e468a4255a64975ec93df2f228c63c38096a0">NOVAS_REFRACT_ASTROMETRIC</a>, <a class="el" href="#gga8c77758e10b1d3dc8dbd3ab0b694e468a29a320ab3459dafa0d18e7ebef3ae8fe">NOVAS_REFRACT_OBSERVED</a>, <a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4">novas_wave_refraction()</a>, <a class="el" href="structon__surface.html#aee1c5d07ac79c5c036195858afe33405">on_surface::pressure</a>, and <a class="el" href="structon__surface.html#ab4b11c8d9c758430960896bc3fe82ead">on_surface::temperature</a>.</p>

</div>
</div>
<a id="gac7ed2a1a5fb5aea3063d116d3d980eeb" name="gac7ed2a1a5fb5aea3063d116d3d980eeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac7ed2a1a5fb5aea3063d116d3d980eeb">&#9670;&#160;</a></span>refract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double refract </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>location</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#gabe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a></td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>zd_obs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes atmospheric optical refraction for an observed (already refracted!) zenith distance through the atmosphere. </p>
<p>In other words this is suitable to convert refracted zenith angles to astrometric (unrefracted) zenith angles. For the reverse, see <a class="el" href="#gafe1d4e96dd66676f5567a279e83e88d9" title="Computes atmospheric optical refraction for a source at an astrometric zenith distance (e....">refract_astro()</a>.</p>
<p>The returned value is the approximate refraction for optical wavelengths. This function can be used for planning observations or telescope pointing, but should not be used for precise positioning.</p>
<p>NOTES: </p><ol>
<li>
The standard temeperature model includes a very rough estimate of the mean annual temeprature for the ovserver's latitude and elevation, rather than the 10 C everywhere assumption in NOVAS C 3.1.&lt;.li&gt; </li>
</ol>
<p>REFERENCES: </p><ol>
<li>
Explanatory Supplement to the Astronomical Almanac, p. 144. </li>
<li>
Bennett, G. (1982), Journal of Navigation (Royal Institute) 35, pp. 255-259. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">location</td><td>Pointer to structure containing observer's location. It may also contains weather data (optional) for the observer's location. Some, but not all, refraction models will use location-based (e.g. weather) information. For models that do not need it, it may be NULL. </td></tr>
    <tr><td class="paramname">model</td><td>The built in refraction model to use. E.g. NOVAS_STANDARD_ATMOSPHERE (1), or NOVAS_WEATHER_AT_LOCATION (2)... </td></tr>
    <tr><td class="paramname">zd_obs</td><td>[deg] Observed (already refracted!) zenith distance through the atmosphere. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] the calculated optical refraction or 0.0 if the location is NULL or the option is invalid or the 'zd_obs' is invalid (&lt;90&deg;).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gafe1d4e96dd66676f5567a279e83e88d9" title="Computes atmospheric optical refraction for a source at an astrometric zenith distance (e....">refract_astro()</a>, <a class="el" href="group__nonequatorial.html#ga19f4f6c7d942dcba5ad2a4d2a60affad" title="Converts astrometric (unrefracted) azimuth and zenith angles at the specified observer location to a ...">hor_to_itrs()</a> </dd></dl>

<p class="reference">References <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81ace535f58f84fa374a973aa9d4e6a52e8">NOVAS_NO_ATMOSPHERE</a>, <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81a165a8cec5e4cd5aeb6f26530022a4761">NOVAS_RADIO_REFRACTION</a>, <a class="el" href="#ga6b49f92f8f818f2272613e3432185a39">novas_radio_refraction()</a>, <a class="el" href="#gga8c77758e10b1d3dc8dbd3ab0b694e468a29a320ab3459dafa0d18e7ebef3ae8fe">NOVAS_REFRACT_OBSERVED</a>, <a class="el" href="novas_8h.html#a1932e30210aa533136e5848089adf492">NOVAS_REFRACTION_MODELS</a>, <a class="el" href="group__observer.html#ga0fc8f315f8606e09571ab49efb13baca">novas_set_default_weather()</a>, <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81a75c80913155eddef17af869d6b0d62f6">NOVAS_WAVE_REFRACTION</a>, <a class="el" href="#ga7b9ad6dfbd86e4faa2d8068c7d64fac4">novas_wave_refraction()</a>, <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81aaf3bef1a45c5d59df8e779da09cecb68">NOVAS_WEATHER_AT_LOCATION</a>, <a class="el" href="structon__surface.html#aee1c5d07ac79c5c036195858afe33405">on_surface::pressure</a>, and <a class="el" href="structon__surface.html#ab4b11c8d9c758430960896bc3fe82ead">on_surface::temperature</a>.</p>

</div>
</div>
<a id="gafe1d4e96dd66676f5567a279e83e88d9" name="gafe1d4e96dd66676f5567a279e83e88d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafe1d4e96dd66676f5567a279e83e88d9">&#9670;&#160;</a></span>refract_astro()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double refract_astro </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>location</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#gabe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a></td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>zd_astro</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes atmospheric optical refraction for a source at an astrometric zenith distance (e.g. </p>
<p>calculated without accounting for an atmosphere). This is suitable for converting astrometric (unrefracted) zenith angles to observed (refracted) zenith angles. See <a class="el" href="#gac7ed2a1a5fb5aea3063d116d3d980eeb" title="Computes atmospheric optical refraction for an observed (already refracted!) zenith distance through ...">refract()</a> for the reverse correction.</p>
<p>The returned value is the approximate refraction for optical wavelengths. This function can be used for planning observations or telescope pointing, but should not be used for precise positioning.</p>
<p>REFERENCES: </p><ol>
<li>
Explanatory Supplement to the Astronomical Almanac, p. 144. </li>
<li>
Bennett, G. (1982), Journal of Navigation (Royal Institute) 35, pp. 255-259. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">location</td><td>Pointer to structure containing observer's location. It may also contains weather data (optional) for the observer's location. Some, but not all, refraction models will use location-based (e.g. weather) information. For models that do not need it, it may be NULL. </td></tr>
    <tr><td class="paramname">model</td><td>The built in refraction model to use. E.g. NOVAS_STANDARD_ATMOSPHERE (1), or NOVAS_WEATHER_AT_LOCATION (2)... </td></tr>
    <tr><td class="paramname">zd_astro</td><td>[deg] Astrometric (unrefracted) zenith distance angle of the source. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] the calculated optical refraction. (to ~0.1 arcsec accuracy), or 0.0 if the location is NULL or the option is invalid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gac7ed2a1a5fb5aea3063d116d3d980eeb" title="Computes atmospheric optical refraction for an observed (already refracted!) zenith distance through ...">refract()</a>, <a class="el" href="group__nonequatorial.html#gaef3c1f8e4c443e51e65003018449768a" title="Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zen...">itrs_to_hor()</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs </dd></dl>

<p class="reference">References <a class="el" href="util_8c.html#ad2b933ce2f58e8b04bbe76ffbff99eb0">novas_inv_max_iter</a>, <a class="el" href="#ggabe97e2d459a30db9d0f67d8c60af3b81a165a8cec5e4cd5aeb6f26530022a4761">NOVAS_RADIO_REFRACTION</a>, <a class="el" href="#ga6b49f92f8f818f2272613e3432185a39">novas_radio_refraction()</a>, <a class="el" href="#gga8c77758e10b1d3dc8dbd3ab0b694e468a4255a64975ec93df2f228c63c38096a0">NOVAS_REFRACT_ASTROMETRIC</a>, and <a class="el" href="#gac7ed2a1a5fb5aea3063d116d3d980eeb">refract()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
