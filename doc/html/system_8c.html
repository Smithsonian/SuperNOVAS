<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuperNOVAS: /github/workspace/src/system.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('system_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">system.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Various transformations between different coordinate systems used in astronomy, such as equatorial, ecliptic, Galactic, or local horizontal coordinate systems.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga41ca0cfd79ad07c9e857ba02fa94928e" id="r_ga41ca0cfd79ad07c9e857ba02fa94928e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga41ca0cfd79ad07c9e857ba02fa94928e">ecl2equ</a> (double jd_tt, enum <a class="el" href="group__earth.html#ga2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a> coord_sys, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double elon, double elat, double *restrict ra, double *restrict dec)</td></tr>
<tr class="memdesc:ga41ca0cfd79ad07c9e857ba02fa94928e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert ecliptic longitude and latitude to right ascension and declination.  <br /></td></tr>
<tr class="separator:ga41ca0cfd79ad07c9e857ba02fa94928e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6fa1eada41005ac70290d0bb5df1ec26" id="r_ga6fa1eada41005ac70290d0bb5df1ec26"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga6fa1eada41005ac70290d0bb5df1ec26">ecl2equ_vec</a> (double jd_tt, enum <a class="el" href="group__earth.html#ga2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a> coord_sys, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const double *in, double *out)</td></tr>
<tr class="memdesc:ga6fa1eada41005ac70290d0bb5df1ec26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an ecliptic position vector to an equatorial position vector.  <br /></td></tr>
<tr class="separator:ga6fa1eada41005ac70290d0bb5df1ec26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga035047336b16951b8b850066e74210a9" id="r_ga035047336b16951b8b850066e74210a9"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga035047336b16951b8b850066e74210a9">equ2ecl</a> (double jd_tt, enum <a class="el" href="group__earth.html#ga2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a> coord_sys, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double ra, double dec, double *restrict elon, double *restrict elat)</td></tr>
<tr class="memdesc:ga035047336b16951b8b850066e74210a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert right ascension and declination to ecliptic longitude and latitude.  <br /></td></tr>
<tr class="separator:ga035047336b16951b8b850066e74210a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa05ecc76c1ccc0c3445f8b642d6c5311" id="r_gaa05ecc76c1ccc0c3445f8b642d6c5311"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#gaa05ecc76c1ccc0c3445f8b642d6c5311">equ2ecl_vec</a> (double jd_tt, enum <a class="el" href="group__earth.html#ga2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a> coord_sys, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const double *in, double *out)</td></tr>
<tr class="memdesc:gaa05ecc76c1ccc0c3445f8b642d6c5311"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an equatorial position vector to an ecliptic position vector.  <br /></td></tr>
<tr class="separator:gaa05ecc76c1ccc0c3445f8b642d6c5311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga288b49c03bc29704c8dd5acf8baca80e" id="r_ga288b49c03bc29704c8dd5acf8baca80e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga288b49c03bc29704c8dd5acf8baca80e">equ2gal</a> (double ra, double dec, double *restrict glon, double *restrict glat)</td></tr>
<tr class="memdesc:ga288b49c03bc29704c8dd5acf8baca80e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts ICRS right ascension and declination to galactic longitude and latitude.  <br /></td></tr>
<tr class="separator:ga288b49c03bc29704c8dd5acf8baca80e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad932a8617973ef06e4a5c955b7897bb0" id="r_ad932a8617973ef06e4a5c955b7897bb0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad932a8617973ef06e4a5c955b7897bb0">equ2hor</a> (double jd_ut1, double ut1_to_tt, enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double xp, double yp, const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, double ra, double dec, enum <a class="el" href="group__refract.html#gabe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a> ref_option, double *restrict zd, double *restrict az, double *restrict rar, double *restrict decr)</td></tr>
<tr class="separator:ad932a8617973ef06e4a5c955b7897bb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadcce501bd3f8f70974e7f55527162f83" id="r_gadcce501bd3f8f70974e7f55527162f83"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#gadcce501bd3f8f70974e7f55527162f83">gal2equ</a> (double glon, double glat, double *restrict ra, double *restrict dec)</td></tr>
<tr class="memdesc:gadcce501bd3f8f70974e7f55527162f83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts galactic longitude and latitude to ICRS right ascension and declination.  <br /></td></tr>
<tr class="separator:gadcce501bd3f8f70974e7f55527162f83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19f4f6c7d942dcba5ad2a4d2a60affad" id="r_ga19f4f6c7d942dcba5ad2a4d2a60affad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga19f4f6c7d942dcba5ad2a4d2a60affad">hor_to_itrs</a> (const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, double az, double za, double *restrict itrs)</td></tr>
<tr class="memdesc:ga19f4f6c7d942dcba5ad2a4d2a60affad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts astrometric (unrefracted) azimuth and zenith angles at the specified observer location to a unit position vector in the Earth-fixed ITRS frame.  <br /></td></tr>
<tr class="separator:ga19f4f6c7d942dcba5ad2a4d2a60affad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef3c1f8e4c443e51e65003018449768a" id="r_gaef3c1f8e4c443e51e65003018449768a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#gaef3c1f8e4c443e51e65003018449768a">itrs_to_hor</a> (const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, const double *restrict itrs, double *restrict az, double *restrict za)</td></tr>
<tr class="memdesc:gaef3c1f8e4c443e51e65003018449768a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zenith angles at the specified observer location.  <br /></td></tr>
<tr class="separator:gaef3c1f8e4c443e51e65003018449768a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13cd0b80eaa7bc682013f7e8ffbdbd6f" id="r_ga13cd0b80eaa7bc682013f7e8ffbdbd6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga13cd0b80eaa7bc682013f7e8ffbdbd6f">novas_e2h_offset</a> (double dra, double ddec, double pa, double *restrict daz, double *restrict del)</td></tr>
<tr class="memdesc:ga13cd0b80eaa7bc682013f7e8ffbdbd6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts coordinate offsets, from the local equatorial system to local horizontal offsets.  <br /></td></tr>
<tr class="separator:ga13cd0b80eaa7bc682013f7e8ffbdbd6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga095ba0ee644dc00c11dcdc5616bc96b0" id="r_ga095ba0ee644dc00c11dcdc5616bc96b0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga095ba0ee644dc00c11dcdc5616bc96b0">novas_epa</a> (double ha, double dec, double lat)</td></tr>
<tr class="memdesc:ga095ba0ee644dc00c11dcdc5616bc96b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Parallactic Angle (PA) calculated for an RA/Dec location of the sky at a given sidereal time.  <br /></td></tr>
<tr class="separator:ga095ba0ee644dc00c11dcdc5616bc96b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7977de3e3edf8120b50cbd026c155f47" id="r_ga7977de3e3edf8120b50cbd026c155f47"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga7977de3e3edf8120b50cbd026c155f47">novas_h2e_offset</a> (double daz, double del, double pa, double *restrict dra, double *restrict ddec)</td></tr>
<tr class="memdesc:ga7977de3e3edf8120b50cbd026c155f47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts coordinate offsets, from the local horizontal system to local equatorial offsets.  <br /></td></tr>
<tr class="separator:ga7977de3e3edf8120b50cbd026c155f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73fcb54e47b2be0aa92810b5f55f7a3c" id="r_ga73fcb54e47b2be0aa92810b5f55f7a3c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga73fcb54e47b2be0aa92810b5f55f7a3c">novas_hpa</a> (double az, double el, double lat)</td></tr>
<tr class="memdesc:ga73fcb54e47b2be0aa92810b5f55f7a3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Parallactic Angle (PA) calculated for a horizontal Az/El location of the sky.  <br /></td></tr>
<tr class="separator:ga73fcb54e47b2be0aa92810b5f55f7a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga601d246673742cf72a5dbe1449c97560" id="r_ga601d246673742cf72a5dbe1449c97560"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga601d246673742cf72a5dbe1449c97560">novas_los_to_xyz</a> (const double *los, double lon, double lat, double *xyz)</td></tr>
<tr class="memdesc:ga601d246673742cf72a5dbe1449c97560"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a 3D line-of-sight vector (&delta;&phi;, &delta;&theta; &delta;r) to a rectangular equatorial (&delta;x, &delta;y, &delta;z) vector.  <br /></td></tr>
<tr class="separator:ga601d246673742cf72a5dbe1449c97560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga16c920eee105431247e9a1d9bf1c3021" id="r_ga16c920eee105431247e9a1d9bf1c3021"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga16c920eee105431247e9a1d9bf1c3021">novas_uvw_to_xyz</a> (const double *uvw, double ha, double dec, double *xyz)</td></tr>
<tr class="memdesc:ga16c920eee105431247e9a1d9bf1c3021"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts equatorial u,v,w projected (absolute or relative) coordinates to rectangular telescope x,y,z coordinates (in ITRS) to for a specified line of sight.  <br /></td></tr>
<tr class="separator:ga16c920eee105431247e9a1d9bf1c3021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14deb6fdce80ba213e1f1d5238306e17" id="r_ga14deb6fdce80ba213e1f1d5238306e17"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga14deb6fdce80ba213e1f1d5238306e17">novas_xyz_to_los</a> (const double *xyz, double lon, double lat, double *los)</td></tr>
<tr class="memdesc:ga14deb6fdce80ba213e1f1d5238306e17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a 3D rectangular equatorial (&delta;x, &delta;y, &delta;z) vector to a polar (&delta;&phi;, &delta;&theta; &delta;r) vector along a line-of-sight.  <br /></td></tr>
<tr class="separator:ga14deb6fdce80ba213e1f1d5238306e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87867e8e7fc7decaa44777a696465353" id="r_ga87867e8e7fc7decaa44777a696465353"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__nonequatorial.html#ga87867e8e7fc7decaa44777a696465353">novas_xyz_to_uvw</a> (const double *xyz, double ha, double dec, double *uvw)</td></tr>
<tr class="memdesc:ga87867e8e7fc7decaa44777a696465353"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts rectangular telescope x,y,z (absolute or relative) coordinates (in ITRS) to equatorial u,v,w projected coordinates for a specified line of sight.  <br /></td></tr>
<tr class="separator:ga87867e8e7fc7decaa44777a696465353"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Various transformations between different coordinate systems used in astronomy, such as equatorial, ecliptic, Galactic, or local horizontal coordinate systems. </p>
<p>This module also provides functions otherwise relating to the observer locations.</p>
<p>For Earth-based geodetic locations, the module provides a set of functions to convert between various (local) coordinate systems. For example, calculating parallactic angles (a.k.a. vertical position angle or VPA), for converting between horizontal and equatorial offsets, and various functions for converting equatorial vectors to a line-of-sight, or <em>u</em>, <em>v</em>, <em>w</em> coordinate bases, and vice-versa.</p>
<dl class="section date"><dt>Date</dt><dd>Created on Mar 5, 2025 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs and G. Kaplan</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="frames_8c.html" title="High-level and efficient astrometric calculations using observing frames.">frames.c</a>, <a class="el" href="transform_8c.html" title="Various functions to transform rectangular equatorial vectors (positions or velocities) between diffe...">transform.c</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad932a8617973ef06e4a5c955b7897bb0" name="ad932a8617973ef06e4a5c955b7897bb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad932a8617973ef06e4a5c955b7897bb0">&#9670;&#160;</a></span>equ2hor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int equ2hor </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_ut1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ut1_to_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__frame.html#ga3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>xp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>yp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>location</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__refract.html#gabe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a></td>          <td class="paramname"><span class="paramname"><em>ref_option</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>zd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>az</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>rar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>decr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000014">Deprecated</a></b></dt><dd>You should use the frame-based <code><a class="el" href="group__apparent.html#ga3cd947f2e48d6c5cc88ad7a1bab9b8ca" title="Converts an observed apparent position vector in the specified coordinate system to local horizontal ...">novas_app_to_hor()</a></code> instead, or else the more explicit (less ambiguous) <code><a class="el" href="group__equatorial.html#ga4551e2ac083e34c1b2b61b3805efb9a3" title="Rotates a position vector from the dynamical True of Date (TOD) frame of date the Earth-fixed ITRS fr...">tod_to_itrs()</a></code> followed by <code><a class="el" href="group__nonequatorial.html#gaef3c1f8e4c443e51e65003018449768a" title="Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zen...">itrs_to_hor()</a></code>, and possibly following it with an atmospheric refraction correction if appropriate.</dd></dl>
<p>Transforms topocentric (TOD) apparent right ascension and declination to zenith distance and azimuth. This method should not be used to convert CIRS apparent coordinates (IAU 2000 standard) &ndash; for those you should use <a class="el" href="group__equatorial.html#gaa2768d89d499a7155f90a6fd8c176d8d" title="Rotates a position vector from the dynamical CIRS frame of date to the Earth-fixed ITRS frame (IAU 20...">cirs_to_itrs()</a> followed by <a class="el" href="group__nonequatorial.html#gaef3c1f8e4c443e51e65003018449768a" title="Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zen...">itrs_to_hor()</a> instead.</p>
<p>It uses a method that properly accounts for polar motion, which is significant at the sub-arcsecond level. This function can also adjust coordinates for atmospheric refraction.</p>
<p>NOTES: </p><ul>
<li>
'xp' and 'yp' can be set to zero if sub-arcsecond accuracy is not needed. </li>
<li>
The directions 'zd'= 0 (zenith) and 'az'= 0 (north) are here considered fixed in the terrestrial system. Specifically, the zenith is along the geodetic normal, and north is toward the ITRS pole. </li>
<li>
If 'ref_option' is NOVAS_STANDARD_ATMOSPHERE (1), then 'rar'='ra' and 'decr'='dec'. </li>
</ul>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. (2008). USNO/AA Technical Note of 28 Apr 2008, "Refraction as a Vector." </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_ut1</td><td>[day] UT1 based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ut1_to_tt</td><td>[s] TT - UT1 Time difference in seconds </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">xp</td><td>[arcsec] Conventionally-defined x coordinate of celestial intermediate pole with respect to ITRS reference pole, e.g. from IERS Bulletin A. If you have defined pole offsets to be incorporated into the TOD input coordinates (pre-IAU2000 method) via <code><a class="el" href="equator_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a></code>, then you should set this to 0. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">yp</td><td>[arcsec] Conventionally-defined y coordinate of celestial intermediate pole with respect to ITRS reference pole, e.g. from IERS Bulletin A. If you have defined pole offsets to be incorporated into the TOD input coordinates (pre-IAU2000 method) via <code><a class="el" href="equator_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a></code>, then you should set this to 0. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">location</td><td>Geodetic (ITRF / GRS80) observer location on Earth </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ra</td><td>[h] Topocentric apparent (TOD) right ascension of object of interest, referred to true equator and equinox of date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dec</td><td>[deg] Topocentric apparent (TOD) declination of object of interest, referred to true equator and equinox of date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ref_option</td><td>Refraction model to use. E.g., NOVAS_STANDARD_ATMOSPHERE (1), or NOVAS_WEATHER_AT_LOCATION (2) if to use the weather. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">zd</td><td>[deg] Topocentric zenith distance in degrees (unrefracted). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">az</td><td>[deg] Topocentric azimuth (measured east from north) in degrees. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rar</td><td>[h] Topocentric right ascension of object of interest, in hours, referred to true equator and equinox of date, affected by refraction if 'ref_option' is non-zero. (It may be NULL if not required) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decr</td><td>[deg] Topocentric declination of object of interest, in degrees, referred to true equator and equinox of date. (It may be NULL if not required) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if one of the 'zd' or 'az' output pointers are NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__nonequatorial.html#gaef3c1f8e4c443e51e65003018449768a" title="Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zen...">itrs_to_hor()</a>, <a class="el" href="group__equatorial.html#ga4551e2ac083e34c1b2b61b3805efb9a3" title="Rotates a position vector from the dynamical True of Date (TOD) frame of date the Earth-fixed ITRS fr...">tod_to_itrs()</a>, <a class="el" href="group__equatorial.html#gga7ba038ea34eb901ccfb8f785708c651eaa4bcd4fdb15ba77023241689a5608df3" title="True equinox Of Date: dynamical system of the &#39;true&#39; equator, with its origin at the &#39;true&#39; equinox (...">NOVAS_TOD</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a9e882d9c9055f187d3a8dc9b019f0609a1d56a4fb59b567049ed1937bfcdf0f62">EROT_GST</a>, <a class="el" href="novas_8h.html#a3789b2c39c26f01bb1bffe8ebc953467aba4a23444c495f90061ec1a906585faa">NOVAS_DYNAMICAL_CLASS</a>, <a class="el" href="group__refract.html#gafe1d4e96dd66676f5567a279e83e88d9">refract_astro()</a>, and <a class="el" href="transform_8c.html#ac8c5ff3cc13126aba2ec5a6cbe187a31">ter2cel()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="system_8c.html">system.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
