<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuperNOVAS: /github/workspace/src/system.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">SuperNOVAS<span id="projectnumber">&#160;v1.5</span>
   </div>
   <div id="projectbrief">The NOVAS C library, made better</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('system_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">system.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Various transformations between different coordinate systems used in astronomy, such as equatorial, ecliptic, Galactic, or local horizontal coordinate systems.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a41ca0cfd79ad07c9e857ba02fa94928e" id="r_a41ca0cfd79ad07c9e857ba02fa94928e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41ca0cfd79ad07c9e857ba02fa94928e">ecl2equ</a> (double jd_tt, enum <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a> coord_sys, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double elon, double elat, double *restrict ra, double *restrict dec)</td></tr>
<tr class="memdesc:a41ca0cfd79ad07c9e857ba02fa94928e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert ecliptic longitude and latitude to right ascension and declination.  <br /></td></tr>
<tr class="separator:a41ca0cfd79ad07c9e857ba02fa94928e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fa1eada41005ac70290d0bb5df1ec26" id="r_a6fa1eada41005ac70290d0bb5df1ec26"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6fa1eada41005ac70290d0bb5df1ec26">ecl2equ_vec</a> (double jd_tt, enum <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a> coord_sys, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const double *in, double *out)</td></tr>
<tr class="memdesc:a6fa1eada41005ac70290d0bb5df1ec26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an ecliptic position vector to an equatorial position vector.  <br /></td></tr>
<tr class="separator:a6fa1eada41005ac70290d0bb5df1ec26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a035047336b16951b8b850066e74210a9" id="r_a035047336b16951b8b850066e74210a9"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a035047336b16951b8b850066e74210a9">equ2ecl</a> (double jd_tt, enum <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a> coord_sys, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double ra, double dec, double *restrict elon, double *restrict elat)</td></tr>
<tr class="memdesc:a035047336b16951b8b850066e74210a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert right ascension and declination to ecliptic longitude and latitude.  <br /></td></tr>
<tr class="separator:a035047336b16951b8b850066e74210a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa05ecc76c1ccc0c3445f8b642d6c5311" id="r_aa05ecc76c1ccc0c3445f8b642d6c5311"><td class="memItemLeft" align="right" valign="top">short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa05ecc76c1ccc0c3445f8b642d6c5311">equ2ecl_vec</a> (double jd_tt, enum <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a> coord_sys, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, const double *in, double *out)</td></tr>
<tr class="memdesc:aa05ecc76c1ccc0c3445f8b642d6c5311"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an equatorial position vector to an ecliptic position vector.  <br /></td></tr>
<tr class="separator:aa05ecc76c1ccc0c3445f8b642d6c5311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288b49c03bc29704c8dd5acf8baca80e" id="r_a288b49c03bc29704c8dd5acf8baca80e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a288b49c03bc29704c8dd5acf8baca80e">equ2gal</a> (double ra, double dec, double *restrict glon, double *restrict glat)</td></tr>
<tr class="memdesc:a288b49c03bc29704c8dd5acf8baca80e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts ICRS right ascension and declination to galactic longitude and latitude.  <br /></td></tr>
<tr class="separator:a288b49c03bc29704c8dd5acf8baca80e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad932a8617973ef06e4a5c955b7897bb0" id="r_ad932a8617973ef06e4a5c955b7897bb0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad932a8617973ef06e4a5c955b7897bb0">equ2hor</a> (double jd_ut1, double ut1_to_tt, enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a> accuracy, double xp, double yp, const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, double ra, double dec, enum <a class="el" href="novas_8h.html#abe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a> ref_option, double *restrict zd, double *restrict az, double *restrict rar, double *restrict decr)</td></tr>
<tr class="separator:ad932a8617973ef06e4a5c955b7897bb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcce501bd3f8f70974e7f55527162f83" id="r_adcce501bd3f8f70974e7f55527162f83"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adcce501bd3f8f70974e7f55527162f83">gal2equ</a> (double glon, double glat, double *restrict ra, double *restrict dec)</td></tr>
<tr class="memdesc:adcce501bd3f8f70974e7f55527162f83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts galactic longitude and latitude to ICRS right ascension and declination.  <br /></td></tr>
<tr class="separator:adcce501bd3f8f70974e7f55527162f83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19f4f6c7d942dcba5ad2a4d2a60affad" id="r_a19f4f6c7d942dcba5ad2a4d2a60affad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a19f4f6c7d942dcba5ad2a4d2a60affad">hor_to_itrs</a> (const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, double az, double za, double *restrict itrs)</td></tr>
<tr class="memdesc:a19f4f6c7d942dcba5ad2a4d2a60affad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts astrometric (unrefracted) azimuth and zenith angles at the specified observer location to a unit position vector in the Earth-fixed ITRS frame.  <br /></td></tr>
<tr class="separator:a19f4f6c7d942dcba5ad2a4d2a60affad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef3c1f8e4c443e51e65003018449768a" id="r_aef3c1f8e4c443e51e65003018449768a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef3c1f8e4c443e51e65003018449768a">itrs_to_hor</a> (const <a class="el" href="structon__surface.html">on_surface</a> *restrict location, const double *restrict itrs, double *restrict az, double *restrict za)</td></tr>
<tr class="memdesc:aef3c1f8e4c443e51e65003018449768a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zenith angles at the specified observer location.  <br /></td></tr>
<tr class="separator:aef3c1f8e4c443e51e65003018449768a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13cd0b80eaa7bc682013f7e8ffbdbd6f" id="r_a13cd0b80eaa7bc682013f7e8ffbdbd6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a13cd0b80eaa7bc682013f7e8ffbdbd6f">novas_e2h_offset</a> (double dra, double ddec, double pa, double *restrict daz, double *restrict del)</td></tr>
<tr class="memdesc:a13cd0b80eaa7bc682013f7e8ffbdbd6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts coordinate offsets, from the local equatorial system to local horizontal offsets.  <br /></td></tr>
<tr class="separator:a13cd0b80eaa7bc682013f7e8ffbdbd6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a095ba0ee644dc00c11dcdc5616bc96b0" id="r_a095ba0ee644dc00c11dcdc5616bc96b0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a095ba0ee644dc00c11dcdc5616bc96b0">novas_epa</a> (double ha, double dec, double lat)</td></tr>
<tr class="memdesc:a095ba0ee644dc00c11dcdc5616bc96b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Parallactic Angle (PA) calculated for an RA/Dec location of the sky at a given sidereal time.  <br /></td></tr>
<tr class="separator:a095ba0ee644dc00c11dcdc5616bc96b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7977de3e3edf8120b50cbd026c155f47" id="r_a7977de3e3edf8120b50cbd026c155f47"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7977de3e3edf8120b50cbd026c155f47">novas_h2e_offset</a> (double daz, double del, double pa, double *restrict dra, double *restrict ddec)</td></tr>
<tr class="memdesc:a7977de3e3edf8120b50cbd026c155f47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts coordinate offsets, from the local horizontal system to local equatorial offsets.  <br /></td></tr>
<tr class="separator:a7977de3e3edf8120b50cbd026c155f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73fcb54e47b2be0aa92810b5f55f7a3c" id="r_a73fcb54e47b2be0aa92810b5f55f7a3c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73fcb54e47b2be0aa92810b5f55f7a3c">novas_hpa</a> (double az, double el, double lat)</td></tr>
<tr class="memdesc:a73fcb54e47b2be0aa92810b5f55f7a3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Parallactic Angle (PA) calculated for a horizontal Az/El location of the sky.  <br /></td></tr>
<tr class="separator:a73fcb54e47b2be0aa92810b5f55f7a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a601d246673742cf72a5dbe1449c97560" id="r_a601d246673742cf72a5dbe1449c97560"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a601d246673742cf72a5dbe1449c97560">novas_los_to_xyz</a> (const double *los, double lon, double lat, double *xyz)</td></tr>
<tr class="memdesc:a601d246673742cf72a5dbe1449c97560"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a 3D line-of-sight vector (&delta;&phi;, &delta;&theta; &delta;r) to a rectangular equatorial (&delta;x, &delta;y, &delta;z) vector.  <br /></td></tr>
<tr class="separator:a601d246673742cf72a5dbe1449c97560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c920eee105431247e9a1d9bf1c3021" id="r_a16c920eee105431247e9a1d9bf1c3021"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16c920eee105431247e9a1d9bf1c3021">novas_uvw_to_xyz</a> (const double *uvw, double ha, double dec, double *xyz)</td></tr>
<tr class="memdesc:a16c920eee105431247e9a1d9bf1c3021"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts equatorial u,v,w projected (absolute or relative) coordinates to rectangular telescope x,y,z coordinates (in ITRS) to for a specified line of sight.  <br /></td></tr>
<tr class="separator:a16c920eee105431247e9a1d9bf1c3021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14deb6fdce80ba213e1f1d5238306e17" id="r_a14deb6fdce80ba213e1f1d5238306e17"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14deb6fdce80ba213e1f1d5238306e17">novas_xyz_to_los</a> (const double *xyz, double lon, double lat, double *los)</td></tr>
<tr class="memdesc:a14deb6fdce80ba213e1f1d5238306e17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a 3D rectangular equatorial (&delta;x, &delta;y, &delta;z) vector to a polar (&delta;&phi;, &delta;&theta; &delta;r) vector along a line-of-sight.  <br /></td></tr>
<tr class="separator:a14deb6fdce80ba213e1f1d5238306e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87867e8e7fc7decaa44777a696465353" id="r_a87867e8e7fc7decaa44777a696465353"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87867e8e7fc7decaa44777a696465353">novas_xyz_to_uvw</a> (const double *xyz, double ha, double dec, double *uvw)</td></tr>
<tr class="memdesc:a87867e8e7fc7decaa44777a696465353"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts rectangular telescope x,y,z (absolute or relative) coordinates (in ITRS) to equatorial u,v,w projected coordinates for a specified line of sight.  <br /></td></tr>
<tr class="separator:a87867e8e7fc7decaa44777a696465353"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Various transformations between different coordinate systems used in astronomy, such as equatorial, ecliptic, Galactic, or local horizontal coordinate systems. </p>
<p>This module also provides functions otherwise relating to the observer locations.</p>
<p>For Earth-based geodetic locations, the module provides a set of functions to convert between various (local) coordinate systems. For example, calculating parallactic angles (a.k.a. vertical position angle or VPA), for converting between horizontal and equatorial offsets, and various functions for converting equatorial vectors to a line-of-sight, or <em>u</em>, <em>v</em>, <em>w</em> coordinate bases, and vice-versa.</p>
<dl class="section date"><dt>Date</dt><dd>Created on Mar 5, 2025 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs and G. Kaplan</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="frames_8c.html" title="High-level and efficient astrometric calculations using observing frames.">frames.c</a>, <a class="el" href="transform_8c.html" title="Various functions to transform rectangular equatorial vectors (positions or velocities) between diffe...">transform.c</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a41ca0cfd79ad07c9e857ba02fa94928e" name="a41ca0cfd79ad07c9e857ba02fa94928e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41ca0cfd79ad07c9e857ba02fa94928e">&#9670;&#160;</a></span>ecl2equ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ecl2equ </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a></td>          <td class="paramname"><span class="paramname"><em>coord_sys</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>elon</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>elat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert ecliptic longitude and latitude to right ascension and declination. </p>
<p>To convert GCRS ecliptic coordinates (mean ecliptic and equinox of J2000.0), set 'coord_sys' to <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a1248329939f130a4bef0d3ef9ed95c66" title="Geocentric Celestial Reference System (GCRS) equator.">NOVAS_GCRS_EQUATOR(2)</a>; in this case the value of 'jd_tt' can be set to anything, since J2000.0 is assumed. Otherwise, all input coordinates are dynamical at'jd_tt'.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. (Unused if 'coord_sys' is NOVAS_GCRS_EQUATOR[2]) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coord_sys</td><td>The astrometric reference system of the coordinates. If 'coord_sys' is <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a1248329939f130a4bef0d3ef9ed95c66" title="Geocentric Celestial Reference System (GCRS) equator.">NOVAS_GCRS_EQUATOR(2)</a>, the input GCRS coordinates are converted to J2000 ecliptic coordinates. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">elon</td><td>[deg] Ecliptic longitude in degrees, referred to specified ecliptic and equinox of date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">elat</td><td>[deg] Ecliptic latitude in degrees, referred to specified ecliptic and equinox of date. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ra</td><td>[h] Right ascension in hours, referred to specified equator and equinox of date. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dec</td><td>[deg] Declination in degrees, referred to specified equator and equinox of date.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else 1 if the value of 'coord_sys' is invalid.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a6fa1eada41005ac70290d0bb5df1ec26" title="Converts an ecliptic position vector to an equatorial position vector.">ecl2equ_vec()</a>, <a class="el" href="#a035047336b16951b8b850066e74210a9" title="Convert right ascension and declination to ecliptic longitude and latitude.">equ2ecl()</a> </dd></dl>

<p class="reference">References <a class="el" href="#a6fa1eada41005ac70290d0bb5df1ec26">ecl2equ_vec()</a>.</p>

</div>
</div>
<a id="a6fa1eada41005ac70290d0bb5df1ec26" name="a6fa1eada41005ac70290d0bb5df1ec26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fa1eada41005ac70290d0bb5df1ec26">&#9670;&#160;</a></span>ecl2equ_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short ecl2equ_vec </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a></td>          <td class="paramname"><span class="paramname"><em>coord_sys</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an ecliptic position vector to an equatorial position vector. </p>
<p>To convert ecliptic coordinates (mean ecliptic and equinox of J2000.0) to GCRS RA and dec to, set 'coord_sys' to <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a1248329939f130a4bef0d3ef9ed95c66" title="Geocentric Celestial Reference System (GCRS) equator.">NOVAS_GCRS_EQUATOR(2)</a>; in this case the value of 'jd_tt' can be set to anything, since J2000.0 is assumed. Otherwise, all input coordinates are dynamical at 'jd_tt'.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. (Unused if 'coord_sys' is NOVAS_GCRS_EQUATOR[2]) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coord_sys</td><td>The astrometric reference system type of the coordinates </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>Position vector, referred to specified ecliptic and equinox of date. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Position vector, referred to specified equator and equinox of date. It can be the same vector as the input. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if either vector argument is NULL or the accuracy is invalid, or else 1 if the value of 'coord_sys' is invalid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a41ca0cfd79ad07c9e857ba02fa94928e" title="Convert ecliptic longitude and latitude to right ascension and declination.">ecl2equ()</a>, <a class="el" href="#aa05ecc76c1ccc0c3445f8b642d6c5311" title="Converts an equatorial position vector to an ecliptic position vector.">equ2ecl_vec()</a> </dd></dl>

<p class="reference">References <a class="el" href="equator_8c.html#ab75165e2d69231da10c67de025ee05d8">e_tilt()</a>, <a class="el" href="transform_8c.html#aa11d2253a44261370af8d0c32f0715e9">frame_tie()</a>, <a class="el" href="novas_8h.html#ae8b91a9b4fe4af63c7054d1eacdb996ea7e5dc966849295dce29fb339b960da4f">J2000_TO_ICRS</a>, <a class="el" href="equator_8c.html#af182ee8cc4239f581f746aa974827d61">mean_obliq()</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a1248329939f130a4bef0d3ef9ed95c66">NOVAS_GCRS_EQUATOR</a>, <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a90d1ef6cedd7a9fdfd7e538ecea5a040">NOVAS_MEAN_EQUATOR</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, and <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014acca4381f43619e421b26d79c1c77593f">NOVAS_TRUE_EQUATOR</a>.</p>

</div>
</div>
<a id="a035047336b16951b8b850066e74210a9" name="a035047336b16951b8b850066e74210a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a035047336b16951b8b850066e74210a9">&#9670;&#160;</a></span>equ2ecl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short equ2ecl </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a></td>          <td class="paramname"><span class="paramname"><em>coord_sys</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>elon</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>elat</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert right ascension and declination to ecliptic longitude and latitude. </p>
<p>To convert GCRS RA and dec to ecliptic coordinates (mean ecliptic and equinox of J2000.0), set 'coord_sys' to <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a1248329939f130a4bef0d3ef9ed95c66" title="Geocentric Celestial Reference System (GCRS) equator.">NOVAS_GCRS_EQUATOR(2)</a>; in this case the value of 'jd_tt' can be set to anything, since J2000.0 is assumed. Otherwise, all input coordinates are dynamical at 'jd_tt'.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. (Unused if 'coord_sys' is NOVAS_GCRS_EQUATOR[2]) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coord_sys</td><td>The astrometric reference system of the coordinates. If 'coord_sys' is <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a1248329939f130a4bef0d3ef9ed95c66" title="Geocentric Celestial Reference System (GCRS) equator.">NOVAS_GCRS_EQUATOR(2)</a>, the input GCRS coordinates are converted to J2000 ecliptic coordinates. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ra</td><td>[h] Right ascension in hours, referred to specified equator and equinox of date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dec</td><td>[deg] Declination in degrees, referred to specified equator and equinox of date. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">elon</td><td>[deg] Ecliptic longitude in degrees, referred to specified ecliptic and equinox of date. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">elat</td><td>[deg] Ecliptic latitude in degrees, referred to specified ecliptic and equinox of date. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else 1 if the value of 'coord_sys' is invalid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#aa05ecc76c1ccc0c3445f8b642d6c5311" title="Converts an equatorial position vector to an ecliptic position vector.">equ2ecl_vec()</a>, <a class="el" href="#a41ca0cfd79ad07c9e857ba02fa94928e" title="Convert ecliptic longitude and latitude to right ascension and declination.">ecl2equ()</a> </dd></dl>

<p class="reference">References <a class="el" href="#aa05ecc76c1ccc0c3445f8b642d6c5311">equ2ecl_vec()</a>.</p>

</div>
</div>
<a id="aa05ecc76c1ccc0c3445f8b642d6c5311" name="aa05ecc76c1ccc0c3445f8b642d6c5311"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa05ecc76c1ccc0c3445f8b642d6c5311">&#9670;&#160;</a></span>equ2ecl_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short equ2ecl_vec </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014">novas_equator_type</a></td>          <td class="paramname"><span class="paramname"><em>coord_sys</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an equatorial position vector to an ecliptic position vector. </p>
<p>To convert ICRS RA and dec to ecliptic coordinates (mean ecliptic and equinox of J2000.0), set 'coord_sys' to <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a1248329939f130a4bef0d3ef9ed95c66" title="Geocentric Celestial Reference System (GCRS) equator.">NOVAS_GCRS_EQUATOR(2)</a>; in this case the value of 'jd_tt' can be set to anything, since J2000.0 is assumed. Otherwise, all input coordinates are dynamical at 'jd_tt'.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_tt</td><td>[day] Terrestrial Time (TT) based Julian date. (Unused if 'coord_sys' is NOVAS_GCRS_EQUATOR[2]) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">coord_sys</td><td>The astrometric reference system type of the coordinates. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">in</td><td>Position vector, referred to specified equator and equinox of date. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Position vector, referred to specified ecliptic and equinox of date. It can be the same vector as the input. If 'coord_sys' is <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a1248329939f130a4bef0d3ef9ed95c66" title="Geocentric Celestial Reference System (GCRS) equator.">NOVAS_GCRS_EQUATOR(2)</a>, the input GCRS coordinates are converted to J2000 ecliptic coordinates. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 if either vector argument is NULL or the accuracy is invalid, or else 1 if the value of 'coord_sys' is invalid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a035047336b16951b8b850066e74210a9" title="Convert right ascension and declination to ecliptic longitude and latitude.">equ2ecl()</a>, <a class="el" href="#a6fa1eada41005ac70290d0bb5df1ec26" title="Converts an ecliptic position vector to an equatorial position vector.">ecl2equ_vec()</a> </dd></dl>

<p class="reference">References <a class="el" href="equator_8c.html#ab75165e2d69231da10c67de025ee05d8">e_tilt()</a>, <a class="el" href="transform_8c.html#aa11d2253a44261370af8d0c32f0715e9">frame_tie()</a>, <a class="el" href="novas_8h.html#ae8b91a9b4fe4af63c7054d1eacdb996ea8557604d6604356e6620b42f78aec999">ICRS_TO_J2000</a>, <a class="el" href="equator_8c.html#af182ee8cc4239f581f746aa974827d61">mean_obliq()</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56aebffd24170ffab949609a8dcfc201660">NOVAS_FULL_ACCURACY</a>, <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a1248329939f130a4bef0d3ef9ed95c66">NOVAS_GCRS_EQUATOR</a>, <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014a90d1ef6cedd7a9fdfd7e538ecea5a040">NOVAS_MEAN_EQUATOR</a>, <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56a2047c8bae25010adb60d895a83079846">NOVAS_REDUCED_ACCURACY</a>, and <a class="el" href="novas_8h.html#a2eff9980cb9db96ab41fb564c1b5c014acca4381f43619e421b26d79c1c77593f">NOVAS_TRUE_EQUATOR</a>.</p>

</div>
</div>
<a id="a288b49c03bc29704c8dd5acf8baca80e" name="a288b49c03bc29704c8dd5acf8baca80e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a288b49c03bc29704c8dd5acf8baca80e">&#9670;&#160;</a></span>equ2gal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int equ2gal </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>glon</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>glat</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts ICRS right ascension and declination to galactic longitude and latitude. </p>
<p>REFERENCES: </p><ol>
<li>
Hipparcos and Tycho Catalogues, Vol. 1, Section 1.5.3. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">ra</td><td>[h] ICRS right ascension in hours. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dec</td><td>[deg] ICRS declination in degrees. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">glon</td><td>[deg] Galactic longitude in degrees. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">glat</td><td>[deg] Galactic latitude in degrees.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if either of the output pointer arguments are NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#adcce501bd3f8f70974e7f55527162f83" title="Converts galactic longitude and latitude to ICRS right ascension and declination.">gal2equ()</a> </dd></dl>

</div>
</div>
<a id="ad932a8617973ef06e4a5c955b7897bb0" name="ad932a8617973ef06e4a5c955b7897bb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad932a8617973ef06e4a5c955b7897bb0">&#9670;&#160;</a></span>equ2hor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int equ2hor </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>jd_ut1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ut1_to_tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#a3cba2735c32163fab062b1a904a83b56">novas_accuracy</a></td>          <td class="paramname"><span class="paramname"><em>accuracy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>xp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>yp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>location</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="novas_8h.html#abe97e2d459a30db9d0f67d8c60af3b81">novas_refraction_model</a></td>          <td class="paramname"><span class="paramname"><em>ref_option</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>zd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>az</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>rar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>decr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000014">Deprecated</a></b></dt><dd>You should use the frame-based <code><a class="el" href="frames_8c.html#a3cd947f2e48d6c5cc88ad7a1bab9b8ca" title="Converts an observed apparent position vector in the specified coordinate system to local horizontal ...">novas_app_to_hor()</a></code> instead, or else the more explicit (less ambiguous) <code><a class="el" href="transform_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3" title="Rotates a position vector from the dynamical True of Date (TOD) frame of date the Earth-fixed ITRS fr...">tod_to_itrs()</a></code> followed by <code><a class="el" href="#aef3c1f8e4c443e51e65003018449768a" title="Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zen...">itrs_to_hor()</a></code>, and possibly following it with an atmospheric refraction correction if appropriate.</dd></dl>
<p>Transforms topocentric (TOD) apparent right ascension and declination to zenith distance and azimuth. This method should not be used to convert CIRS apparent coordinates (IAU 2000 standard) &ndash; for those you should use <a class="el" href="transform_8c.html#aa2768d89d499a7155f90a6fd8c176d8d" title="Rotates a position vector from the dynamical CIRS frame of date to the Earth-fixed ITRS frame (IAU 20...">cirs_to_itrs()</a> followed by <a class="el" href="#aef3c1f8e4c443e51e65003018449768a" title="Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zen...">itrs_to_hor()</a> instead.</p>
<p>It uses a method that properly accounts for polar motion, which is significant at the sub-arcsecond level. This function can also adjust coordinates for atmospheric refraction.</p>
<p>NOTES: </p><ul>
<li>
'xp' and 'yp' can be set to zero if sub-arcsecond accuracy is not needed. </li>
<li>
The directions 'zd'= 0 (zenith) and 'az'= 0 (north) are here considered fixed in the terrestrial system. Specifically, the zenith is along the geodetic normal, and north is toward the ITRS pole. </li>
<li>
If 'ref_option' is NOVAS_STANDARD_ATMOSPHERE (1), then 'rar'='ra' and 'decr'='dec'. </li>
</ul>
<p>REFERENCES: </p><ol>
<li>
Kaplan, G. (2008). USNO/AA Technical Note of 28 Apr 2008, "Refraction as a Vector." </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">jd_ut1</td><td>[day] UT1 based Julian date </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ut1_to_tt</td><td>[s] TT - UT1 Time difference in seconds </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">accuracy</td><td>NOVAS_FULL_ACCURACY (0) or NOVAS_REDUCED_ACCURACY (1) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">xp</td><td>[arcsec] Conventionally-defined x coordinate of celestial intermediate pole with respect to ITRS reference pole, e.g. from IERS Bulletin A. If you have defined pole offsets to be incorporated into the TOD input coordinates (pre-IAU2000 method) via <code><a class="el" href="equator_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a></code>, then you should set this to 0. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">yp</td><td>[arcsec] Conventionally-defined y coordinate of celestial intermediate pole with respect to ITRS reference pole, e.g. from IERS Bulletin A. If you have defined pole offsets to be incorporated into the TOD input coordinates (pre-IAU2000 method) via <code><a class="el" href="equator_8c.html#a8937180de2ee1545d19b8fc840f35fe2">cel_pole()</a></code>, then you should set this to 0. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">location</td><td>Geodetic (ITRF / GRS80) observer location on Earth </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ra</td><td>[h] Topocentric apparent (TOD) right ascension of object of interest, referred to true equator and equinox of date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dec</td><td>[deg] Topocentric apparent (TOD) declination of object of interest, referred to true equator and equinox of date. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ref_option</td><td>Refraction model to use. E.g., NOVAS_STANDARD_ATMOSPHERE (1), or NOVAS_WEATHER_AT_LOCATION (2) if to use the weather. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">zd</td><td>[deg] Topocentric zenith distance in degrees (unrefracted). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">az</td><td>[deg] Topocentric azimuth (measured east from north) in degrees. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rar</td><td>[h] Topocentric right ascension of object of interest, in hours, referred to true equator and equinox of date, affected by refraction if 'ref_option' is non-zero. (It may be NULL if not required) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decr</td><td>[deg] Topocentric declination of object of interest, in degrees, referred to true equator and equinox of date. (It may be NULL if not required) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if one of the 'zd' or 'az' output pointers are NULL.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#aef3c1f8e4c443e51e65003018449768a" title="Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zen...">itrs_to_hor()</a>, <a class="el" href="transform_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3" title="Rotates a position vector from the dynamical True of Date (TOD) frame of date the Earth-fixed ITRS fr...">tod_to_itrs()</a>, <a class="el" href="novas_8h.html#a7ba038ea34eb901ccfb8f785708c651eaa4bcd4fdb15ba77023241689a5608df3" title="True equinox Of Date: dynamical system of the &#39;true&#39; equator, with its origin at the &#39;true&#39; equinox (...">NOVAS_TOD</a> </dd></dl>

<p class="reference">References <a class="el" href="novas_8h.html#a9e882d9c9055f187d3a8dc9b019f0609a1d56a4fb59b567049ed1937bfcdf0f62">EROT_GST</a>, <a class="el" href="novas_8h.html#a3789b2c39c26f01bb1bffe8ebc953467aba4a23444c495f90061ec1a906585faa">NOVAS_DYNAMICAL_CLASS</a>, <a class="el" href="refract_8c.html#afe1d4e96dd66676f5567a279e83e88d9">refract_astro()</a>, and <a class="el" href="transform_8c.html#ac8c5ff3cc13126aba2ec5a6cbe187a31">ter2cel()</a>.</p>

</div>
</div>
<a id="adcce501bd3f8f70974e7f55527162f83" name="adcce501bd3f8f70974e7f55527162f83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcce501bd3f8f70974e7f55527162f83">&#9670;&#160;</a></span>gal2equ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gal2equ </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>glon</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>glat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>ra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts galactic longitude and latitude to ICRS right ascension and declination. </p>
<p>REFERENCES: </p><ol>
<li>
Hipparcos and Tycho Catalogues, Vol. 1, Section 1.5.3. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">glon</td><td>[deg] Galactic longitude in degrees. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">glat</td><td>[deg] Galactic latitude in degrees. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ra</td><td>[h] ICRS right ascension in hours. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dec</td><td>[deg] ICRS declination in degrees.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or -1 if either of the output pointer arguments are NULL.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a288b49c03bc29704c8dd5acf8baca80e" title="Converts ICRS right ascension and declination to galactic longitude and latitude.">equ2gal()</a> </dd></dl>

</div>
</div>
<a id="a19f4f6c7d942dcba5ad2a4d2a60affad" name="a19f4f6c7d942dcba5ad2a4d2a60affad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19f4f6c7d942dcba5ad2a4d2a60affad">&#9670;&#160;</a></span>hor_to_itrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hor_to_itrs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>location</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>az</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>za</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>itrs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts astrometric (unrefracted) azimuth and zenith angles at the specified observer location to a unit position vector in the Earth-fixed ITRS frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">location</td><td>Geodetic (ITRF / GRS80) observer location on Earth </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">az</td><td>[deg] astrometric (unrefracted) azimuth angle at observer location [0:360]. It may be NULL if not required. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">za</td><td>[deg] astrometric (unrefracted) zenith angle at observer location [0:180]. It may be NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">itrs</td><td>Unit 3-vector direction in Earth-fixed ITRS frame </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if the location or the input vector is NULL.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#aef3c1f8e4c443e51e65003018449768a" title="Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zen...">itrs_to_hor()</a>, <a class="el" href="transform_8c.html#a12953f66c0f774284f0700ae785784d0" title="Rotates a position vector from the Earth-fixed ITRS frame to the dynamical CIRS frame of date (IAU 20...">itrs_to_cirs()</a>, <a class="el" href="transform_8c.html#a3f6ae564cfac3766a21e0754905e5f7c" title="Rotates a position vector from the Earth-fixed ITRS frame to the dynamical True of Date (TOD) frame o...">itrs_to_tod()</a>, <a class="el" href="refract_8c.html#ac7ed2a1a5fb5aea3063d116d3d980eeb" title="Computes atmospheric optical refraction for an observed (already refracted!) zenith distance through ...">refract()</a> </dd></dl>

</div>
</div>
<a id="aef3c1f8e4c443e51e65003018449768a" name="aef3c1f8e4c443e51e65003018449768a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef3c1f8e4c443e51e65003018449768a">&#9670;&#160;</a></span>itrs_to_hor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int itrs_to_hor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structon__surface.html">on_surface</a> *restrict</td>          <td class="paramname"><span class="paramname"><em>location</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *restrict</td>          <td class="paramname"><span class="paramname"><em>itrs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>az</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>za</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a position vector in the Earth-fixed ITRS frame to astrometric (unrefracted) azimuth and zenith angles at the specified observer location. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">location</td><td>Geodetic (ITRF / GRS80) observer location on Earth. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">itrs</td><td>3-vector position in Earth-fixed ITRS frame </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">az</td><td>[deg] astrometric (unrefracted) azimuth angle at observer location [0:360]. It may be NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">za</td><td>[deg] astrometric (unrefracted) zenith angle at observer location [0:180]. It may be NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if the location or the input vector is NULL.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a19f4f6c7d942dcba5ad2a4d2a60affad" title="Converts astrometric (unrefracted) azimuth and zenith angles at the specified observer location to a ...">hor_to_itrs()</a>, <a class="el" href="transform_8c.html#aa2768d89d499a7155f90a6fd8c176d8d" title="Rotates a position vector from the dynamical CIRS frame of date to the Earth-fixed ITRS frame (IAU 20...">cirs_to_itrs()</a>, <a class="el" href="transform_8c.html#a4551e2ac083e34c1b2b61b3805efb9a3" title="Rotates a position vector from the dynamical True of Date (TOD) frame of date the Earth-fixed ITRS fr...">tod_to_itrs()</a>, <a class="el" href="refract_8c.html#afe1d4e96dd66676f5567a279e83e88d9" title="Computes atmospheric optical refraction for a source at an astrometric zenith distance (e....">refract_astro()</a> </dd></dl>

</div>
</div>
<a id="a13cd0b80eaa7bc682013f7e8ffbdbd6f" name="a13cd0b80eaa7bc682013f7e8ffbdbd6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13cd0b80eaa7bc682013f7e8ffbdbd6f">&#9670;&#160;</a></span>novas_e2h_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_e2h_offset </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ddec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>pa</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>daz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>del</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts coordinate offsets, from the local equatorial system to local horizontal offsets. </p>
<p>Converting between local flat projections and spherical coordinates usually requires a WCS projection.</p>
<p>REFERENCES: </p><ol>
<li>
Calabretta, M.R., &amp; Greisen, E.W., (2002), Astronomy &amp; Astrophysics, 395, 1077-1122. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">dra</td><td>[arcsec] Projected ffset position in the apparent true-of-date R.A. direction. E.g. The projected offset between two RA coordinates at a same reference declination, is &delta;RA = (RA2 - RA1) * cos(Dec<sub>0</sub>). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ddec</td><td>[arcsec] Projected offset position in the apparent true-of-date declination direction. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pa</td><td>[deg] Parallactic Angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">daz</td><td>[arcsec] Output offset position in the local azimuth direction. It can be a pointer to one of the input coordinates, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">del</td><td>[arcsec] Output offset position in the local elevation direction. It can be a pointer to one of the input coordinates, or NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a7977de3e3edf8120b50cbd026c155f47" title="Converts coordinate offsets, from the local horizontal system to local equatorial offsets.">novas_h2e_offset()</a>, <a class="el" href="#a095ba0ee644dc00c11dcdc5616bc96b0" title="Returns the Parallactic Angle (PA) calculated for an RA/Dec location of the sky at a given sidereal t...">novas_epa()</a> </dd></dl>

<p class="reference">References <a class="el" href="#a7977de3e3edf8120b50cbd026c155f47">novas_h2e_offset()</a>.</p>

</div>
</div>
<a id="a095ba0ee644dc00c11dcdc5616bc96b0" name="a095ba0ee644dc00c11dcdc5616bc96b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095ba0ee644dc00c11dcdc5616bc96b0">&#9670;&#160;</a></span>novas_epa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_epa </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ha</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lat</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the Parallactic Angle (PA) calculated for an RA/Dec location of the sky at a given sidereal time. </p>
<p>The PA is the angle between the local horizontal coordinate directions and the local true-of-date equatorial coordinate directions, at the given location and time. The polar wobble is not included in the calculation.</p>
<p>The Parallactic Angle is sometimes referrred to as the Vertical Position Angle (VPA). Both define the same quantity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ha</td><td>[h] Hour angle (LST - RA) i.e., the difference between the Local (apparent) Sidereal Time and the apparent (true-of-date) Right Ascension of observed source. </td></tr>
    <tr><td class="paramname">dec</td><td>[deg] Apparent (true-of-date) declination of observed source </td></tr>
    <tr><td class="paramname">lat</td><td>[deg] Geodetic latitude of observer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] Parallactic Angle (PA). I.e., the clockwise position angle of the elevation direction w.r.t. the declination axis in the equatorial system. Same as the clockwise position angle of the declination direction w.r.t. the elevation axis, in the horizontal system.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a73fcb54e47b2be0aa92810b5f55f7a3c" title="Returns the Parallactic Angle (PA) calculated for a horizontal Az/El location of the sky.">novas_hpa()</a>, <a class="el" href="#a13cd0b80eaa7bc682013f7e8ffbdbd6f" title="Converts coordinate offsets, from the local equatorial system to local horizontal offsets.">novas_e2h_offset()</a> </dd></dl>

</div>
</div>
<a id="a7977de3e3edf8120b50cbd026c155f47" name="a7977de3e3edf8120b50cbd026c155f47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7977de3e3edf8120b50cbd026c155f47">&#9670;&#160;</a></span>novas_h2e_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_h2e_offset </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>daz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>del</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>pa</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>dra</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *restrict</td>          <td class="paramname"><span class="paramname"><em>ddec</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts coordinate offsets, from the local horizontal system to local equatorial offsets. </p>
<p>Converting between local flat projections and spherical coordinates usually requires a WCS projection.</p>
<p>REFERENCES: </p><ol>
<li>
Calabretta, M.R., &amp; Greisen, E.W., (2002), Astronomy &amp; Astrophysics, 395, 1077-1122. </li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">daz</td><td>[arcsec] Projected offset position in the azimuth direction. The projected offset between two azimuth positions at the same reference elevation is &delta;Az = (Az2 - Az1) * cos(El<sub>0</sub>). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">del</td><td>[arcsec] projected offset position in the elevation direction </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">pa</td><td>[deg] Parallactic Angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dra</td><td>[arcsec] Output offset position in the local true-of-date R.A. direction. It can be a pointer to one of the input coordinates, or NULL if not required. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ddec</td><td>[arcsec] Output offset position in the local true-of-date declination direction. It can be a pointer to one of the input coordinates, or NULL if not required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a13cd0b80eaa7bc682013f7e8ffbdbd6f" title="Converts coordinate offsets, from the local equatorial system to local horizontal offsets.">novas_e2h_offset()</a>, <a class="el" href="#a73fcb54e47b2be0aa92810b5f55f7a3c" title="Returns the Parallactic Angle (PA) calculated for a horizontal Az/El location of the sky.">novas_hpa()</a> </dd></dl>

</div>
</div>
<a id="a73fcb54e47b2be0aa92810b5f55f7a3c" name="a73fcb54e47b2be0aa92810b5f55f7a3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73fcb54e47b2be0aa92810b5f55f7a3c">&#9670;&#160;</a></span>novas_hpa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double novas_hpa </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>az</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>el</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lat</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the Parallactic Angle (PA) calculated for a horizontal Az/El location of the sky. </p>
<p>The PA is the angle between the local horizontal coordinate directions and the local true-of-date equatorial coordinate directions at the given location. The polar wobble is not included in the calculation.</p>
<p>The Parallactic Angle is sometimes referrred to as the Vertical Position Angle (VPA). Both define the same quantity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">az</td><td>[deg] Azimuth angle </td></tr>
    <tr><td class="paramname">el</td><td>[deg] Elevation angle </td></tr>
    <tr><td class="paramname">lat</td><td>[deg] Geodetic latitude of observer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[deg] Parallactic Angle (PA). I.e., the clockwise position angle of the declination direction w.r.t. the elevation axis in the horizontal system. Same as the the clockwise position angle of the elevation direction w.r.t. the declination axis in the equatorial system.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a095ba0ee644dc00c11dcdc5616bc96b0" title="Returns the Parallactic Angle (PA) calculated for an RA/Dec location of the sky at a given sidereal t...">novas_epa()</a>, <a class="el" href="#a7977de3e3edf8120b50cbd026c155f47" title="Converts coordinate offsets, from the local horizontal system to local equatorial offsets.">novas_h2e_offset()</a> </dd></dl>

</div>
</div>
<a id="a601d246673742cf72a5dbe1449c97560" name="a601d246673742cf72a5dbe1449c97560"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a601d246673742cf72a5dbe1449c97560">&#9670;&#160;</a></span>novas_los_to_xyz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_los_to_xyz </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>los</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lon</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>xyz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a 3D line-of-sight vector (&delta;&phi;, &delta;&theta; &delta;r) to a rectangular equatorial (&delta;x, &delta;y, &delta;z) vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">los</td><td>[arb.u.] Line-of-sight 3-vector (&delta;&phi;, &delta;&theta; &delta;r). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lon</td><td>[deg] Line-of-sight longitude. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lat</td><td>[deg] Line-of-sight latitude. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xyz</td><td>[arb.u.] Output rectangular equatorial 3-vector (&delta;x, &delta;y, &delta;z), in the same units as the input. It may be the same vector as the input. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if either vector argument is NULL (errno will be set to EINVAL).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a14deb6fdce80ba213e1f1d5238306e17" title="Converts a 3D rectangular equatorial (x, y, z) vector to a polar (,  r) vector along a line-o...">novas_xyz_to_los()</a>, <a class="el" href="#a16c920eee105431247e9a1d9bf1c3021" title="Converts equatorial u,v,w projected (absolute or relative) coordinates to rectangular telescope x,...">novas_uvw_to_xyz()</a> </dd></dl>

</div>
</div>
<a id="a16c920eee105431247e9a1d9bf1c3021" name="a16c920eee105431247e9a1d9bf1c3021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16c920eee105431247e9a1d9bf1c3021">&#9670;&#160;</a></span>novas_uvw_to_xyz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_uvw_to_xyz </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>uvw</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ha</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>xyz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts equatorial u,v,w projected (absolute or relative) coordinates to rectangular telescope x,y,z coordinates (in ITRS) to for a specified line of sight. </p>
<p>u,v,w are Cartesian coordinates (u,v) along the local equatorial R.A. and declination directions as seen from a direction on the sky (w). As such, they are effectively ITRS-based line-of-sight (LOS) coordinates.</p>
<p>x,y,z are Cartesian coordinates w.r.t the Greenwich meridian in the ITRS frame. The directions are x: long=0, lat=0; y: long=90, lat=0; z: lat=90.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">xyz</td><td>[arb.u.] Absolute or relative u,v,w coordinates (double[3]). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ha</td><td>[h] Hourangle (LST - RA) i.e., the difference between the Local (apparent) Sidereal Time and the apparent (true-of-date) Right Ascension of observed source. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dec</td><td>[deg] Apparent (true-of-date) declination of source </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">uvw</td><td>[arb.u.] Converted x,y,z coordinates (double[3]) in the same unit as uvw. It may be the same vector as the input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if either vector argument is NULL (errno will be set to EINVAL)</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a87867e8e7fc7decaa44777a696465353" title="Converts rectangular telescope x,y,z (absolute or relative) coordinates (in ITRS) to equatorial u,...">novas_xyz_to_uvw()</a> </dd></dl>

<p class="reference">References <a class="el" href="#a601d246673742cf72a5dbe1449c97560">novas_los_to_xyz()</a>.</p>

</div>
</div>
<a id="a14deb6fdce80ba213e1f1d5238306e17" name="a14deb6fdce80ba213e1f1d5238306e17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14deb6fdce80ba213e1f1d5238306e17">&#9670;&#160;</a></span>novas_xyz_to_los()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_xyz_to_los </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>xyz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lon</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>los</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a 3D rectangular equatorial (&delta;x, &delta;y, &delta;z) vector to a polar (&delta;&phi;, &delta;&theta; &delta;r) vector along a line-of-sight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">xyz</td><td>[arb.u.] Rectangular equatorial 3-vector (&delta;x, &delta;y, &delta;z). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lon</td><td>[deg] Line-of-sight longitude. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lat</td><td>[deg] Line-of-sight latitude. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">los</td><td>[arb.u.] Output line-of-sight 3-vector (&delta;&phi;, &delta;&theta; &delta;r), in the same units as the input. It may be the same vector as the input. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if either vector argument is NULL (errno will be set to EINVAL).</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a601d246673742cf72a5dbe1449c97560" title="Converts a 3D line-of-sight vector (,  r) to a rectangular equatorial (x, y,...">novas_los_to_xyz()</a>, <a class="el" href="#a87867e8e7fc7decaa44777a696465353" title="Converts rectangular telescope x,y,z (absolute or relative) coordinates (in ITRS) to equatorial u,...">novas_xyz_to_uvw()</a> </dd></dl>

</div>
</div>
<a id="a87867e8e7fc7decaa44777a696465353" name="a87867e8e7fc7decaa44777a696465353"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87867e8e7fc7decaa44777a696465353">&#9670;&#160;</a></span>novas_xyz_to_uvw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int novas_xyz_to_uvw </td>
          <td>(</td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>xyz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>ha</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>uvw</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts rectangular telescope x,y,z (absolute or relative) coordinates (in ITRS) to equatorial u,v,w projected coordinates for a specified line of sight. </p>
<p>x,y,z are Cartesian coordinates w.r.t the Greenwich meridian, in the ITRS frame. The directions are x: long=0, lat=0; y: long=90, lat=0; z: lat=90.</p>
<p>u,v,w are Cartesian coordinates (u,v) along the local equatorial R.A. and declination directions as seen from a direction on the sky (w). As such, they are effectively ITRS-based line-of-sight (LOS) coordinates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">xyz</td><td>[arb.u.] Absolute or relative x,y,z coordinates (double[3]). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ha</td><td>[h] Hourangle (LST - RA) i.e., the difference between the Local (apparent) Sidereal Time and the apparent (true-of-date) Right Ascension of observed source. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dec</td><td>[deg] Apparent (true-of-date) declination of source </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">uvw</td><td>[arb.u.] Converted u,v,w coordinates (double[3]) in same units as xyz. It may be the same vector as the input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or else -1 if either vector argument is NULL (errno will be set to EINVAL)</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.3 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Attila Kovacs</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a16c920eee105431247e9a1d9bf1c3021" title="Converts equatorial u,v,w projected (absolute or relative) coordinates to rectangular telescope x,...">novas_uvw_to_xyz()</a> </dd></dl>

<p class="reference">References <a class="el" href="#a14deb6fdce80ba213e1f1d5238306e17">novas_xyz_to_los()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="system_8c.html">system.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
